
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>zelig-relogit &mdash; Zelig 5.0-1 documentation</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="static/my-styles.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.1.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.1.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '5.0-1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="top" title="Zelig 5.0-1 documentation" href="index.html" />
    <link rel="up" title="Model Reference and Vignettes" href="vignette.html" />
    <link rel="next" title="zelig-tobit" href="zelig-tobit.html" />
    <link rel="prev" title="zelig-probit" href="zelig-probit.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

<a href="https://github.com/IQSS/Zelig"><img style="position: absolute; top: 45px; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png"" alt="Fork me on GitHub"></a>
<div id="navbar" class="navbar-inverse navbar-default navbar-fixed-top">

    <div class="container">

      <div class="navbar-header">

        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>

        <!-- <a class="logo"> <img height="32" width="32" src="http://datascience.iq.harvard.edu/files/styles/os_files_small/public/datascience/files/zelig-small_1.png?itok=catC420a" /></a> -->
        <a class="navbar-brand" href="index.html">Zelig</a>
        <span class="navbar-text navbar-version pull-left"><b>Version 5.0-1</b></span>
      </div>
        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://54.191.56.66/milestones/milestone-roadmap/Zelig5/">Roadmap</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation_quickstart.html">Installation and Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation_quickstart.html#installing-r-and-zelig">Installing R and Zelig</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation_quickstart.html#quickstart-guide">Quickstart Guide</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="vignette.html">Model Reference and Vignettes</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="vignette.html#reference">Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="vignette.html#zelig-exp">zelig-exp</a></li>
<li class="toctree-l2"><a class="reference internal" href="vignette.html#zelig-gamma">zelig-gamma</a></li>
<li class="toctree-l2"><a class="reference internal" href="vignette.html#zelig-logit">zelig-logit</a></li>
<li class="toctree-l2"><a class="reference internal" href="vignette.html#zelig-lognorm">zelig-lognorm</a></li>
<li class="toctree-l2"><a class="reference internal" href="vignette.html#zelig-ls">zelig-ls</a></li>
<li class="toctree-l2"><a class="reference internal" href="vignette.html#zelig-negbin">zelig-negbin</a></li>
<li class="toctree-l2"><a class="reference internal" href="vignette.html#zelig-normal">zelig-normal</a></li>
<li class="toctree-l2"><a class="reference internal" href="vignette.html#zelig-poisson">zelig-poisson</a></li>
<li class="toctree-l2"><a class="reference internal" href="vignette.html#zelig-probit">zelig-probit</a></li>
<li class="toctree-l2"><a class="reference internal" href="vignette.html#zelig-relogit">zelig-relogit</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="vignette.html#zelig-tobit">zelig-tobit</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="faq.html#why-cant-i-install-zelig">Why can’t I install Zelig?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#why-cant-i-install-r">Why can’t I install R?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#why-cant-i-load-data">Why can’t I load data?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#r-is-neat-how-can-i-find-out-more">R is neat. How can I find out more?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="about.html">About Zelig</a><ul>
<li class="toctree-l2"><a class="reference internal" href="about.html#technical-vision">Technical Vision</a></li>
<li class="toctree-l2"><a class="reference internal" href="about.html#release-notes">Release Notes</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">zelig-relogit</a><ul>
<li><a class="reference internal" href="#syntax">Syntax</a></li>
<li><a class="reference internal" href="#arguments">Arguments</a></li>
<li><a class="reference internal" href="#example-1-one-tau-with-prior-correction-and-bias-correction">Example 1: One Tau with Prior Correction and Bias Correction</a></li>
<li><a class="reference internal" href="#example-2-one-tau-with-weighting-robust-standard-errors-and-bias-correction">Example 2: One Tau with Weighting, Robust Standard Errors, and Bias Correction</a></li>
<li><a class="reference internal" href="#example-3-two-taus-with-bias-correction-and-prior-correction">Example 3: Two Taus with Bias Correction and Prior Correction</a></li>
<li><a class="reference internal" href="#model">Model</a></li>
<li><a class="reference internal" href="#quantities-of-interest">Quantities of Interest</a></li>
<li><a class="reference internal" href="#output-values">Output Values</a></li>
<li><a class="reference internal" href="#differences-with-stata-version">Differences with Stata Version</a></li>
<li><a class="reference internal" href="#see-also">See also</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="zelig-probit.html" title="Previous Chapter: zelig-probit"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; zelig-probit</span>
    </a>
  </li>
  <li>
    <a href="zelig-tobit.html" title="Next Chapter: zelig-tobit"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">zelig-tobit &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          

        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation_quickstart.html">Installation and Quickstart</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="vignette.html">Model Reference and Vignettes</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="vignette.html#reference">Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="vignette.html#zelig-exp">zelig-exp</a></li>
<li class="toctree-l2"><a class="reference internal" href="vignette.html#zelig-gamma">zelig-gamma</a></li>
<li class="toctree-l2"><a class="reference internal" href="vignette.html#zelig-logit">zelig-logit</a></li>
<li class="toctree-l2"><a class="reference internal" href="vignette.html#zelig-lognorm">zelig-lognorm</a></li>
<li class="toctree-l2"><a class="reference internal" href="vignette.html#zelig-ls">zelig-ls</a></li>
<li class="toctree-l2"><a class="reference internal" href="vignette.html#zelig-negbin">zelig-negbin</a></li>
<li class="toctree-l2"><a class="reference internal" href="vignette.html#zelig-normal">zelig-normal</a></li>
<li class="toctree-l2"><a class="reference internal" href="vignette.html#zelig-poisson">zelig-poisson</a></li>
<li class="toctree-l2"><a class="reference internal" href="vignette.html#zelig-probit">zelig-probit</a></li>
<li class="toctree-l2"><a class="reference internal" href="vignette.html#zelig-relogit">zelig-relogit</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="vignette.html#zelig-tobit">zelig-tobit</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html">About Zelig</a></li>
</ul>

<form action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-9">
      
  <div class="section" id="zelig-relogit">
<span id="zrelogit"></span><h1>zelig-relogit<a class="headerlink" href="#zelig-relogit" title="Permalink to this headline">¶</a></h1>
<p>Rare Events Logistic Regression for Dichotomous Dependent Variables</p>
<p>The relogit procedure estimates the same model as standard logistic
regression (appropriate when you have a dichotomous dependent variable
and a set of explanatory variables; see ), but the estimates are
corrected for the bias that occurs when the sample is small or the
observed events are rare (i.e., if the dependent variable has many more
1s than 0s or the reverse). The relogit procedure also optionally uses
prior correction for case-control sampling designs.</p>
<div class="section" id="syntax">
<h2>Syntax<a class="headerlink" href="#syntax" title="Permalink to this headline">¶</a></h2>
<p>With reference classes:</p>
<div class="highlight-r"><div class="highlight"><pre>z5 <span class="o">&lt;-</span> zrelogit<span class="o">$</span>new<span class="p">()</span>
z5<span class="o">$</span>zelig<span class="p">(</span>Y <span class="o">~</span> X1 <span class="o">+</span> X2<span class="p">,</span> tau <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span>
                       case.control <span class="o">=</span> c<span class="p">(</span><span class="s">&quot;prior&quot;</span><span class="p">,</span> <span class="s">&quot;weighting&quot;</span><span class="p">),</span>
                       bias.correct <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> robust <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
                       data <span class="o">=</span> mydata<span class="p">,</span> <span class="kc">...</span><span class="p">)</span>
z5<span class="o">$</span>setx<span class="p">()</span>
z5<span class="o">$</span>sim<span class="p">()</span>
</pre></div>
</div>
<p>With the Zelig 4 compatibility wrappers:</p>
<div class="highlight-r"><div class="highlight"><pre>z.out <span class="o">&lt;-</span> zelig<span class="p">(</span>Y <span class="o">~</span> X1 <span class="o">+</span> X2<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;relogit&quot;</span><span class="p">,</span> tau <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span>
                       case.control <span class="o">=</span> c<span class="p">(</span><span class="s">&quot;prior&quot;</span><span class="p">,</span> <span class="s">&quot;weighting&quot;</span><span class="p">),</span>
                       bias.correct <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> robust <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
                       data <span class="o">=</span> mydata<span class="p">,</span> <span class="kc">...</span><span class="p">)</span>
x.out <span class="o">&lt;-</span> setx<span class="p">(</span>z.out<span class="p">)</span>
s.out <span class="o">&lt;-</span> sim<span class="p">(</span>z.out<span class="p">,</span> x <span class="o">=</span> x.out<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="arguments">
<h2>Arguments<a class="headerlink" href="#arguments" title="Permalink to this headline">¶</a></h2>
<p>The relogit procedure supports four optional arguments in addition to
the standard arguments for zelig(). You may additionally use:</p>
<ul class="simple">
<li>tau: a vector containing either one or two values for <img class="math" src="_images/math/d9e99c35d3632bb156b7aca0e93cd78a148a10e8.png" alt="\tau"/>,
the true population fraction of ones. Use, for example, tau = c(0.05,
0.1) to specify that the lower bound on tau is 0.05 and the upper
bound is 0.1. If left unspecified, only finite-sample bias correction
is performed, not case-control correction.</li>
<li>case.control: if tau is specified, choose a method to correct for
case-control sampling design: “prior” (default) or “weighting”.</li>
<li>bias.correct: a logical value of TRUE (default) or FALSE indicating
whether the intercept should be corrected for finite sample (rare
events) bias.</li>
</ul>
<p>Note that if tau = NULL, bias.correct = FALSE, the
relogit procedure performs a standard logistic regression without any
correction.</p>
</div>
<div class="section" id="example-1-one-tau-with-prior-correction-and-bias-correction">
<h2>Example 1: One Tau with Prior Correction and Bias Correction<a class="headerlink" href="#example-1-one-tau-with-prior-correction-and-bias-correction" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## Error: there is no package called &#39;Zelig5&#39;</span>
</pre></div>
</div>
<p>Due to memory and space considerations, the data used here are a sample
drawn from the full data set used in King and Zeng, 2001, The proportion
of militarized interstate conflicts to the absence of disputes is
<img class="math" src="_images/math/0476daae6e85154c40577131b46dfc345e403b50.png" alt="\tau = 1,042 / 303,772
\approx 0.00343"/>. To estimate the model,</p>
<div class="highlight-r"><div class="highlight"><pre>data<span class="p">(</span>mid<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>z.out1 <span class="o">&lt;-</span> zelig<span class="p">(</span>conflict <span class="o">~</span> major <span class="o">+</span> contig <span class="o">+</span> power <span class="o">+</span> maxdem <span class="o">+</span> mindem <span class="o">+</span> years<span class="p">,</span> data <span class="o">=</span> mid<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;relogit&quot;</span><span class="p">,</span> tau <span class="o">=</span> <span class="m">1042</span><span class="o">/</span><span class="m">303772</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## How to cite this model in Zelig:</span>
<span class="c">##   Kosuke Imai, Gary King, and Olivia Lau. 2014.</span>
<span class="c">##   relogit: Rare Events Logistic Regression for Dichotomous Dependent Variables</span>
<span class="c">##   in Kosuke Imai, Gary King, and Olivia Lau, &quot;Zelig: Everyone&#39;s Statistical Software,&quot;</span>
<span class="c">##   http://datascience.iq.harvard.edu/zelig</span>
</pre></div>
</div>
<p>Summarize the model output:</p>
<div class="highlight-r"><div class="highlight"><pre>summary<span class="p">(</span>z.out1<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## Model: 1</span>
<span class="c">## Call:  relogit(formula = cbind(conflict, 1 - conflict) ~ major + contig +</span>
<span class="c">##     power + maxdem + mindem + years, data = ., tau = 0.00343020423212146,</span>
<span class="c">##     bias.correct = TRUE, case.control = &quot;prior&quot;)</span>
<span class="c">##</span>
<span class="c">## Coefficients:</span>
<span class="c">## (Intercept)        major       contig        power       maxdem</span>
<span class="c">##     -7.5084       2.4320       4.1080       1.0536       0.0480</span>
<span class="c">##      mindem        years</span>
<span class="c">##     -0.0641      -0.0629</span>
<span class="c">##</span>
<span class="c">## Degrees of Freedom: 3125 Total (i.e. Null);  3119 Residual</span>
<span class="c">## Null Deviance:       3980</span>
<span class="c">## Residual Deviance: 1870  AIC: 1880</span>
<span class="c">## Next step: Use &#39;setx&#39; method</span>
</pre></div>
</div>
<p>Set the explanatory variables to their means:</p>
<div class="highlight-r"><div class="highlight"><pre>x.out1 <span class="o">&lt;-</span> setx<span class="p">(</span>z.out1<span class="p">)</span>
</pre></div>
</div>
<p>Simulate quantities of interest:</p>
<div class="highlight-r"><div class="highlight"><pre>s.out1 <span class="o">&lt;-</span> sim<span class="p">(</span>z.out1<span class="p">,</span> x <span class="o">=</span> x.out1<span class="p">)</span>
summary<span class="p">(</span>s.out1<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">##</span>
<span class="c">##  sim x :</span>
<span class="c">##  -----</span>
<span class="c">## ev</span>
<span class="c">##          mean        sd      50%     2.5%    97.5%</span>
<span class="c">## [1,] 0.002405 0.0001483 0.002401 0.002135 0.002718</span>
<span class="c">## pv</span>
<span class="c">##          0     1</span>
<span class="c">## [1,] 0.998 0.002</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>plot<span class="p">(</span>s.out1<span class="p">)</span>
</pre></div>
</div>
<div class="figure">
<img alt="Zelig-relogit" src="_images/Zelig-relogit.png" />
<p class="caption">Zelig-relogit</p>
</div>
</div>
<div class="section" id="example-2-one-tau-with-weighting-robust-standard-errors-and-bias-correction">
<h2>Example 2: One Tau with Weighting, Robust Standard Errors, and Bias Correction<a class="headerlink" href="#example-2-one-tau-with-weighting-robust-standard-errors-and-bias-correction" title="Permalink to this headline">¶</a></h2>
<p>Suppose that we wish to perform case control correction using weighting
(rather than the default prior correction). To estimate the model:</p>
<div class="highlight-r"><div class="highlight"><pre>z.out2 <span class="o">&lt;-</span> zelig<span class="p">(</span>conflict <span class="o">~</span> major <span class="o">+</span> contig <span class="o">+</span> power <span class="o">+</span> maxdem <span class="o">+</span> mindem <span class="o">+</span> years<span class="p">,</span> data <span class="o">=</span> mid<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;relogit&quot;</span><span class="p">,</span> tau <span class="o">=</span> <span class="m">1042</span><span class="o">/</span><span class="m">303772</span><span class="p">,</span> case.control <span class="o">=</span> <span class="s">&quot;weighting&quot;</span><span class="p">,</span> robust <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## Error: unused argument (robust = TRUE)</span>
</pre></div>
</div>
<p>Summarize the model output:</p>
<div class="highlight-r"><div class="highlight"><pre>summary<span class="p">(</span>z.out2<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## Model: 1</span>
<span class="c">## Call:</span>
<span class="c">## stats::lm(formula = unem ~ gdp + trade + capmob + as.factor(country),</span>
<span class="c">##     data = .)</span>
<span class="c">##</span>
<span class="c">## Coefficients:</span>
<span class="c">##                      (Intercept)                               gdp</span>
<span class="c">##                           -5.843                            -0.110</span>
<span class="c">##                            trade                            capmob</span>
<span class="c">##                            0.144                             0.815</span>
<span class="c">##        as.factor(country)Belgium          as.factor(country)Canada</span>
<span class="c">##                           -1.599                             6.759</span>
<span class="c">##        as.factor(country)Denmark         as.factor(country)Finland</span>
<span class="c">##                            4.311                             4.810</span>
<span class="c">##         as.factor(country)France           as.factor(country)Italy</span>
<span class="c">##                            6.905                             9.290</span>
<span class="c">##          as.factor(country)Japan     as.factor(country)Netherlands</span>
<span class="c">##                            5.459                            -1.459</span>
<span class="c">##         as.factor(country)Norway          as.factor(country)Sweden</span>
<span class="c">##                           -2.754                             0.925</span>
<span class="c">## as.factor(country)United Kingdom   as.factor(country)United States</span>
<span class="c">##                            5.601                            10.066</span>
<span class="c">##   as.factor(country)West Germany</span>
<span class="c">##                            3.364</span>
<span class="c">##</span>
<span class="c">## Next step: Use &#39;setx&#39; method</span>
</pre></div>
</div>
<p>Set the explanatory variables to their means:</p>
<div class="highlight-r"><div class="highlight"><pre>x.out2 <span class="o">&lt;-</span> setx<span class="p">(</span>z.out2<span class="p">)</span>
</pre></div>
</div>
<p>Simulate quantities of interest:</p>
<div class="highlight-r"><div class="highlight"><pre>s.out2 <span class="o">&lt;-</span> sim<span class="p">(</span>z.out2<span class="p">,</span> x <span class="o">=</span> x.out2<span class="p">)</span>
summary<span class="p">(</span>s.out2<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">##</span>
<span class="c">##  sim x :</span>
<span class="c">##  -----</span>
<span class="c">## ev</span>
<span class="c">##      mean     sd     50%   2.5%  97.5%</span>
<span class="c">## 1 -0.2972 0.6787 -0.3092 -1.655 0.9859</span>
<span class="c">## pv</span>
<span class="c">##      mean     sd     50%   2.5%  97.5%</span>
<span class="c">## 1 -0.2972 0.6787 -0.3092 -1.655 0.9859</span>
</pre></div>
</div>
</div>
<div class="section" id="example-3-two-taus-with-bias-correction-and-prior-correction">
<h2>Example 3: Two Taus with Bias Correction and Prior Correction<a class="headerlink" href="#example-3-two-taus-with-bias-correction-and-prior-correction" title="Permalink to this headline">¶</a></h2>
<p>Suppose that we did not know that <img class="math" src="_images/math/3ea6d30492110055362e739a5b4776f93c6f1814.png" alt="\tau \approx 0.00343"/>, but only
that it was somewhere between <img class="math" src="_images/math/501e197d9ac2263e0c31dbecb1a332a39f7f0c84.png" alt="(0.002, 0.005)"/>. To estimate a
model with a range of feasible estimates for <img class="math" src="_images/math/d9e99c35d3632bb156b7aca0e93cd78a148a10e8.png" alt="\tau"/> (using the
default prior correction method for case control correction):</p>
<div class="highlight-r"><div class="highlight"><pre>z.out2 <span class="o">&lt;-</span> zelig<span class="p">(</span>conflict <span class="o">~</span> major <span class="o">+</span> contig <span class="o">+</span> power <span class="o">+</span> maxdem <span class="o">+</span> mindem <span class="o">+</span> years<span class="p">,</span> data <span class="o">=</span> mid<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;relogit&quot;</span><span class="p">,</span> tau <span class="o">=</span> c<span class="p">(</span><span class="m">0.002</span><span class="p">,</span> <span class="m">0.005</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## How to cite this model in Zelig:</span>
<span class="c">##   Kosuke Imai, Gary King, and Olivia Lau. 2014.</span>
<span class="c">##   relogit: Rare Events Logistic Regression for Dichotomous Dependent Variables</span>
<span class="c">##   in Kosuke Imai, Gary King, and Olivia Lau, &quot;Zelig: Everyone&#39;s Statistical Software,&quot;</span>
<span class="c">##   http://datascience.iq.harvard.edu/zelig</span>
</pre></div>
</div>
<p>Summarize the model output:</p>
<div class="highlight-r"><div class="highlight"><pre>z.out2
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## Model: 1$lower.estimate</span>
<span class="c">##</span>
<span class="c">## Call:  (function (formula, data = sys.parent(), tau = NULL, bias.correct = TRUE,</span>
<span class="c">##     case.control = &quot;prior&quot;, ...)</span>
<span class="c">## {</span>
<span class="c">##     mf &lt;- match.call()</span>
<span class="c">##     mf$tau &lt;- mf$bias.correct &lt;- mf$case.control &lt;- NULL</span>
<span class="c">##     if (!is.null(tau)) {</span>
<span class="c">##         tau &lt;- unique(tau)</span>
<span class="c">##         if (length(case.control) &gt; 1)</span>
<span class="c">##             stop(&quot;You can only choose one option for case control correction.&quot;)</span>
<span class="c">##         ck1 &lt;- grep(&quot;p&quot;, case.control)</span>
<span class="c">##         ck2 &lt;- grep(&quot;w&quot;, case.control)</span>
<span class="c">##         if (length(ck1) == 0 &amp; length(ck2) == 0)</span>
<span class="c">##             stop(&quot;choose either case.control = \&quot;prior\&quot; &quot;, &quot;or case.control = \&quot;weighting\&quot;&quot;)</span>
<span class="c">##         if (length(ck2) == 0)</span>
<span class="c">##             weighting &lt;- FALSE</span>
<span class="c">##         else weighting &lt;- TRUE</span>
<span class="c">##     }</span>
<span class="c">##     else weighting &lt;- FALSE</span>
<span class="c">##     if (length(tau) &gt; 2)</span>
<span class="c">##         stop(&quot;tau must be a vector of length less than or equal to 2&quot;)</span>
<span class="c">##     else if (length(tau) == 2) {</span>
<span class="c">##         mf[[1]] &lt;- relogit</span>
<span class="c">##         res &lt;- list()</span>
<span class="c">##         mf$tau &lt;- min(tau)</span>
<span class="c">##         res$lower.estimate &lt;- eval(as.call(mf), parent.frame())</span>
<span class="c">##         mf$tau &lt;- max(tau)</span>
<span class="c">##         res$upper.estimate &lt;- eval(as.call(mf), parent.frame())</span>
<span class="c">##         res$formula &lt;- formula</span>
<span class="c">##         class(res) &lt;- c(&quot;Relogit2&quot;, &quot;Relogit&quot;)</span>
<span class="c">##         return(res)</span>
<span class="c">##     }</span>
<span class="c">##     else {</span>
<span class="c">##         mf[[1]] &lt;- glm</span>
<span class="c">##         mf$family &lt;- binomial(link = &quot;logit&quot;)</span>
<span class="c">##         y2 &lt;- model.response(model.frame(mf$formula, data))</span>
<span class="c">##         if (is.matrix(y2))</span>
<span class="c">##             y &lt;- y2[, 1]</span>
<span class="c">##         else y &lt;- y2</span>
<span class="c">##         ybar &lt;- mean(y)</span>
<span class="c">##         if (weighting) {</span>
<span class="c">##             w1 &lt;- tau/ybar</span>
<span class="c">##             w0 &lt;- (1 - tau)/(1 - ybar)</span>
<span class="c">##             wi &lt;- w1 * y + w0 * (1 - y)</span>
<span class="c">##             mf$weights &lt;- wi</span>
<span class="c">##         }</span>
<span class="c">##         res &lt;- eval(as.call(mf), parent.frame())</span>
<span class="c">##         res$call &lt;- match.call(expand.dots = TRUE)</span>
<span class="c">##         res$tau &lt;- tau</span>
<span class="c">##         X &lt;- model.matrix(res)</span>
<span class="c">##         if (bias.correct) {</span>
<span class="c">##             pihat &lt;- fitted(res)</span>
<span class="c">##             if (is.null(tau))</span>
<span class="c">##                 wi &lt;- rep(1, length(y))</span>
<span class="c">##             else if (weighting)</span>
<span class="c">##                 res$weighting &lt;- TRUE</span>
<span class="c">##             else {</span>
<span class="c">##                 w1 &lt;- tau/ybar</span>
<span class="c">##                 w0 &lt;- (1 - tau)/(1 - ybar)</span>
<span class="c">##                 wi &lt;- w1 * y + w0 * (1 - y)</span>
<span class="c">##                 res$weighting &lt;- FALSE</span>
<span class="c">##             }</span>
<span class="c">##             W &lt;- pihat * (1 - pihat) * wi</span>
<span class="c">##             Qdiag &lt;- lm.influence(lm(y ~ X - 1, weights = W))$hat/W</span>
<span class="c">##             if (is.null(tau))</span>
<span class="c">##                 xi &lt;- 0.5 * Qdiag * (2 * pihat - 1)</span>
<span class="c">##             else xi &lt;- 0.5 * Qdiag * ((1 + w0) * pihat - w0)</span>
<span class="c">##             res$coefficients &lt;- res$coefficients - lm(xi ~ X -</span>
<span class="c">##                 1, weights = W)$coefficients</span>
<span class="c">##             res$bias.correct &lt;- TRUE</span>
<span class="c">##         }</span>
<span class="c">##         else res$bias.correct &lt;- FALSE</span>
<span class="c">##         if (!is.null(tau) &amp; !weighting) {</span>
<span class="c">##             if (tau &lt;= 0 || tau &gt;= 1)</span>
<span class="c">##                 stop(&quot;\ntau needs to be between 0 and 1.\n&quot;)</span>
<span class="c">##             res$coefficients[&quot;(Intercept)&quot;] &lt;- res$coefficients[&quot;(Intercept)&quot;] -</span>
<span class="c">##                 log(((1 - tau)/tau) * (ybar/(1 - ybar)))</span>
<span class="c">##             res$prior.correct &lt;- TRUE</span>
<span class="c">##             res$weighting &lt;- FALSE</span>
<span class="c">##         }</span>
<span class="c">##         else res$prior.correct &lt;- FALSE</span>
<span class="c">##         if (is.null(res$weighting))</span>
<span class="c">##             res$weighting &lt;- FALSE</span>
<span class="c">##         res$linear.predictors &lt;- t(res$coefficients) %*% t(X)</span>
<span class="c">##         res$fitted.values &lt;- 1/(1 + exp(-res$linear.predictors))</span>
<span class="c">##         res$zelig &lt;- &quot;Relogit&quot;</span>
<span class="c">##         class(res) &lt;- c(&quot;Relogit&quot;, &quot;glm&quot;)</span>
<span class="c">##         return(res)</span>
<span class="c">##     }</span>
<span class="c">## })(formula = cbind(conflict, 1 - conflict) ~ major + contig +</span>
<span class="c">##     power + maxdem + mindem + years, data = ., tau = 0.002)</span>
<span class="c">##</span>
<span class="c">## Coefficients:</span>
<span class="c">## (Intercept)        major       contig        power       maxdem</span>
<span class="c">##     -8.0492       2.4320       4.1079       1.0536       0.0480</span>
<span class="c">##      mindem        years</span>
<span class="c">##     -0.0641      -0.0629</span>
<span class="c">##</span>
<span class="c">## Degrees of Freedom: 3125 Total (i.e. Null);  3119 Residual</span>
<span class="c">## Null Deviance:       3980</span>
<span class="c">## Residual Deviance: 1870  AIC: 1880</span>
<span class="c">##</span>
<span class="c">## $upper.estimate</span>
<span class="c">##</span>
<span class="c">## Call:  (function (formula, data = sys.parent(), tau = NULL, bias.correct = TRUE,</span>
<span class="c">##     case.control = &quot;prior&quot;, ...)</span>
<span class="c">## {</span>
<span class="c">##     mf &lt;- match.call()</span>
<span class="c">##     mf$tau &lt;- mf$bias.correct &lt;- mf$case.control &lt;- NULL</span>
<span class="c">##     if (!is.null(tau)) {</span>
<span class="c">##         tau &lt;- unique(tau)</span>
<span class="c">##         if (length(case.control) &gt; 1)</span>
<span class="c">##             stop(&quot;You can only choose one option for case control correction.&quot;)</span>
<span class="c">##         ck1 &lt;- grep(&quot;p&quot;, case.control)</span>
<span class="c">##         ck2 &lt;- grep(&quot;w&quot;, case.control)</span>
<span class="c">##         if (length(ck1) == 0 &amp; length(ck2) == 0)</span>
<span class="c">##             stop(&quot;choose either case.control = \&quot;prior\&quot; &quot;, &quot;or case.control = \&quot;weighting\&quot;&quot;)</span>
<span class="c">##         if (length(ck2) == 0)</span>
<span class="c">##             weighting &lt;- FALSE</span>
<span class="c">##         else weighting &lt;- TRUE</span>
<span class="c">##     }</span>
<span class="c">##     else weighting &lt;- FALSE</span>
<span class="c">##     if (length(tau) &gt; 2)</span>
<span class="c">##         stop(&quot;tau must be a vector of length less than or equal to 2&quot;)</span>
<span class="c">##     else if (length(tau) == 2) {</span>
<span class="c">##         mf[[1]] &lt;- relogit</span>
<span class="c">##         res &lt;- list()</span>
<span class="c">##         mf$tau &lt;- min(tau)</span>
<span class="c">##         res$lower.estimate &lt;- eval(as.call(mf), parent.frame())</span>
<span class="c">##         mf$tau &lt;- max(tau)</span>
<span class="c">##         res$upper.estimate &lt;- eval(as.call(mf), parent.frame())</span>
<span class="c">##         res$formula &lt;- formula</span>
<span class="c">##         class(res) &lt;- c(&quot;Relogit2&quot;, &quot;Relogit&quot;)</span>
<span class="c">##         return(res)</span>
<span class="c">##     }</span>
<span class="c">##     else {</span>
<span class="c">##         mf[[1]] &lt;- glm</span>
<span class="c">##         mf$family &lt;- binomial(link = &quot;logit&quot;)</span>
<span class="c">##         y2 &lt;- model.response(model.frame(mf$formula, data))</span>
<span class="c">##         if (is.matrix(y2))</span>
<span class="c">##             y &lt;- y2[, 1]</span>
<span class="c">##         else y &lt;- y2</span>
<span class="c">##         ybar &lt;- mean(y)</span>
<span class="c">##         if (weighting) {</span>
<span class="c">##             w1 &lt;- tau/ybar</span>
<span class="c">##             w0 &lt;- (1 - tau)/(1 - ybar)</span>
<span class="c">##             wi &lt;- w1 * y + w0 * (1 - y)</span>
<span class="c">##             mf$weights &lt;- wi</span>
<span class="c">##         }</span>
<span class="c">##         res &lt;- eval(as.call(mf), parent.frame())</span>
<span class="c">##         res$call &lt;- match.call(expand.dots = TRUE)</span>
<span class="c">##         res$tau &lt;- tau</span>
<span class="c">##         X &lt;- model.matrix(res)</span>
<span class="c">##         if (bias.correct) {</span>
<span class="c">##             pihat &lt;- fitted(res)</span>
<span class="c">##             if (is.null(tau))</span>
<span class="c">##                 wi &lt;- rep(1, length(y))</span>
<span class="c">##             else if (weighting)</span>
<span class="c">##                 res$weighting &lt;- TRUE</span>
<span class="c">##             else {</span>
<span class="c">##                 w1 &lt;- tau/ybar</span>
<span class="c">##                 w0 &lt;- (1 - tau)/(1 - ybar)</span>
<span class="c">##                 wi &lt;- w1 * y + w0 * (1 - y)</span>
<span class="c">##                 res$weighting &lt;- FALSE</span>
<span class="c">##             }</span>
<span class="c">##             W &lt;- pihat * (1 - pihat) * wi</span>
<span class="c">##             Qdiag &lt;- lm.influence(lm(y ~ X - 1, weights = W))$hat/W</span>
<span class="c">##             if (is.null(tau))</span>
<span class="c">##                 xi &lt;- 0.5 * Qdiag * (2 * pihat - 1)</span>
<span class="c">##             else xi &lt;- 0.5 * Qdiag * ((1 + w0) * pihat - w0)</span>
<span class="c">##             res$coefficients &lt;- res$coefficients - lm(xi ~ X -</span>
<span class="c">##                 1, weights = W)$coefficients</span>
<span class="c">##             res$bias.correct &lt;- TRUE</span>
<span class="c">##         }</span>
<span class="c">##         else res$bias.correct &lt;- FALSE</span>
<span class="c">##         if (!is.null(tau) &amp; !weighting) {</span>
<span class="c">##             if (tau &lt;= 0 || tau &gt;= 1)</span>
<span class="c">##                 stop(&quot;\ntau needs to be between 0 and 1.\n&quot;)</span>
<span class="c">##             res$coefficients[&quot;(Intercept)&quot;] &lt;- res$coefficients[&quot;(Intercept)&quot;] -</span>
<span class="c">##                 log(((1 - tau)/tau) * (ybar/(1 - ybar)))</span>
<span class="c">##             res$prior.correct &lt;- TRUE</span>
<span class="c">##             res$weighting &lt;- FALSE</span>
<span class="c">##         }</span>
<span class="c">##         else res$prior.correct &lt;- FALSE</span>
<span class="c">##         if (is.null(res$weighting))</span>
<span class="c">##             res$weighting &lt;- FALSE</span>
<span class="c">##         res$linear.predictors &lt;- t(res$coefficients) %*% t(X)</span>
<span class="c">##         res$fitted.values &lt;- 1/(1 + exp(-res$linear.predictors))</span>
<span class="c">##         res$zelig &lt;- &quot;Relogit&quot;</span>
<span class="c">##         class(res) &lt;- c(&quot;Relogit&quot;, &quot;glm&quot;)</span>
<span class="c">##         return(res)</span>
<span class="c">##     }</span>
<span class="c">## })(formula = cbind(conflict, 1 - conflict) ~ major + contig +</span>
<span class="c">##     power + maxdem + mindem + years, data = ., tau = 0.005)</span>
<span class="c">##</span>
<span class="c">## Coefficients:</span>
<span class="c">## (Intercept)        major       contig        power       maxdem</span>
<span class="c">##     -7.1300       2.4320       4.1080       1.0536       0.0480</span>
<span class="c">##      mindem        years</span>
<span class="c">##     -0.0641      -0.0629</span>
<span class="c">##</span>
<span class="c">## Degrees of Freedom: 3125 Total (i.e. Null);  3119 Residual</span>
<span class="c">## Null Deviance:       3980</span>
<span class="c">## Residual Deviance: 1870  AIC: 1880</span>
<span class="c">##</span>
<span class="c">## $formula</span>
<span class="c">## cbind(conflict, 1 - conflict) ~ major + contig + power + maxdem +</span>
<span class="c">##     mindem + years</span>
<span class="c">## &lt;environment: 0x1092490d8&gt;</span>
<span class="c">##</span>
<span class="c">## attr(,&quot;class&quot;)</span>
<span class="c">## [1] &quot;Relogit2&quot; &quot;Relogit&quot;</span>
<span class="c">## Next step: Use &#39;setx&#39; method</span>
</pre></div>
</div>
<p>Set the explanatory variables to their means:</p>
<div class="highlight-r"><div class="highlight"><pre>x.out2 <span class="o">&lt;-</span> setx<span class="p">(</span>z.out2<span class="p">)</span>
</pre></div>
</div>
<p>Simulate quantities of interest:</p>
<div class="highlight-r"><div class="highlight"><pre>s.out <span class="o">&lt;-</span> sim<span class="p">(</span>z.out2<span class="p">,</span> x <span class="o">=</span> x.out2<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## Error: no applicable method for &#39;vcov&#39; applied to an object of class</span>
<span class="c">## &quot;c(&#39;Relogit2&#39;, &#39;Relogit&#39;)&quot;</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>summary<span class="p">(</span>s.out2<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">##</span>
<span class="c">##  sim x :</span>
<span class="c">##  -----</span>
<span class="c">## ev</span>
<span class="c">##      mean     sd     50%   2.5%  97.5%</span>
<span class="c">## 1 -0.2972 0.6787 -0.3092 -1.655 0.9859</span>
<span class="c">## pv</span>
<span class="c">##      mean     sd     50%   2.5%  97.5%</span>
<span class="c">## 1 -0.2972 0.6787 -0.3092 -1.655 0.9859</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>plot<span class="p">(</span>s.out2<span class="p">)</span>
</pre></div>
</div>
<div class="figure">
<img alt="" src="_images/unnamed-chunk-18.png" />
</div>
<p>The cost of giving a range of values for <img class="math" src="_images/math/d9e99c35d3632bb156b7aca0e93cd78a148a10e8.png" alt="\tau"/> is that point
estimates are not available for quantities of interest. Instead,
quantities are presented as confidence intervals with significance less
than or equal to a specified level (e.g., at least 95% of the
simulations are contained in the nominal 95% confidence interval).</p>
</div>
<div class="section" id="model">
<h2>Model<a class="headerlink" href="#model" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">Like the standard logistic regression, the <em>stochastic component</em> for
the rare events logistic regression is:</p>
<div class="math">
<p><img src="_images/math/e6ab2177225a79f988ab416b0353405999e15789.png" alt="Y_i \; \sim \; \textrm{Bernoulli}(\pi_i),"/></p>
</div><p>where <img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> is the binary dependent variable, and takes a value
of either 0 or 1.</p>
</li>
<li><p class="first">The <em>systematic component</em> is:</p>
<div class="math">
<p><img src="_images/math/59cf11e927045c99a310cdaa15d32bc7cfacb160.png" alt="\pi_i \; = \; \frac{1}{1 + \exp(-x_i \beta)}."/></p>
</div></li>
<li><p class="first">If the sample is generated via a case-control (or choice-based)
design, such as when drawing all events (or “cases”) and a sample
from the non-events (or “controls”) and going backwards to collect
the explanatory variables, you must correct for selecting on the
dependent variable. While the slope coefficients are approximately
unbiased, the constant term may be significantly biased. Zelig has
two methods for case control correction:</p>
<ol class="arabic">
<li><p class="first">The “prior correction” method adjusts the intercept term. Let
<img class="math" src="_images/math/d9e99c35d3632bb156b7aca0e93cd78a148a10e8.png" alt="\tau"/> be the true population fraction of events,
<img class="math" src="_images/math/eff822074d94619ea86dcccd9f1e410360a711c3.png" alt="\bar{y}"/> the fraction of events in the sample, and
<img class="math" src="_images/math/7f7c57d3dd82a0c7d00c82f510f14400a1cc4435.png" alt="\hat{\beta_0}"/> the uncorrected intercept term. The
corrected intercept <img class="math" src="_images/math/90acdaf850915294d7ef3bdc540005ee22197903.png" alt="\beta_0"/> is:</p>
<div class="math">
<p><img src="_images/math/b3f4429515a74871c61649fe2b350bfe49da7123.png" alt="\beta =  \hat{\beta_0} - \ln \left[ \bigg( \frac{1 - \tau}{\tau}
  \bigg) \bigg( \frac{\bar{y}}{1 - \bar{y}} \bigg) \right]."/></p>
</div></li>
<li><p class="first">The “weighting” method performs a weighted logistic regression to
correct for a case-control sampling design. Let the 1 subscript
denote observations for which the dependent variable is observed
as a 1, and the 0 subscript denote observations for which the
dependent variable is observed as a 0. Then the vector of weights
<img class="math" src="_images/math/b4e1bc8e2dfd2c26158273aef285b08a816f960a.png" alt="w_i"/></p>
<div class="math">
<p><img src="_images/math/50c4c6190b58f44612c516cb9e9ac3e6420f5b9c.png" alt="\begin{aligned}
w_1 &amp;=&amp; \frac{\tau}{\bar{y}} \\
w_0 &amp;=&amp; \frac{(1 - \tau)}{(1 - \bar{y})} \\
w_i &amp;=&amp; w_1 Y_i + w_0 (1 - Y_i)\end{aligned}"/></p>
</div></li>
</ol>
<p>If <img class="math" src="_images/math/d9e99c35d3632bb156b7aca0e93cd78a148a10e8.png" alt="\tau"/> is unknown, you may alternatively specify an upper
and lower bound for the possible range of <img class="math" src="_images/math/d9e99c35d3632bb156b7aca0e93cd78a148a10e8.png" alt="\tau"/>. In this case,
the relogit procedure uses “robust Bayesian” methods to generate a
confidence interval (rather than a point estimate) for each quantity
of interest. The nominal coverage of the confidence interval is at
least as great as the actual coverage.</p>
</li>
<li><p class="first">By default, estimates of the the coefficients <img class="math" src="_images/math/8ce03f78ed945f2ef3dac87c8799b55b393527e7.png" alt="\beta"/> are
bias-corrected to account for finite sample or rare events bias. In
addition, quantities of interest, such as predicted probabilities,
are also corrected of rare-events bias. If <img class="math" src="_images/math/d8af2dda6c66ca3f8936a4c3f429636ab9950ddc.png" alt="\widehat{\beta}"/>
are the uncorrected logit coefficients and
bias(<img class="math" src="_images/math/d8af2dda6c66ca3f8936a4c3f429636ab9950ddc.png" alt="\widehat{\beta}"/>) is the bias term, the corrected
coefficients <img class="math" src="_images/math/4024b5e1e832a4e71c716cc1f7383be57826b0b0.png" alt="\tilde{\beta}"/> are</p>
<div class="math">
<p><img src="_images/math/321de0f40e0675fea03bff2a20ea559cb463d6ea.png" alt="\widehat{\beta} - \textrm{bias}(\widehat{\beta}) = \tilde{\beta}"/></p>
</div><p>The bias term is</p>
<div class="math">
<p><img src="_images/math/b0553d525251be7ec5507573c00d1e00eee0e435.png" alt="\textrm{bias}(\widehat{\beta}) = (X'WX)^{-1} X'W \xi"/></p>
</div><p>where</p>
<div class="math">
<p><img src="_images/math/ffeae8f68e041844fe15a30663badb58587cb67d.png" alt="\begin{aligned}
\xi_i &amp;=&amp; 0.5 Q_{ii} \Big( (1 + w-1)\widehat{\pi}_i - w_1 \Big) \\
Q &amp;=&amp; X(X'WX)^{-1} X' \\
W = \textrm{diag}\{\widehat{\pi}_i (1 - \widehat{\pi}_i) w_i\}\end{aligned}"/></p>
</div><p>where <img class="math" src="_images/math/b4e1bc8e2dfd2c26158273aef285b08a816f960a.png" alt="w_i"/> and <img class="math" src="_images/math/ee71d9a60992887aa4b7a1e010886633661a7ada.png" alt="w_1"/> are given in the “weighting”
section above.</p>
</li>
</ul>
</div>
<div class="section" id="quantities-of-interest">
<h2>Quantities of Interest<a class="headerlink" href="#quantities-of-interest" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">For either one or no <img class="math" src="_images/math/d9e99c35d3632bb156b7aca0e93cd78a148a10e8.png" alt="\tau"/>:</p>
<ul>
<li><p class="first">The expected values (qi$ev) for the rare events logit are
simulations of the predicted probability</p>
<div class="math">
<p><img src="_images/math/fd2856bc7fec152ef785c927c85393b0f70596ac.png" alt="E(Y) = \pi_i =
    \frac{1}{1 + \exp(-x_i \beta)},"/></p>
</div><p>given draws of <img class="math" src="_images/math/8ce03f78ed945f2ef3dac87c8799b55b393527e7.png" alt="\beta"/> from its posterior.</p>
</li>
<li><p class="first">The predicted value (qi$pr) is a draw from a binomial distribution
with mean equal to the simulated <img class="math" src="_images/math/916754f7e7de4247fa27c52f610948b4055311fe.png" alt="\pi_i"/>.</p>
</li>
<li><p class="first">The first difference (qi$fd) is defined as</p>
<div class="math">
<p><img src="_images/math/9b4dec5fa18c43963e1e8ce022f3dce869dc2403.png" alt="\textrm{FD} = \Pr(Y = 1 \mid x_1, \tau) - \Pr(Y = 1 \mid x, \tau)."/></p>
</div></li>
<li><p class="first">The risk ratio (qi$rr) is defined as</p>
<div class="math">
<p><img src="_images/math/840169782526b263d8745f139e906c4cbb6be812.png" alt="\textrm{RR} = \Pr(Y = 1 \mid x_1, \tau) \ / \ \Pr(Y = 1 \mid x, \tau)."/></p>
</div></li>
</ul>
</li>
<li><p class="first">For a range of <img class="math" src="_images/math/d9e99c35d3632bb156b7aca0e93cd78a148a10e8.png" alt="\tau"/> defined by <img class="math" src="_images/math/9c8d376f26cfc87ab8a0956d91e826558ef973d6.png" alt="[\tau_1, \tau_2]"/>, each
of the quantities of interest are <img class="math" src="_images/math/4f7a2e44ef1042deffae3520085171846386e918.png" alt="n \times 2"/> matrices, which
report the lower and upper bounds, respectively, for a confidence
interval with nominal coverage at least as great as the actual
coverage. At worst, these bounds are conservative estimates for the
likely range for each quantity of interest. Please refer to for the
specific method of calculating bounded quantities of interest.</p>
</li>
<li><p class="first">In conditional prediction models, the average expected treatment
effect (att.ev) for the treatment group is</p>
<div class="math">
<p><img src="_images/math/f120915a77efb3200aab141647a59f51df9b4611.png" alt="\frac{1}{\sum_{i=1}^n t_i}\sum_{i:t_i=1}^n \left\{ Y_i(t_i=1) -
      E[Y_i(t_i=0)] \right\},"/></p>
</div><p>where <img class="math" src="_images/math/64283d3d8caf93093b91aba9a61dbe26b5c18562.png" alt="t_i"/> is a binary explanatory variable defining the
treatment (<img class="math" src="_images/math/cc6ccc003db65691c9d0aebb91b2001e0d752d18.png" alt="t_i=1"/>) and control (<img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>) groups.
Variation in the simulations are due to uncertainty in simulating
<img class="math" src="_images/math/f658a3cf4cf830cd65eab505c530fb4796fea0ed.png" alt="E[Y_i(t_i=0)]"/>, the counterfactual expected value of
<img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> for observations in the treatment group, under the
assumption that everything stays the same except that the treatment
indicator is switched to <img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>.</p>
</li>
<li><p class="first">In conditional prediction models, the average predicted treatment
effect (att.pr) for the treatment group is</p>
<div class="math">
<p><img src="_images/math/da7e72f6d651b92ad0874d3b40cd633ac38f5663.png" alt="\frac{1}{\sum_{i=1}^n t_i}\sum_{i:t_i=1}^n \left\{ Y_i(t_i=1) -
      \widehat{Y_i(t_i=0)} \right\},"/></p>
</div><p>where <img class="math" src="_images/math/64283d3d8caf93093b91aba9a61dbe26b5c18562.png" alt="t_i"/> is a binary explanatory variable defining the
treatment (<img class="math" src="_images/math/cc6ccc003db65691c9d0aebb91b2001e0d752d18.png" alt="t_i=1"/>) and control (<img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>) groups.
Variation in the simulations are due to uncertainty in simulating
<img class="math" src="_images/math/8056bf28681ea8573bf29bfeb3c72dffa40a2fa7.png" alt="\widehat{Y_i(t_i=0)}"/>, the counterfactual predicted value of
<img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> for observations in the treatment group, under the
assumption that everything stays the same except that the treatment
indicator is switched to <img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>.</p>
</li>
</ul>
</div>
<div class="section" id="output-values">
<h2>Output Values<a class="headerlink" href="#output-values" title="Permalink to this headline">¶</a></h2>
<p>The output of each Zelig command contains useful information which you
may view. For example, if you run
<tt class="docutils literal"><span class="pre">z.out</span> <span class="pre">&lt;-</span> <span class="pre">zelig(y</span> <span class="pre">~</span> <span class="pre">x,</span> <span class="pre">model</span> <span class="pre">=</span> <span class="pre">relogit,</span> <span class="pre">data)</span></tt>, then you may examine
the available information in <tt class="docutils literal"><span class="pre">z.out</span></tt> by using <tt class="docutils literal"><span class="pre">names(z.out)</span></tt>, see
the coefficients by using z.out$coefficients, and a default summary of
information through <tt class="docutils literal"><span class="pre">summary(z.out)</span></tt>.</p>
</div>
<div class="section" id="differences-with-stata-version">
<h2>Differences with Stata Version<a class="headerlink" href="#differences-with-stata-version" title="Permalink to this headline">¶</a></h2>
<p>The Stata version of ReLogit and the R implementation differ slightly in
their coefficient estimates due to differences in the matrix inversion
routines implemented in R and Stata. Zelig uses orthogonal-triangular
decomposition (through lm.influence()) to compute the bias term, which
is more numerically stable than standard matrix calculations.</p>
</div>
<div class="section" id="see-also">
<h2>See also<a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h2>
</div>
</div>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="_sources/zelig-relogit.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2014, The Zelig Team.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.2.<br/>
    </p>
  </div>
</footer>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-27761864-7', 'pydata.org');
  ga('send', 'pageview');

</script>



  </body>
</html>