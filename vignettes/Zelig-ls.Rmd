---
title: "Zelig-ls"
output:
  html_document:
    toc: true
---

<!--
%\VignetteEngine{knitr::knitr}
%\VignetteIndexEntry{Model: Zelig-ls}
-->

## Least Squares Regression for Continuous Dependent Variables

### Syntax

```{r, eval = FALSE}
z.out <- zelig(Y ~ X1 + X2, model = "ls", data = mydata)
x.out <- setx(z.out)
s.out <- sim(z.out, x = x.out)
```
    
### Examples

#### Basic Example with First Differences

Attach sample data:

```{r echo = FALSE}
suppressPackageStartupMessages(library(Zelig5))
data(macro)
```


```{r eval = FALSE}
library(Zelig5)
data(macro)
```

Estimate model:

```{r}
z.out1 <- zelig(unem ~ gdp + capmob + trade, model = "ls", data = macro)
```

Summarize regression coefficients:

```{r}
summary(z.out1)
```

Set explanatory variables to their default (mean/mode) values, with high (80th percentile) and low (20th percentile) values for the trade variable:

```{r}
x.high <- setx(z.out1, trade = quantile(macro$trade, 0.8))
x.low <- setx(z.out1, trade = quantile(macro$trade, 0.2))
```

Generate first differences for the effect of high versus low trade on GDP:

```{r}
s.out1 <- sim(z.out1, x = x.high, x1 = x.low)
summary(s.out1)
```

#### Using Dummy Variables

Estimate a model with fixed effects for each country. Note that you do not need to create dummy variables, as the program will automatically parse the unique values in the selected variable into discrete levels.

```{r}
z.out2 <- zelig(unem ~ gdp + trade + capmob + country,
                model = "ls", data = macro)

z.out3 <- zelig(unem ~ gdp + trade + capmob + as.factor(country),
                model = "ls", data = macro)
x.US <- setx(z.out3, country = "United States")
```

Set values for the explanatory variables, using the default mean/mode values, with country set to the United States and Japan, respectively:

```{r}
x.US <- setx(z.out2, country = "United States")
x.Japan <- setx(z.out2, country = "Japan")
```

Simulate quantities of interest:

```{r}
s.out2 <- sim(z.out2, x.US, x.Japan)
```

### Model

- The _stochastic component_ is described by a density with mean $\mu_i$ and the common variance $\sigma^2$
  $$Y_i \; \sim \; f(y_i \mid \mu_i, \sigma^2).$$
  
- The _systematic component_ models the conditional mean as
  $$\mu_i =  x_i \beta$$
  where $x_i$ is the vector of covariates, and $\beta$ is the vector of coefficients.

 The least squares estimator is the best linear predictor of a dependent variable given $x_i$, and minimizes the sum of squared residuals, $\sum_{i=1}^n (Y_i-x_i \beta)^2$.

### Quantities of Interest

The expected value (`qi\$ev`) is the mean of simulations
  from the stochastic component,  
$$ E(Y) = x_i \beta,$$
given a draw of $\beta$ from its sampling distribution. 

In conditional prediction models, the average expected treatment
  effect (att.ev) for the treatment group is 
    $$\frac{1}{\sum_{i=1}^n t_i}\sum_{i:t_i=1}^n \left\{ Y_i(t_i=1) -
      E[Y_i(t_i=0)] \right\}$$
    where $t_i$ is a binary explanatory variable defining the treatment
    ($t_i=1$) and control ($t_i=0$) groups.  Variation in the
    simulations are due to uncertainty in simulating $E[Y_i(t_i=0)]$,
    the counterfactual expected value of $Y_i$ for observations in the
    treatment group, under the assumption that everything stays the
    same except that the treatment indicator is switched to $t_i=0$.

### Output values...


