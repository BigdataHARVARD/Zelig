<span>poisson</span>: Poisson Regression for Event Count Dependent Variables {#poisson}
============================================================================

Use the Poisson regression model if the observations of your dependent
variable represents the number of independent events that occur during a
fixed period of time (see the negative binomial model, , for
over-dispersed event counts.) For a Bayesian implementation of this
model, see .

### Syntax

    > z.out <- zelig(Y ~ X1 + X2, model = "poisson", data = mydata)
    > x.out <- setx(z.out)
    > s.out <- sim(z.out, x = x.out)

### Additional Inputs

In addition to the standard inputs, <span>zelig()</span> takes the
following additional options for poisson regression:

-   <span>robust</span>: defaults to <span>FALSE</span>. If
    <span>TRUE</span> is selected, <span>zelig()</span> computes robust
    standard errors via the <span>sandwich</span> package (see
    @Zeileis04). The default type of robust standard error is
    heteroskedastic and autocorrelation consistent (HAC), and assumes
    that observations are ordered by time index.

    In addition, <span>robust</span> may be a list with the following
    options:

    -   <span>method</span>: Choose from

        -   <span>“vcovHAC”</span>: (default if <span>robust =
            TRUE</span>) HAC standard errors.

        -   <span>“kernHAC”</span>: HAC standard errors using the
            weights given in @Andrews91.

        -   <span>“weave”</span>: HAC standard errors using the weights
            given in @LumHea99.

    -   <span>order.by</span>: defaults to <span>NULL</span> (the
        observations are chronologically ordered as in the original
        data). Optionally, you may specify a vector of weights (either
        as <span>order.by = z</span>, where <span>z</span> exists
        outside the data frame; or as <span>order.by = \~z</span>, where
        <span>z</span> is a variable in the data frame). The
        observations are chronologically ordered by the size of
        <span>z</span>.

    -   <span>…</span>: additional options passed to the functions
        specified in <span>method</span>. See the <span>sandwich</span>
        library and @Zeileis04 for more options.

### Example

Load sample data:

RRR\> data(sanction)

Estimate Poisson model:

RRR\> z.out \<- zelig(num   target + coop, model = “poisson”, data =
sanction)

RRR\> summary(z.out)

Set values for the explanatory variables to their default mean values:

RRR\> x.out \<- setx(z.out)

Simulate fitted values:

RRR\> s.out \<- sim(z.out, x = x.out)

RRR\> summary(s.out)

RRR\> plot(s.out)

![image](vigpics/poisson-ExamplePlot)

### Model

Let $Y_i$ be the number of independent events that occur during a fixed
time period. This variable can take any non-negative integer.

-   The Poisson distribution has *stochastic component*

    $$Y_i \; \sim \; \textrm{Poisson}(\lambda_i),$$

    where $\lambda_i$ is the mean and variance parameter.

-   The *systematic component* is

    $$\lambda_i \; = \; \exp(x_i \beta),$$

    where $x_i$ is the vector of explanatory variables, and $\beta$ is
    the vector of coefficients.

### Quantities of Interest

-   The expected value (<span>qi\$ev</span>) is the mean of simulations
    from the stochastic component, $$E(Y) = \lambda_i =  \exp(x_i
      \beta),$$ given draws of $\beta$ from its sampling distribution.

-   The predicted value (<span>qi\$pr</span>) is a random draw from the
    poisson distribution defined by mean $\lambda_i$.

-   The first difference in the expected values (<span>qi\$fd</span>) is
    given by:

    $$\textrm{FD} \; = \; E(Y | x_1) - E(Y \mid x)$$

-   In conditional prediction models, the average expected treatment
    effect (<span>att.ev</span>) for the treatment group is

    $$\frac{1}{\sum_{i=1}^n t_i}\sum_{i:t_i=1}^n \left\{ Y_i(t_i=1) -
          E[Y_i(t_i=0)] \right\},$$

    where $t_i$ is a binary explanatory variable defining the treatment
    ($t_i=1$) and control ($t_i=0$) groups. Variation in the simulations
    are due to uncertainty in simulating $E[Y_i(t_i=0)]$, the
    counterfactual expected value of $Y_i$ for observations in the
    treatment group, under the assumption that everything stays the same
    except that the treatment indicator is switched to $t_i=0$.

-   In conditional prediction models, the average predicted treatment
    effect (<span>att.pr</span>) for the treatment group is

    $$\frac{1}{\sum_{i=1}^n t_i}\sum_{i:t_i=1}^n \left\{ Y_i(t_i=1) -
          \widehat{Y_i(t_i=0)} \right\},$$

    where $t_i$ is a binary explanatory variable defining the treatment
    ($t_i=1$) and control ($t_i=0$) groups. Variation in the simulations
    are due to uncertainty in simulating $\widehat{Y_i(t_i=0)}$, the
    counterfactual predicted value of $Y_i$ for observations in the
    treatment group, under the assumption that everything stays the same
    except that the treatment indicator is switched to $t_i=0$.

### Output Values

The output of each Zelig command contains useful information which you
may view. For example, if you run
`z.out <- zelig(y ~ x, model = poisson, data)`, then you may examine the
available information in `z.out` by using `names(z.out)`, see the
<span>coefficients</span> by using <span>z.out\$coefficients</span>, and
a default summary of information through `summary(z.out)`. Other
elements available through the <span>\$</span> operator are listed
below.

-   From the <span>zelig()</span> output object <span>z.out</span>, you
    may extract:

    -   <span>coefficients</span>: parameter estimates for the
        explanatory variables.

    -   <span>residuals</span>: the working residuals in the final
        iteration of the IWLS fit.

    -   <span>fitted.values</span>: a vector of the fitted values for
        the systemic component $\lambda$.

    -   <span>linear.predictors</span>: a vector of $x_{i}\beta$.

    -   <span>aic</span>: Akaike’s Information Criterion (minus twice
        the maximized log-likelihood plus twice the number of
        coefficients).

    -   <span>df.residual</span>: the residual degrees of freedom.

    -   <span>df.null</span>: the residual degrees of freedom for the
        null model.

    -   <span>zelig.data</span>: the input data frame if <span>save.data
        = TRUE</span>.

-   From <span>summary(z.out)</span>, you may extract:

    -   <span>coefficients</span>: the parameter estimates with their
        associated standard errors, $p$-values, and $t$-statistics.

    -   <span>cov.scaled</span>: a $k \times k$ matrix of scaled
        covariances.

    -   <span>cov.unscaled</span>: a $k \times k$ matrix of unscaled
        covariances.

-   From the <span>sim()</span> output object <span>s.out</span>, you
    may extract quantities of interest arranged as matrices indexed by
    simulation $\times$ <span>x</span>-observation (for more than one
    <span>x</span>-observation). Available quantities are:

    -   <span>qi\$ev</span>: the simulated expected values given the
        specified values of <span>x</span>.

    -   <span>qi\$pr</span>: the simulated predicted values drawn from
        the distributions defined by $\lambda_i$.

    -   <span>qi\$fd</span>: the simulated first differences in the
        expected values given the specified values of <span>x</span> and
        <span>x1</span>.

    -   <span>qi\$att.ev</span>: the simulated average expected
        treatment effect for the treated from conditional prediction
        models.

    -   <span>qi\$att.pr</span>: the simulated average predicted
        treatment effect for the treated from conditional prediction
        models.

How to Cite {#how-to-cite .unnumbered}
-----------

See also {#see-also .unnumbered}
--------

The poisson model is part of the stats package by @VenRip02. Advanced
users may wish to refer to `help(glm)` and `help(family)`, as well as
@McCNel89. Robust standard errors are implemented via the sandwich
package by @Zeileis04. Sample data are from @Martin92.
