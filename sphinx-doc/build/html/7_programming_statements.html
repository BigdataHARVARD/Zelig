<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Programming Statements &mdash; Zelig 5.0 documentation</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.1.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.1.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '5.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="Zelig 5.0 documentation" href="index.html" />
    <link rel="next" title="Writing New Models" href="8_writing_new_models.html" />
    <link rel="prev" title="R Objects" href="6_R_objects.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          Zelig</a>
        <span class="navbar-text navbar-version pull-left"><b>5</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="1_introduction.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="1_introduction.html#what-zelig-and-r-do">What Zelig and R Do</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_introduction.html#getting-help">Getting Help</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_introduction.html#how-to-cite-zelig">How to Cite Zelig</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="2_install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="2_install.html#if-you-know-r">If You Know R</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_install.html#if-you-are-new-to-r">If You Are New to R</a><ul>
<li class="toctree-l3"><a class="reference internal" href="2_install.html#windows">Windows</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="2_install.html#installing-r">Installing R</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_install.html#installing-zelig">Installing Zelig</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_install.html#updating-zelig">Updating Zelig</a><ul>
<li class="toctree-l3"><a class="reference internal" href="2_install.html#macos-x">MacOS X</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="2_install.html#id2">Installing R</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_install.html#id3">Installing Zelig</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_install.html#id4">Updating Zelig</a><ul>
<li class="toctree-l3"><a class="reference internal" href="2_install.html#unix-and-linux">UNIX and Linux</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="2_install.html#id5">Installing R</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_install.html#id6">Installing Zelig</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_install.html#id7">Updating Zelig</a><ul>
<li class="toctree-l3"><a class="reference internal" href="2_install.html#version-compatability">Version Compatability</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="3_data_analysis.html">Data Analysis Commands</a><ul>
<li class="toctree-l2"><a class="reference internal" href="3_data_analysis.html#command-syntax">Command Syntax</a><ul>
<li class="toctree-l3"><a class="reference internal" href="3_data_analysis.html#getting-started">Getting Started</a></li>
<li class="toctree-l3"><a class="reference internal" href="3_data_analysis.html#details">Details</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="3_data_analysis.html#data-sets">Data Sets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="3_data_analysis.html#data-structures">Data Structures</a></li>
<li class="toctree-l3"><a class="reference internal" href="3_data_analysis.html#loading-data">Loading Data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="3_data_analysis.html#standard-ways-to-load-data">Standard Ways to Load Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="3_data_analysis.html#special-cases-when-loading-data">Special Cases When Loading Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="3_data_analysis.html#verifying-you-loaded-the-data-correctly">Verifying You Loaded The Data Correctly</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="3_data_analysis.html#saving-data">Saving Data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="3_data_analysis.html#variables">Variables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="3_data_analysis.html#classes-of-variables">Classes of Variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="3_data_analysis.html#types-of-variables">Types of Variables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="3_data_analysis.html#recoding-variables">Recoding Variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="3_data_analysis.html#extracting-replacing-and-generating-new-variables">Extracting, Replacing, and Generating New Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="3_data_analysis.html#logical-operators">Logical Operators</a></li>
<li class="toctree-l4"><a class="reference internal" href="3_data_analysis.html#coding-and-recoding-variables">Coding and Recoding Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="3_data_analysis.html#missing-data">Missing Data</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="4_statistical_commands.html">Statistical Commands</a><ul>
<li class="toctree-l2"><a class="reference internal" href="4_statistical_commands.html#zelig-commands">Zelig Commands</a><ul>
<li class="toctree-l3"><a class="reference internal" href="4_statistical_commands.html#quick-overview">Quick Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="4_statistical_commands.html#examples">Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="4_statistical_commands.html#details">Details</a><ul>
<li class="toctree-l4"><a class="reference internal" href="4_statistical_commands.html#presenting-results">Presenting Results</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="4_statistical_commands.html#describe-describe-a-models-systematic-and-stochastic-parameters">describe: Describe a model’s systematic and stochastic parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="4_statistical_commands.html#supported-models">Supported Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="4_statistical_commands.html#replication-procedures">Replication Procedures</a><ul>
<li class="toctree-l3"><a class="reference internal" href="4_statistical_commands.html#saving-replication-materials">Saving Replication Materials</a></li>
<li class="toctree-l3"><a class="reference internal" href="4_statistical_commands.html#replicating-analyses">Replicating Analyses</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="5_graphing_commands.html">Graphing Commands</a><ul>
<li class="toctree-l2"><a class="reference internal" href="5_graphing_commands.html#drawing-plots">Drawing Plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="5_graphing_commands.html#adding-points-lines-and-legends-to-existing-plots">Adding Points, Lines, and Legends to Existing Plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="5_graphing_commands.html#saving-graphs-to-files">Saving Graphs to Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="5_graphing_commands.html#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="5_graphing_commands.html#descriptive-plots-box-plots">Descriptive Plots: Box-plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="5_graphing_commands.html#density-plots-a-histogram">Density Plots: A Histogram</a></li>
<li class="toctree-l3"><a class="reference internal" href="5_graphing_commands.html#advanced-examples">Advanced Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="6_R_objects.html">R Objects</a><ul>
<li class="toctree-l2"><a class="reference internal" href="6_R_objects.html#scalar-values">Scalar Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="6_R_objects.html#data-structures">Data Structures</a><ul>
<li class="toctree-l3"><a class="reference internal" href="6_R_objects.html#arrays">Arrays</a><ul>
<li class="toctree-l4"><a class="reference internal" href="6_R_objects.html#ways-to-create-arrays">Ways to create arrays</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="6_R_objects.html#lists">Lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="6_R_objects.html#data-frames">Data Frames</a></li>
<li class="toctree-l3"><a class="reference internal" href="6_R_objects.html#identifying-objects-and-data-structures">Identifying Objects and Data Structures</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Programming Statements</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#functions">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#if-statements">If-Statements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#for-loops">For-Loops</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#example-1-creating-a-vector-with-a-logical-statement">Example 1: Creating a vector with a logical statement</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-2-creating-dummy-variables-by-hand">Example 2: Creating dummy variables by hand</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-3-weighted-regression-with-subsets">Example 3: Weighted regression with subsets</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="8_writing_new_models.html">Writing New Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="8_writing_new_models.html#managing-statistical-model-inputs">Managing Statistical Model Inputs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="8_writing_new_models.html#describe-the-statistical-model">Describe the Statistical Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="8_writing_new_models.html#single-response-variable-models-normal-regression-model">Single Response Variable Models: Normal Regression Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="8_writing_new_models.html#multivariate-models-bivariate-normal-example">Multivariate models: Bivariate Normal example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="8_writing_new_models.html#easy-ways-to-manage-matrices">Easy Ways to Manage Matrices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="8_writing_new_models.html#the-intuitive-layout">The Intuitive Layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="8_writing_new_models.html#the-computationally-efficient-layout">The Computationally-Efficient Layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="8_writing_new_models.html#the-memory-efficient-layout">The Memory-Efficient Layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="8_writing_new_models.html#interchanging-the-three-methods">Interchanging the Three Methods</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="9_adding_models_and_methods.html">Adding Models and Methods to Zelig</a><ul>
<li class="toctree-l2"><a class="reference internal" href="9_adding_models_and_methods.html#making-the-model-compatible-with-zelig">Making the Model Compatible with Zelig</a><ul>
<li class="toctree-l3"><a class="reference internal" href="9_adding_models_and_methods.html#to-work-with-zelig">To Work with zelig()</a></li>
<li class="toctree-l3"><a class="reference internal" href="9_adding_models_and_methods.html#to-work-with-setx">To Work with setx()</a></li>
<li class="toctree-l3"><a class="reference internal" href="9_adding_models_and_methods.html#compatibility-with-sim">Compatibility with sim()</a><ul>
<li class="toctree-l4"><a class="reference internal" href="9_adding_models_and_methods.html#simulating-parameters">Simulating Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="9_adding_models_and_methods.html#calculating-quantities-of-interest">Calculating Quantities of Interest</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="9_adding_models_and_methods.html#getting-ready-for-the-gui">Getting Ready for the GUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="9_adding_models_and_methods.html#formatting-reference-manual-pages">Formatting Reference Manual Pages</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="10_faq.html">Frequently Asked Questions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="10_faq.html#for-all-zelig-users">For All Zelig Users</a><ul>
<li class="toctree-l3"><a class="reference internal" href="10_faq.html#how-do-i-cite-zelig">How do I cite Zelig?</a></li>
<li class="toctree-l3"><a class="reference internal" href="10_faq.html#why-cant-i-install-zelig">Why can’t I install Zelig?</a></li>
<li class="toctree-l3"><a class="reference internal" href="10_faq.html#why-cant-i-install-r">Why can’t I install R?</a></li>
<li class="toctree-l3"><a class="reference internal" href="10_faq.html#why-cant-i-load-data">Why can’t I load data?</a></li>
<li class="toctree-l3"><a class="reference internal" href="10_faq.html#where-can-i-find-old-versions-of-zelig">Where can I find old versions of Zelig?</a></li>
<li class="toctree-l3"><a class="reference internal" href="10_faq.html#some-zelig-functions-dont-work-for-me">Some Zelig functions don’t work for me!</a></li>
<li class="toctree-l3"><a class="reference internal" href="10_faq.html#who-can-i-ask-for-help-how-do-i-report-bugs">Who can I ask for help? How do I report bugs?</a></li>
<li class="toctree-l3"><a class="reference internal" href="10_faq.html#how-do-i-increase-the-memory-for-r">How do I increase the memory for R?</a></li>
<li class="toctree-l3"><a class="reference internal" href="10_faq.html#why-doesnt-the-pdf-print-properly">Why doesn’t the pdf print properly?</a></li>
<li class="toctree-l3"><a class="reference internal" href="10_faq.html#r-is-neat-how-can-i-find-out-more">R is neat. How can I find out more?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="10_faq.html#for-zelig-contributors">For Zelig Contributors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="10_faq.html#where-can-i-find-the-source-code-for-zelig">Where can I find the source code for Zelig?</a></li>
<li class="toctree-l3"><a class="reference internal" href="10_faq.html#how-can-i-make-my-r-programs-run-faster">How can I make my R programs run faster?</a></li>
<li class="toctree-l3"><a class="reference internal" href="10_faq.html#which-compilers-can-i-use-with-r-and-zelig">Which compilers can I use with R and Zelig?</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Programming Statements</a><ul>
<li><a class="reference internal" href="#functions">Functions</a></li>
<li><a class="reference internal" href="#if-statements">If-Statements</a></li>
<li><a class="reference internal" href="#for-loops">For-Loops</a><ul>
<li><a class="reference internal" href="#example-1-creating-a-vector-with-a-logical-statement">Example 1: Creating a vector with a logical statement</a></li>
<li><a class="reference internal" href="#example-2-creating-dummy-variables-by-hand">Example 2: Creating dummy variables by hand</a></li>
<li><a class="reference internal" href="#example-3-weighted-regression-with-subsets">Example 3: Weighted regression with subsets</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="6_R_objects.html" title="Previous Chapter: R Objects"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; R Objects</span>
    </a>
  </li>
  <li>
    <a href="8_writing_new_models.html" title="Next Chapter: Writing New Models"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">Writing New Mode... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="_sources/7_programming_statements.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="programming-statements">
<h1>Programming Statements<a class="headerlink" href="#programming-statements" title="Permalink to this headline">¶</a></h1>
<p>This chapter introduces the main programming commands. These include
functions, if-else statements, for-loops, and special procedures for
managing the inputs to statistical models.</p>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<p>Functions are either built-in or user-defined sets of encapsulated
commands which may take any number of arguments. Preface a function with
the function statement and use the &lt;- operator to assign functions to
objects in your workspace.</p>
<p>You may use functions to run the same procedure on different objects in
your workspace. For example,</p>
<div class="highlight-r"><div class="highlight"><pre>check <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>p<span class="p">,</span> q<span class="p">)</span> <span class="p">{</span>
 result <span class="o">&lt;-</span> <span class="p">(</span>p <span class="o">-</span> q<span class="p">)</span><span class="o">/</span>q
 result
 <span class="p">}</span>
</pre></div>
</div>
<p>is a simple function with arguments p and q which calculates the
difference between the <span class="math">\(i\)</span>th elements of the vector p and the
<span class="math">\(i\)</span>th element of the vector q as a proportion of the
<span class="math">\(i\)</span>th element of q, and returns the resulting vector. For
example, check(p = 10, q = 2) returns 4. You may omit the descriptors as
long as you keep the arguments in the correct order: check(10, 2) also
returns 4. You may also use other objects as inputs to the function. If
again = 10 and really = 2, then check(p = again, q = really) and
check(again, really) also returns 4.</p>
<p>Because functions run commands as a set, you should make sure that each
command in your function works by testing each line of the function at
the R prompt.</p>
</div>
<div class="section" id="if-statements">
<h2>If-Statements<a class="headerlink" href="#if-statements" title="Permalink to this headline">¶</a></h2>
<p>Use if (and optionally, else) to control the flow of R functions. For
example, let x and y be scalar numerical values:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="kr">if</span> <span class="p">(</span>x <span class="o">==</span> y<span class="p">)</span> <span class="p">{</span>                <span class="c1"># If the logical statement in the ()&#39;s is true,</span>
  x <span class="o">&lt;-</span> <span class="kc">NA</span>                    <span class="c1">#  then `x&#39; is changed to `NA&#39; (missing value).</span>
<span class="p">}</span>
<span class="kr">else</span> <span class="p">{</span>                       <span class="c1"># The `else&#39; statement tells R what to do if</span>
  x <span class="o">&lt;-</span> x<span class="o">^</span><span class="m">2</span>                   <span class="c1">#  the if-statement is false.</span>
<span class="p">}</span>
</pre></div>
</div>
<p>As with a function, use { and } to define the set of commands associated
with each if and else statement. (If you include if statements inside
functions, you may have multiple sets of nested curly braces.)</p>
</div>
<div class="section" id="for-loops">
<h2>For-Loops<a class="headerlink" href="#for-loops" title="Permalink to this headline">¶</a></h2>
<p>Use for to repeat (loop) operations. Avoiding loops by using matrix or
vector commands is usually faster and more elegant, but loops are
sometimes necessary to assign values. If you are using a loop to assign
values to a data structure, you must first initialize an empty data
structure to hold the values you are assigning.</p>
<p>Select a data structure compatible with the type of output your loop
will generate. If your loop generates a scalar, store it in a vector
(with the <span class="math">\(i\)</span>th value in the vector corresponding to the the
<span class="math">\(i\)</span>th run of the loop). If your loop generates vector output,
store them as rows (or columns) in a matrix, where the <span class="math">\(i\)</span>th row
(or column) corresponds to the <span class="math">\(i\)</span>th iteration of the loop. If
your output consists of matrices, stack them into an array. For list
output (such as regression output) or output that changes dimensions in
each iteration, use a list. To initialize these data structures, use:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> x <span class="o">&lt;-</span> vector<span class="p">()</span>                          <span class="c1"># An empty vector of any length.</span>
<span class="o">&gt;</span> x <span class="o">&lt;-</span> list<span class="p">()</span>                            <span class="c1"># An empty list of any length.</span>
</pre></div>
</div>
<p>The vector() and list() commands create a vector or list of any length,
such that assigning x[5] &lt;- 15 automatically creates a vector with 5
elements, the first four of which are empty values (NA). In contrast,
the matrix() and array() commands create data structures that are
restricted to their original dimensions.</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> x <span class="o">&lt;-</span> matrix<span class="p">(</span>nrow <span class="o">=</span> <span class="m">5</span><span class="p">,</span> ncol <span class="o">=</span> <span class="m">2</span><span class="p">)</span>  <span class="c1"># A matrix with 5 rows and 2 columns.</span>
<span class="o">&gt;</span> x <span class="o">&lt;-</span> array<span class="p">(</span>dim <span class="o">=</span> c<span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">))</span>       <span class="c1"># A 3D array of 3 stacked 5 by 2 matrices.</span>
</pre></div>
</div>
<p>If you attempt to assign a value at <span class="math">\((100, 200, 20)\)</span> to either of
these data structures, R will return an error message (“subscript is out
of bounds”). R does not automatically extend the dimensions of either a
matrix or an array to accommodate additional values.</p>
<div class="section" id="example-1-creating-a-vector-with-a-logical-statement">
<h3>Example 1: Creating a vector with a logical statement<a class="headerlink" href="#example-1-creating-a-vector-with-a-logical-statement" title="Permalink to this headline">¶</a></h3>
<div class="highlight-r"><div class="highlight"><pre>x <span class="o">&lt;-</span> array<span class="p">()</span>             <span class="c1"># Initializes an empty data structure.</span>
<span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">)</span> <span class="p">{</span>        <span class="c1"># Loops through every value from 1 to 10, replacing</span>
  <span class="kr">if</span> <span class="p">(</span>is.integer<span class="p">(</span>i<span class="o">/</span><span class="m">2</span><span class="p">))</span> <span class="p">{</span> <span class="c1">#  the even values in `x&#39; with i+5.</span>
    x<span class="p">[</span>i<span class="p">]</span> <span class="o">&lt;-</span> i <span class="o">+</span> <span class="m">5</span>
  <span class="p">}</span>
<span class="p">}</span>                        <span class="c1"># Enclose multiple commands in {}.</span>
</pre></div>
</div>
<p>You may use for() inside or outside of functions.</p>
</div>
<div class="section" id="example-2-creating-dummy-variables-by-hand">
<h3>Example 2: Creating dummy variables by hand<a class="headerlink" href="#example-2-creating-dummy-variables-by-hand" title="Permalink to this headline">¶</a></h3>
<p>You may also use a loop to create a matrix of dummy variables to append
to a data frame. For example, to generate fixed effects for each state,
let’s say that you have mydata which contains y, x1, x2, x3, and state,
with state a character variable with 50 unique values. There are three
ways to create dummy variables: 1) with a built-in R command; 2) with
one loop; or 3) with 2 for loops.</p>
<ol class="arabic">
<li><p class="first">R will create dummy variables on the fly from a single variable with
distinct values.</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> z.out <span class="o">&lt;-</span> zelig<span class="p">(</span>y <span class="o">~</span> x1 <span class="o">+</span> x2 <span class="o">+</span> x3 <span class="o">+</span> as.factor<span class="p">(</span>state<span class="p">),</span>
                 data <span class="o">=</span> mydata<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;ls&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This method returns <span class="math">\(k - 1\)</span> indicators for <span class="math">\(k\)</span> states.</p>
</li>
<li><p class="first">Alternatively, you can use a loop to create dummy variables by hand.
There are two ways to do this, but both start with the same initial
commands. Using vector commands, first create an index of for the
states, and initialize a matrix to hold the dummy variables:</p>
<div class="highlight-r"><div class="highlight"><pre>idx <span class="o">&lt;-</span> sort<span class="p">(</span>unique<span class="p">(</span>mydata<span class="o">$</span>state<span class="p">))</span>
dummy <span class="o">&lt;-</span> matrix<span class="p">(</span><span class="kc">NA</span><span class="p">,</span> nrow <span class="o">=</span> nrow<span class="p">(</span>mydata<span class="p">),</span> ncol <span class="o">=</span> length<span class="p">(</span>idx<span class="p">))</span>
</pre></div>
</div>
<p>Now choose between the two methods.</p>
<ol class="arabic">
<li><p class="first">The first method is computationally inefficient, but more
intuitive for users not accustomed to vector operations. The first
loop uses i as in index to loop through all the rows, and the
second loop uses j to loop through all 50 values in the vector
idx, which correspond to columns 1 through 50 in the matrix dummy.</p>
<div class="highlight-r"><div class="highlight"><pre><span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span>nrow<span class="p">(</span>mydata<span class="p">))</span> <span class="p">{</span>
  <span class="kr">for</span> <span class="p">(</span>j <span class="kr">in</span> <span class="m">1</span><span class="o">:</span>length<span class="p">(</span>idx<span class="p">))</span> <span class="p">{</span>
    <span class="kr">if</span> <span class="p">(</span>mydata<span class="o">$</span>state<span class="p">[</span>i<span class="p">,</span>j<span class="p">]</span> <span class="o">==</span> idx<span class="p">[</span>j<span class="p">])</span> <span class="p">{</span>
      dummy<span class="p">[</span>i<span class="p">,</span>j<span class="p">]</span> <span class="o">&lt;-</span> <span class="m">1</span>
    <span class="p">}</span>
    <span class="kr">else</span> <span class="p">{</span>
      dummy<span class="p">[</span>i<span class="p">,</span>j<span class="p">]</span> <span class="o">&lt;-</span> <span class="m">0</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Then add the new matrix of dummy variables to your data frame:</p>
<div class="highlight-r"><div class="highlight"><pre>names<span class="p">(</span>dummy<span class="p">)</span> <span class="o">&lt;-</span> idx
mydata <span class="o">&lt;-</span> cbind<span class="p">(</span>mydata<span class="p">,</span> dummy<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">As you become more comfortable with vector operations, you can
replace the double loop procedure above with one loop:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="kr">for</span> <span class="p">(</span>j <span class="kr">in</span> <span class="m">1</span><span class="o">:</span>length<span class="p">(</span>idx<span class="p">))</span> <span class="p">{</span>
  dummy<span class="p">[,</span>j<span class="p">]</span> <span class="o">&lt;-</span> as.integer<span class="p">(</span>mydata<span class="o">$</span>state <span class="o">==</span> idx<span class="p">[</span>j<span class="p">])</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The single loop procedure evaluates each element in idx against
the vector mydata$state. This creates a vector of <span class="math">\(n\)</span>
TRUE/FALSE observations, which you may transform to 1’s and 0’s
using as.integer(). Assign the resulting vector to the appropriate
column in dummy. Combine the dummy matrix with the data frame as
above to complete the procedure.</p>
</li>
</ol>
</li>
</ol>
</div>
<div class="section" id="example-3-weighted-regression-with-subsets">
<h3>Example 3: Weighted regression with subsets<a class="headerlink" href="#example-3-weighted-regression-with-subsets" title="Permalink to this headline">¶</a></h3>
<p>Selecting the by option in zelig() partitions the data frame and then
automatically loops the specified model through each partition. Suppose
that mydata is a data frame with variables y, x1, x2, x3, and state,
with state a factor variable with 50 unique values. Let’s say that you
would like to run a weighted regression where each observation is
weighted by the inverse of the standard error on x1, estimated for that
observation’s state. In other words, we need to first estimate the model
for each of the 50 states, calculate 1 / se(x1<span class="math">\(_j\)</span>) for each
state <span class="math">\(j = 1, \dots, 50\)</span>, and then assign these weights to each
observation in mydata.</p>
<ul>
<li><p class="first">Estimate the model separate for each state using the by option in
zelig():</p>
<div class="highlight-r"><div class="highlight"><pre>z.out <span class="o">&lt;-</span> zelig<span class="p">(</span>y <span class="o">~</span> x1 <span class="o">+</span> x2 <span class="o">+</span> x3<span class="p">,</span> by <span class="o">=</span> <span class="s">&quot;state&quot;</span><span class="p">,</span> data <span class="o">=</span> mydata<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;ls&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now z.out is a list of 50 regression outputs.</p>
</li>
<li><p class="first">Extract the standard error on x1 for each of the state level
regressions.</p>
<div class="highlight-r"><div class="highlight"><pre>se <span class="o">&lt;-</span> array<span class="p">()</span>                          <span class="c1"># Initalize the empty data structure.</span>
<span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="m">50</span><span class="p">)</span> <span class="p">{</span>                      <span class="c1"># vcov() creates the variance matrix</span>
  se<span class="p">[</span>i<span class="p">]</span> <span class="o">&lt;-</span> sqrt<span class="p">(</span>vcov<span class="p">(</span>z.out<span class="p">[[</span>i<span class="p">]])[</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">])</span> <span class="c1"># Since we have an intercept, the 2nd</span>
<span class="p">}</span>                                      <span class="c1"># diagonal value corresponds to x1.</span>
</pre></div>
</div>
</li>
<li><p class="first">Create the vector of weights.</p>
<div class="highlight-r"><div class="highlight"><pre>wts <span class="o">&lt;-</span> <span class="m">1</span> <span class="o">/</span> se
</pre></div>
</div>
<p>This vector wts has 50 values that correspond to the 50 sets of
state-level regression output in z.out.</p>
</li>
<li><p class="first">To assign the vector of weights to each observation, we need to match
each observation’s state designation to the appropriate state. For
simplicity, assume that the states are numbered 1 through 50.</p>
<div class="highlight-r"><div class="highlight"><pre>mydata<span class="o">$</span>w <span class="o">&lt;-</span> <span class="kc">NA</span>            <span class="c1"># Initalizing the empty variable</span>
<span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="m">50</span><span class="p">)</span> <span class="p">{</span>
  mydata<span class="o">$</span>w<span class="p">[</span>mydata<span class="o">$</span>state <span class="o">==</span> i<span class="p">]</span> <span class="o">&lt;-</span> wts<span class="p">[</span>i<span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We use mydata$state as the index (inside the square brackets) to
assign values to mydata$w. Thus, whenever state equals 5 for an
observation, the loop assigns the fifth value in the vector wts to
the variable w in mydata. If we had 500 observations in mydata, we
could use this method to match each of the 500 observations to the
appropriate wts.</p>
<p>If the states are character strings instead of integers, we can use a
slightly more complex version</p>
<div class="highlight-r"><div class="highlight"><pre>mydata<span class="o">$</span>w <span class="o">&lt;-</span> <span class="kc">NA</span>
idx <span class="o">&lt;-</span> sort<span class="p">(</span>unique<span class="p">(</span>mydata<span class="o">$</span>state<span class="p">))</span>
<span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span>length<span class="p">(</span>idx<span class="p">)</span> <span class="p">{</span>
  mydata<span class="o">$</span>w<span class="p">[</span>mydata<span class="o">$</span>state <span class="o">==</span> idx<span class="p">[</span>i<span class="p">]]</span> <span class="o">&lt;-</span> wts<span class="p">[</span>i<span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p class="first">Now we can run our weighted regression:</p>
<div class="highlight-r"><div class="highlight"><pre>z.wtd <span class="o">&lt;-</span> zelig<span class="p">(</span>y <span class="o">~</span> x1 <span class="o">+</span> x2 <span class="o">+</span> x3<span class="p">,</span> weights <span class="o">=</span> w<span class="p">,</span> data <span class="o">=</span> mydata<span class="p">,</span>
               model <span class="o">=</span> <span class="s">&quot;ls&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2014, The Zelig Team.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>