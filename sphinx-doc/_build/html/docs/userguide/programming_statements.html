
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Programming Statements &mdash; Zelig 5.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/my-styles.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-3.1.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-3.1.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '5.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../../_static/zelig-small.ico"/>
    <link rel="top" title="Zelig 5.0 documentation" href="../../index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

<a href="https://github.com/IQSS/Zelig5"><img style="position: absolute; top: 45px; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png" alt="Fork me on GitHub"></a>
<div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">

    <div class="container">

      <div class="navbar-header">

        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>

        <a class="logo"> <img height="32" width="32" src="http://datascience.iq.harvard.edu/files/styles/os_files_small/public/datascience/files/zelig-small_1.png?itok=catC420a" /></a>
        <a class="navbar-brand" href="../../index.html">Zelig</a>
        <span class="navbar-text navbar-version pull-left"><b>5.0</b></span>
      </div>
        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://datascience.iq.harvard.edu">Data Science at IQSS</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#todo">TODO</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide.html">User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../user_guide.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide.html#data-analysis-commands">Data Analysis Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide.html#statistical-commands">Statistical Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide.html#graphing-commands">Graphing Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide.html#r-objects">R Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide.html#programming-statements">Programming Statements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide.html">Developer Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../dev_guide.html#writing-new-models">Writing New Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev_guide.html#adding-models-and-methods-to-zelig">Adding Models and Methods to Zelig</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#for-all-zelig-users">For All Zelig Users</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#for-zelig-contributors">For Zelig Contributors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#v-5-0-jul-2014">v 5.0 (Jul 2014)</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Programming Statements</a><ul>
<li><a class="reference internal" href="#functions">Functions</a></li>
<li><a class="reference internal" href="#if-statements">If-Statements</a></li>
<li><a class="reference internal" href="#for-loops">For-Loops</a><ul>
<li><a class="reference internal" href="#example-1-creating-a-vector-with-a-logical-statement">Example 1: Creating a vector with a logical statement</a></li>
<li><a class="reference internal" href="#example-3-weighted-regression-with-subsets">Example 3: Weighted regression with subsets</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          

        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
</ul>

<div id="sourcelink">
  <a href="../../_sources/docs/userguide/programming_statements.txt"
     rel="nofollow">Source</a>
</div>
<form action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-9">
      
  <div class="section" id="programming-statements">
<h1>Programming Statements<a class="headerlink" href="#programming-statements" title="Permalink to this headline">¶</a></h1>
<p>This chapter introduces the main programming commands. These include
functions, if-else statements, for-loops, and special procedures for
managing the inputs to statistical models.</p>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<p>Functions are either built-in or user-defined sets of encapsulated
commands which may take any number of arguments. Preface a function with
the function statement and use the &lt;- operator to assign functions to
objects in your workspace.</p>
<p>You may use functions to run the same procedure on different objects in
your workspace. For example,</p>
<div class="highlight-r"><div class="highlight"><pre>check <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>p<span class="p">,</span> q<span class="p">)</span> <span class="p">{</span>
 result <span class="o">&lt;-</span> <span class="p">(</span>p <span class="o">-</span> q<span class="p">)</span><span class="o">/</span>q
 result
 <span class="p">}</span>
</pre></div>
</div>
<p>is a simple function with arguments p and q which calculates the
difference between the th elements of the vector p and the
th element of the vector q as a proportion of the
th element of q, and returns the resulting vector. For
example, check(p = 10, q = 2) returns 4. You may omit the descriptors as
long as you keep the arguments in the correct order: check(10, 2) also
returns 4. You may also use other objects as inputs to the function. If
again = 10 and really = 2, then check(p = again, q = really) and
check(again, really) also returns 4.</p>
<p>Because functions run commands as a set, you should make sure that each
command in your function works by testing each line of the function at
the R prompt.</p>
</div>
<div class="section" id="if-statements">
<h2>If-Statements<a class="headerlink" href="#if-statements" title="Permalink to this headline">¶</a></h2>
<p>Use if (and optionally, else) to control the flow of R functions. For
example, let x and y be scalar numerical values:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="kr">if</span> <span class="p">(</span>x <span class="o">==</span> y<span class="p">)</span> <span class="p">{</span>                <span class="c1"># If the logical statement in the ()&#39;s is true,</span>
  x <span class="o">&lt;-</span> <span class="kc">NA</span>                    <span class="c1">#  then `x&#39; is changed to `NA&#39; (missing value).</span>
<span class="p">}</span>
<span class="kr">else</span> <span class="p">{</span>                       <span class="c1"># The `else&#39; statement tells R what to do if</span>
  x <span class="o">&lt;-</span> x<span class="o">^</span><span class="m">2</span>                   <span class="c1">#  the if-statement is false.</span>
<span class="p">}</span>
</pre></div>
</div>
<p>As with a function, use { and } to define the set of commands associated
with each if and else statement. (If you include if statements inside
functions, you may have multiple sets of nested curly braces.)</p>
</div>
<div class="section" id="for-loops">
<h2>For-Loops<a class="headerlink" href="#for-loops" title="Permalink to this headline">¶</a></h2>
<p>Use for to repeat (loop) operations. Avoiding loops by using matrix or
vector commands is usually faster and more elegant, but loops are
sometimes necessary to assign values. If you are using a loop to assign
values to a data structure, you must first initialize an empty data
structure to hold the values you are assigning.</p>
<p>Select a data structure compatible with the type of output your loop
will generate. If your loop generates a scalar, store it in a vector
(with the th value in the vector corresponding to the the
th run of the loop). If your loop generates vector output,
store them as rows (or columns) in a matrix, where the th row
(or column) corresponds to the th iteration of the loop. If
your output consists of matrices, stack them into an array. For list
output (such as regression output) or output that changes dimensions in
each iteration, use a list. To initialize these data structures, use:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> x <span class="o">&lt;-</span> vector<span class="p">()</span>                          <span class="c1"># An empty vector of any length.</span>
<span class="o">&gt;</span> x <span class="o">&lt;-</span> list<span class="p">()</span>                            <span class="c1"># An empty list of any length.</span>
</pre></div>
</div>
<p>The vector() and list() commands create a vector or list of any length,
such that assigning x[5] &lt;- 15 automatically creates a vector with 5
elements, the first four of which are empty values (NA). In contrast,
the matrix() and array() commands create data structures that are
restricted to their original dimensions.</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> x <span class="o">&lt;-</span> matrix<span class="p">(</span>nrow <span class="o">=</span> <span class="m">5</span><span class="p">,</span> ncol <span class="o">=</span> <span class="m">2</span><span class="p">)</span>  <span class="c1"># A matrix with 5 rows and 2 columns.</span>
<span class="o">&gt;</span> x <span class="o">&lt;-</span> array<span class="p">(</span>dim <span class="o">=</span> c<span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">))</span>       <span class="c1"># A 3D array of 3 stacked 5 by 2 matrices.</span>
</pre></div>
</div>
<p>If you attempt to assign a value at  to either of
these data structures, R will return an error message (“subscript is out
of bounds”). R does not automatically extend the dimensions of either a
matrix or an array to accommodate additional values.</p>
<div class="section" id="example-1-creating-a-vector-with-a-logical-statement">
<h3>Example 1: Creating a vector with a logical statement<a class="headerlink" href="#example-1-creating-a-vector-with-a-logical-statement" title="Permalink to this headline">¶</a></h3>
<div class="highlight-r"><div class="highlight"><pre>x <span class="o">&lt;-</span> array<span class="p">()</span>             <span class="c1"># Initializes an empty data structure.</span>
<span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">)</span> <span class="p">{</span>        <span class="c1"># Loops through every value from 1 to 10, replacing</span>
  <span class="kr">if</span> <span class="p">(</span>is.integer<span class="p">(</span>i<span class="o">/</span><span class="m">2</span><span class="p">))</span> <span class="p">{</span> <span class="c1">#  the even values in `x&#39; with i+5.</span>
    x<span class="p">[</span>i<span class="p">]</span> <span class="o">&lt;-</span> i <span class="o">+</span> <span class="m">5</span>
  <span class="p">}</span>
<span class="p">}</span>                        <span class="c1"># Enclose multiple commands in {}.</span>
</pre></div>
</div>
<p>You may use for() inside or outside of functions.</p>
<p>Example 2: Creating dummy variables by hand
!!!</p>
<p>You may also use a loop to create a matrix of dummy variables to append
to a data frame. For example, to generate fixed effects for each state,
let’s say that you have mydata which contains y, x1, x2, x3, and state,
with state a character variable with 50 unique values. There are three
ways to create dummy variables: 1) with a built-in R command; 2) with
one loop; or 3) with 2 for loops.</p>
<ol class="arabic">
<li><p class="first">R will create dummy variables on the fly from a single variable with
distinct values.</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> z.out <span class="o">&lt;-</span> zelig<span class="p">(</span>y <span class="o">~</span> x1 <span class="o">+</span> x2 <span class="o">+</span> x3 <span class="o">+</span> as.factor<span class="p">(</span>state<span class="p">),</span>
                 data <span class="o">=</span> mydata<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;ls&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This method returns  indicators for  states.</p>
</li>
<li><p class="first">Alternatively, you can use a loop to create dummy variables by hand.
There are two ways to do this, but both start with the same initial
commands. Using vector commands, first create an index of for the
states, and initialize a matrix to hold the dummy variables:</p>
<div class="highlight-r"><div class="highlight"><pre>idx <span class="o">&lt;-</span> sort<span class="p">(</span>unique<span class="p">(</span>mydata<span class="o">$</span>state<span class="p">))</span>
dummy <span class="o">&lt;-</span> matrix<span class="p">(</span><span class="kc">NA</span><span class="p">,</span> nrow <span class="o">=</span> nrow<span class="p">(</span>mydata<span class="p">),</span> ncol <span class="o">=</span> length<span class="p">(</span>idx<span class="p">))</span>
</pre></div>
</div>
<p>Now choose between the two methods.</p>
<ol class="arabic">
<li><p class="first">The first method is computationally inefficient, but more
intuitive for users not accustomed to vector operations. The first
loop uses i as in index to loop through all the rows, and the
second loop uses j to loop through all 50 values in the vector
idx, which correspond to columns 1 through 50 in the matrix dummy.</p>
<div class="highlight-r"><div class="highlight"><pre><span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span>nrow<span class="p">(</span>mydata<span class="p">))</span> <span class="p">{</span>
  <span class="kr">for</span> <span class="p">(</span>j <span class="kr">in</span> <span class="m">1</span><span class="o">:</span>length<span class="p">(</span>idx<span class="p">))</span> <span class="p">{</span>
    <span class="kr">if</span> <span class="p">(</span>mydata<span class="o">$</span>state<span class="p">[</span>i<span class="p">,</span>j<span class="p">]</span> <span class="o">==</span> idx<span class="p">[</span>j<span class="p">])</span> <span class="p">{</span>
      dummy<span class="p">[</span>i<span class="p">,</span>j<span class="p">]</span> <span class="o">&lt;-</span> <span class="m">1</span>
    <span class="p">}</span>
    <span class="kr">else</span> <span class="p">{</span>
      dummy<span class="p">[</span>i<span class="p">,</span>j<span class="p">]</span> <span class="o">&lt;-</span> <span class="m">0</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Then add the new matrix of dummy variables to your data frame:</p>
<div class="highlight-r"><div class="highlight"><pre>names<span class="p">(</span>dummy<span class="p">)</span> <span class="o">&lt;-</span> idx
mydata <span class="o">&lt;-</span> cbind<span class="p">(</span>mydata<span class="p">,</span> dummy<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">As you become more comfortable with vector operations, you can
replace the double loop procedure above with one loop:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="kr">for</span> <span class="p">(</span>j <span class="kr">in</span> <span class="m">1</span><span class="o">:</span>length<span class="p">(</span>idx<span class="p">))</span> <span class="p">{</span>
  dummy<span class="p">[,</span>j<span class="p">]</span> <span class="o">&lt;-</span> as.integer<span class="p">(</span>mydata<span class="o">$</span>state <span class="o">==</span> idx<span class="p">[</span>j<span class="p">])</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The single loop procedure evaluates each element in idx against
the vector mydata$state. This creates a vector of 
TRUE/FALSE observations, which you may transform to 1’s and 0’s
using as.integer(). Assign the resulting vector to the appropriate
column in dummy. Combine the dummy matrix with the data frame as
above to complete the procedure.</p>
</li>
</ol>
</li>
</ol>
</div>
<div class="section" id="example-3-weighted-regression-with-subsets">
<h3>Example 3: Weighted regression with subsets<a class="headerlink" href="#example-3-weighted-regression-with-subsets" title="Permalink to this headline">¶</a></h3>
<p>Selecting the by option in zelig() partitions the data frame and then
automatically loops the specified model through each partition. Suppose
that mydata is a data frame with variables y, x1, x2, x3, and state,
with state a factor variable with 50 unique values. Let’s say that you
would like to run a weighted regression where each observation is
weighted by the inverse of the standard error on x1, estimated for that
observation’s state. In other words, we need to first estimate the model
for each of the 50 states, calculate 1 / se(x1) for each
state , and then assign these weights to each
observation in mydata.</p>
<ul>
<li><p class="first">Estimate the model separate for each state using the by option in
zelig():</p>
<div class="highlight-r"><div class="highlight"><pre>z.out <span class="o">&lt;-</span> zelig<span class="p">(</span>y <span class="o">~</span> x1 <span class="o">+</span> x2 <span class="o">+</span> x3<span class="p">,</span> by <span class="o">=</span> <span class="s">&quot;state&quot;</span><span class="p">,</span> data <span class="o">=</span> mydata<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;ls&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now z.out is a list of 50 regression outputs.</p>
</li>
<li><p class="first">Extract the standard error on x1 for each of the state level
regressions.</p>
<div class="highlight-r"><div class="highlight"><pre>se <span class="o">&lt;-</span> array<span class="p">()</span>                          <span class="c1"># Initalize the empty data structure.</span>
<span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="m">50</span><span class="p">)</span> <span class="p">{</span>                      <span class="c1"># vcov() creates the variance matrix</span>
  se<span class="p">[</span>i<span class="p">]</span> <span class="o">&lt;-</span> sqrt<span class="p">(</span>vcov<span class="p">(</span>z.out<span class="p">[[</span>i<span class="p">]])[</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">])</span> <span class="c1"># Since we have an intercept, the 2nd</span>
<span class="p">}</span>                                      <span class="c1"># diagonal value corresponds to x1.</span>
</pre></div>
</div>
</li>
<li><p class="first">Create the vector of weights.</p>
<div class="highlight-r"><div class="highlight"><pre>wts <span class="o">&lt;-</span> <span class="m">1</span> <span class="o">/</span> se
</pre></div>
</div>
<p>This vector wts has 50 values that correspond to the 50 sets of
state-level regression output in z.out.</p>
</li>
<li><p class="first">To assign the vector of weights to each observation, we need to match
each observation’s state designation to the appropriate state. For
simplicity, assume that the states are numbered 1 through 50.</p>
<div class="highlight-r"><div class="highlight"><pre>mydata<span class="o">$</span>w <span class="o">&lt;-</span> <span class="kc">NA</span>            <span class="c1"># Initalizing the empty variable</span>
<span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="m">50</span><span class="p">)</span> <span class="p">{</span>
  mydata<span class="o">$</span>w<span class="p">[</span>mydata<span class="o">$</span>state <span class="o">==</span> i<span class="p">]</span> <span class="o">&lt;-</span> wts<span class="p">[</span>i<span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We use mydata$state as the index (inside the square brackets) to
assign values to mydata$w. Thus, whenever state equals 5 for an
observation, the loop assigns the fifth value in the vector wts to
the variable w in mydata. If we had 500 observations in mydata, we
could use this method to match each of the 500 observations to the
appropriate wts.</p>
<p>If the states are character strings instead of integers, we can use a
slightly more complex version</p>
<div class="highlight-r"><div class="highlight"><pre>mydata<span class="o">$</span>w <span class="o">&lt;-</span> <span class="kc">NA</span>
idx <span class="o">&lt;-</span> sort<span class="p">(</span>unique<span class="p">(</span>mydata<span class="o">$</span>state<span class="p">))</span>
<span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span>length<span class="p">(</span>idx<span class="p">)</span> <span class="p">{</span>
  mydata<span class="o">$</span>w<span class="p">[</span>mydata<span class="o">$</span>state <span class="o">==</span> idx<span class="p">[</span>i<span class="p">]]</span> <span class="o">&lt;-</span> wts<span class="p">[</span>i<span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p class="first">Now we can run our weighted regression:</p>
<div class="highlight-r"><div class="highlight"><pre>z.wtd <span class="o">&lt;-</span> zelig<span class="p">(</span>y <span class="o">~</span> x1 <span class="o">+</span> x2 <span class="o">+</span> x3<span class="p">,</span> weights <span class="o">=</span> w<span class="p">,</span> data <span class="o">=</span> mydata<span class="p">,</span>
               model <span class="o">=</span> <span class="s">&quot;ls&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
</div>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../../_sources/docs/userguide/programming_statements.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2014, The Zelig Team.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.2.<br/>
    </p>
  </div>
</footer>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-27761864-7', 'pydata.org');
  ga('send', 'pageview');

</script>



  </body>
</html>