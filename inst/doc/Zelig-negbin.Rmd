<span>negbin</span>: Negative Binomial Regression for Event Count Dependent Variables {#negbin}
=====================================================================================

Use the negative binomial regression if you have a count of events for
each observation of your dependent variable. The negative binomial model
is frequently used to estimate over-dispersed event count models.

### Syntax

    > z.out <- zelig(Y ~ X1 + X2, model = "negbin", data = mydata)
    > x.out <- setx(z.out)
    > s.out <- sim(z.out, x = x.out)

### Additional Inputs

In addition to the standard inputs, <span>zelig()</span> takes the
following additional options for negative binomial regression:

-   <span>robust</span>: defaults to <span>FALSE</span>. If
    <span>TRUE</span> is selected, <span>zelig()</span> computes robust
    standard errors via the <span>sandwich</span> package (see
    @Zeileis04). The default type of robust standard error is
    heteroskedastic and autocorrelation consistent (HAC), and assumes
    that observations are ordered by time index.

    In addition, <span>robust</span> may be a list with the following
    options:

    -   <span>method</span>: Choose from

        -   <span>“vcovHAC”</span>: (default if <span>robust =
            TRUE</span>) HAC standard errors.

        -   <span>“kernHAC”</span>: HAC standard errors using the
            weights given in @Andrews91.

        -   <span>“weave”</span>: HAC standard errors using the weights
            given in @LumHea99.

    -   <span>order.by</span>: defaults to <span>NULL</span> (the
        observations are chronologically ordered as in the original
        data). Optionally, you may specify a vector of weights (either
        as <span>order.by = z</span>, where <span>z</span> exists
        outside the data frame; or as <span>order.by = \~z</span>, where
        <span>z</span> is a variable in the data frame). The
        observations are chronologically ordered by the size of
        <span>z</span>.

    -   <span>…</span>: additional options passed to the functions
        specified in <span>method</span>. See the <span>sandwich</span>
        library and @Zeileis04 for more options.

### Example

Load sample data:

RRR\> data(sanction)

Estimate the model:

RRR\> z.out \<- zelig(num   target + coop, model = “negbin”, data =
sanction)

RRR\> summary(z.out)

Set values for the explanatory variables to their default mean values:

RRR\> x.out \<- setx(z.out)

Simulate fitted values:

RRR\> s.out \<- sim(z.out, x = x.out)

RRR\> summary(s.out)

RRR\> plot(s.out)

![image](vigpics/negbin-Example1Plot)

### Model

Let $Y_i$ be the number of independent events that occur during a fixed
time period. This variable can take any non-negative integer value.

-   The negative binomial distribution is derived by letting the mean of
    the Poisson distribution vary according to a fixed parameter $\zeta$
    given by the Gamma distribution. The *stochastic component* is given
    by

    $$\begin{aligned}
         Y_i \mid \zeta_i & \sim & \textrm{Poisson}(\zeta_i \mu_i),\\
         \zeta_i & \sim & \frac{1}{\theta}\textrm{Gamma}(\theta).
       \end{aligned}$$

    The marginal distribution of $Y_i$ is then the negative binomial
    with mean $\mu_i$ and variance $\mu_i + \mu_i^2/\theta$:

    $$\begin{aligned}
       Y_i & \sim & \textrm{NegBin}(\mu_i, \theta), \\
           & = & \frac{\Gamma (\theta + y_i)}{y! \, \Gamma(\theta)} 
                 \frac{\mu_i^{y_i} \, \theta^{\theta}}{(\mu_i + \theta)^{\theta + y_i}},
       \end{aligned}$$

    where $\theta$ is the systematic parameter of the Gamma distribution
    modeling $\zeta_i$.

-   The *systematic component* is given by

    $$\mu_i = \exp(x_i \beta)$$

    where $x_i$ is the vector of $k$ explanatory variables and $\beta$
    is the vector of coefficients.

### Quantities of Interest

-   The expected values (<span>qi\$ev</span>) are simulations of the
    mean of the stochastic component. Thus, $$E(Y) = \mu_i = \exp(x_i
      \beta),$$ given simulations of $\beta$.

-   The predicted value (<span>qi\$pr</span>) drawn from the
    distribution defined by the set of parameters $(\mu_i, \theta)$.

-   The first difference (<span>qi\$fd</span>) is

    $$\textrm{FD} \; = \; E(Y | x_1) - E(Y \mid x)$$

-   In conditional prediction models, the average expected treatment
    effect (<span>att.ev</span>) for the treatment group is

    $$\frac{1}{\sum_{i=1}^n t_i}\sum_{i:t_i=1}^n \left\{ Y_i(t_i=1) -
          E[Y_i(t_i=0)] \right\},$$

    where $t_i$ is a binary explanatory variable defining the treatment
    ($t_i=1$) and control ($t_i=0$) groups. Variation in the simulations
    are due to uncertainty in simulating $E[Y_i(t_i=0)]$, the
    counterfactual expected value of $Y_i$ for observations in the
    treatment group, under the assumption that everything stays the same
    except that the treatment indicator is switched to $t_i=0$.

-   In conditional prediction models, the average predicted treatment
    effect (<span>att.pr</span>) for the treatment group is

    $$\frac{1}{\sum_{i=1}^n t_i}\sum_{i:t_i=1}^n \left\{ Y_i(t_i=1) -
          \widehat{Y_i(t_i=0)} \right\},$$

    where $t_i$ is a binary explanatory variable defining the treatment
    ($t_i=1$) and control ($t_i=0$) groups. Variation in the simulations
    are due to uncertainty in simulating $\widehat{Y_i(t_i=0)}$, the
    counterfactual predicted value of $Y_i$ for observations in the
    treatment group, under the assumption that everything stays the same
    except that the treatment indicator is switched to $t_i=0$.

### Output Values

The output of each Zelig command contains useful information which you
may view. For example, if you run
`z.out <- zelig(y ~ x, model = negbin, data)`, then you may examine the
available information in `z.out` by using `names(z.out)`, see the
<span>coefficients</span> by using <span>z.out\$coefficients</span>, and
a default summary of information through `summary(z.out)`. Other
elements available through the <span>\$</span> operator are listed
below.

-   From the <span>zelig()</span> output object <span>z.out</span>, you
    may extract:

    -   <span>coefficients</span>: parameter estimates for the
        explanatory variables.

    -   <span>theta</span>: the maximum likelihood estimate for the
        stochastic parameter $\theta$.

    -   <span>SE.theta</span>: the standard error for
        <span>theta</span>.

    -   <span>residuals</span>: the working residuals in the final
        iteration of the IWLS fit.

    -   <span>fitted.values</span>: a vector of the fitted values for
        the systemic component $\lambda$.

    -   <span>linear.predictors</span>: a vector of $x_{i} \beta$.

    -   <span>aic</span>: Akaike’s Information Criterion (minus twice
        the maximized log-likelihood plus twice the number of
        coefficients).

    -   <span>df.residual</span>: the residual degrees of freedom.

    -   <span>df.null</span>: the residual degrees of freedom for the
        null model.

    -   <span>zelig.data</span>: the input data frame if <span>save.data
        = TRUE</span>.

-   From <span>summary(z.out)</span>, you may extract:

    -   <span>coefficients</span>: the parameter estimates with their
        associated standard errors, $p$-values, and $t$-statistics.

    -   <span>cov.scaled</span>: a $k \times k$ matrix of scaled
        covariances.

    -   <span>cov.unscaled</span>: a $k \times k$ matrix of unscaled
        covariances.

-   From the <span>sim()</span> output object <span>s.out</span>, you
    may extract quantities of interest arranged as matrices indexed by
    simulation $\times$ <span>x</span>-observation (for more than one
    <span>x</span>-observation). Available quantities are:

    -   <span>qi\$ev</span>: the simulated expected values given the
        specified values of <span>x</span>.

    -   <span>qi\$pr</span>: the simulated predicted values drawn from
        the distribution defined by $(\mu_i, \theta)$.

    -   <span>qi\$fd</span>: the simulated first differences in the
        simulated expected values given the specified values of
        <span>x</span> and <span>x1</span>.

    -   <span>qi\$att.ev</span>: the simulated average expected
        treatment effect for the treated from conditional prediction
        models.

    -   <span>qi\$att.pr</span>: the simulated average predicted
        treatment effect for the treated from conditional prediction
        models.

How to Cite {#how-to-cite .unnumbered}
-----------

See also {#see-also .unnumbered}
--------

The negative binomial model is part of the MASS package by William N.
Venable and Brian D. Ripley [@VenRip02]. Advanced users may wish to
refer to `help(glm.nb)` as well as @McCNel89. Robust standard errors are
implemented via sandwich package by Achim Zeileis [@Zeileis04].Sample
data are from @Martin92.
