<span>lognorm</span>: Log-Normal Regression for Duration Dependent Variables {#lognorm}
============================================================================

The log-normal model describes an event’s duration, the dependent
variable, as a function of a set of explanatory variables. The
log-normal model may take time censored dependent variables, and allows
the hazard rate to increase and decrease.

### Syntax

    > z.out <- zelig(Surv(Y, C) ~ X, model = "lognorm", data = mydata)
    > x.out <- setx(z.out)
    > s.out <- sim(z.out, x = x.out)

Log-normal models require that the dependent variable be in the form
<span>Surv(Y, C)</span>, where <span>Y</span> and <span>C</span> are
vectors of length $n$. For each observation $i$ in 1, …, $n$, the value
$y_i$ is the duration (lifetime, for example) of each subject, and the
associated $c_i$ is a binary variable such that $c_i = 1$ if the
duration is not censored (<span>*e.g.*</span>, the subject dies during
the study) or $c_i = 0$ if the duration is censored
(<span>*e.g.*</span>, the subject is still alive at the end of the
study). If $c_i$ is omitted, all Y are assumed to be completed; that is,
time defaults to 1 for all observations.

### Input Values

In addition to the standard inputs, <span>zelig()</span> takes the
following additional options for lognormal regression:

-   <span>robust</span>: defaults to <span>FALSE</span>. If
    <span>TRUE</span>, <span>zelig()</span> computes robust standard
    errors based on sandwich estimators (see @Huber81 and @White80)
    based on the options in <span>cluster</span>.

-   <span>cluster</span>: if <span>robust = TRUE</span>, you may select
    a variable to define groups of correlated observations. Let
    <span>x3</span> be a variable that consists of either discrete
    numeric values, character strings, or factors that define strata.
    Then

        > z.out <- zelig(y ~ x1 + x2, robust = TRUE, cluster = "x3", 
                         model = "exp", data = mydata)

    means that the observations can be correlated within the strata
    defined by the variable <span>x3</span>, and that robust standard
    errors should be calculated according to those clusters. If
    <span>robust = TRUE</span> but <span>cluster</span> is not
    specified, <span>zelig()</span> assumes that each observation falls
    into its own cluster.

### Example

Attach the sample data:

RRR\> data(coalition)

Estimate the model:

RRR\> z.out \<- zelig(Surv(duration, ciep12)   fract + numst2, model =
“lognorm”, + data = coalition)

View the regression output:

RRR\> summary(z.out)

Set the baseline values (with the ruling coalition in the minority) and
the alternative values (with the ruling coalition in the majority) for
X:

RRR\> x.low \<- setx(z.out, numst2 = 0) RRR\> x.high \<- setx(z.out,
numst2 = 1)

Simulate expected values (<span>qi\$ev</span>) and first differences
(<span>qi\$fd</span>):

RRR\> s.out \<- sim(z.out, x = x.low, x1 = x.high)

RRR\> summary(s.out)

RRR\> plot(s.out)

![image](vigpics/lognormal-ExamplePlot)

### Model

Let $Y_i^*$ be the survival time for observation $i$ with the density
function $f(y)$ and the corresponding distribution function
$F(t)=\int_{0}^t f(y) dy$. This variable might be censored for some
observations at a fixed time $y_c$ such that the fully observed
dependent variable, $Y_i$, is defined as

$$Y_i = \left\{ \begin{array}{ll}
      Y_i^* & \textrm{if }Y_i^* \leq y_c \\
      y_c & \textrm{if }Y_i^* > y_c \\
    \end{array} \right.$$

-   The *stochastic component* is described by the distribution of the
    partially observed variable, $Y^*$. For the lognormal model, there
    are two equivalent representations:

    $$\begin{aligned}
        Y_i^* \; \sim \; \textrm{LogNormal}(\mu_i, \sigma^2) & \textrm{ or
    } & \log(Y_i^*) \; \sim \; \textrm{Normal}(\mu_i, \sigma^2)\end{aligned}$$

    where the parameters $\mu_i$ and $\sigma^2$ are the mean and
    variance of the Normal distribution. (Note that the output from
    <span>zelig()</span> parameterizes <span>scale</span>$ = \sigma$.)

    In addition, survival models like the lognormal have three
    additional properties. The hazard function $h(t)$ measures the
    probability of not surviving past time $t$ given survival up to $t$.
    In general, the hazard function is equal to $f(t)/S(t)$ where the
    survival function $S(t) =
      1 - \int_{0}^t f(s) ds$ represents the fraction still surviving at
    time $t$. The cumulative hazard function $H(t)$ describes the
    probability of dying before time $t$. In general, $H(t)=
    \int_{0}^{t} h(s) ds = -\log S(t)$. In the case of the lognormal
    model,

    $$\begin{aligned}
    h(t) &=& \frac{1}{\sqrt{2 \pi} \, \sigma t \, S(t)}
    \exp\left\{-\frac{1}{2 \sigma^2} (\log \lambda t)^2\right\} \\
    S(t) &=& 1 - \Phi\left(\frac{1}{\sigma} \log \lambda t\right) \\
    H(t) &=& -\log \left\{ 1 - \Phi\left(\frac{1}{\sigma} \log \lambda t\right) \right\}\end{aligned}$$

    where $\Phi(\cdot)$ is the cumulative density function for the
    Normal distribution.

-   The *systematic component* is described as:

    $$\mu_i = x_i \beta .$$

### Quantities of Interest

-   The expected values (<span>qi\$ev</span>) for the lognormal model
    are simulations of the expected duration:

    $$E(Y) =  \exp\left(\mu_i + \frac{1}{2}\sigma^2 \right),$$

    given draws of $\beta$ and $\sigma$ from their sampling
    distributions.

-   The predicted value is a draw from the log-normal distribution given
    simulations of the parameters $(\lambda_i, \sigma)$.

-   The first difference (<span>qi\$fd</span>) is

    $$\textrm{FD} = E(Y \mid x_1) - E(Y \mid x).$$

-   In conditional prediction models, the average expected treatment
    effect (<span>att.ev</span>) for the treatment group is

    $$\frac{1}{\sum_{i=1}^n t_i}\sum_{i:t_i=1}^n \{ Y_i(t_i=1) - E[Y_i(t_i=0)] \},$$

    where $t_i$ is a binary explanatory variable defining the treatment
    ($t_i=1$) and control ($t_i=0$) groups. When $Y_i(t_i=1)$ is
    censored rather than observed, we replace it with a simulation from
    the model given available knowledge of the censoring process.
    Variation in the simulations is due to two factors: uncertainty in
    the imputation process for censored $y_i^*$ and uncertainty in
    simulating $E[Y_i(t_i=0)]$, the counterfactual expected value of
    $Y_i$ for observations in the treatment group, under the assumption
    that everything stays the same except that the treatment indicator
    is switched to $t_i=0$.

-   In conditional prediction models, the average predicted treatment
    effect (<span>att.pr</span>) for the treatment group is

    $$\frac{1}{\sum_{i=1}^n t_i} \sum_{i:t_i=1}^n \{  Y_i(t_i=1) -
    \widehat{Y_i(t_i=0)} \},$$

    where $t_i$ is a binary explanatory variable defining the treatment
    ($t_i=1$) and control ($t_i=0$) groups. When $Y_i(t_i=1)$ is
    censored rather than observed, we replace it with a simulation from
    the model given available knowledge of the censoring process.
    Variation in the simulations are due to two factors: uncertainty in
    the imputation process for censored $y_i^*$ and uncertainty in
    simulating $\widehat{Y_i(t_i=0)}$, the counterfactual predicted
    value of $Y_i$ for observations in the treatment group, under the
    assumption that everything stays the same except that the treatment
    indicator is switched to $t_i=0$.

### Output Values

The output of each Zelig command contains useful information which you
may view. For example, if you run
`z.out <- zelig(Surv(Y, C) ~ X, model = lognorm, data)`, then you may
examine the available information in `z.out` by using `names(z.out)`,
see the <span>coefficients</span> by using
<span>z.out\$coefficients</span>, and a default summary of information
through `summary(z.out)`. Other elements available through the
<span>\$</span> operator are listed below.

-   From the <span>zelig()</span> output object <span>z.out</span>, you
    may extract:

    -   <span>coefficients</span>: parameter estimates for the
        explanatory variables.

    -   <span>icoef</span>: parameter estimates for the intercept and
        $\sigma$.

    -   <span>var</span>: Variance-covariance matrix.

    -   <span>loglik</span>: Vector containing the log-likelihood for
        the model and intercept only (respectively).

    -   <span>linear.predictors</span>: the vector of $x_{i}\beta$.

    -   <span>df.residual</span>: the residual degrees of freedom.

    -   <span>df.null</span>: the residual degrees of freedom for the
        null model.

    -   <span>zelig.data</span>: the input data frame if <span>save.data
        = TRUE</span>.

-   Most of this may be conveniently summarized using
    <span>summary(z.out)</span>. From <span>summary(z.out)</span>, you
    may additionally extract:

    -   <span>table</span>: the parameter estimates with their
        associated standard errors, $p$-values, and $t$-statistics.

-   From the <span>sim()</span> output object <span>s.out</span>, you
    may extract quantities of interest arranged as matrices indexed by
    simulation $\times$ <span>x</span>-observation (for more than one
    <span>x</span>-observation). Available quantities are:

    -   <span>qi\$ev</span>: the simulated expected values for the
        specified values of <span>x</span>.

    -   <span>qi\$pr</span>: the simulated predicted values drawn from
        the distribution defined by $(\lambda_i, \sigma)$.

    -   <span>qi\$fd</span>: the simulated first differences between the
        simulated expected values for <span>x</span> and
        <span>x1</span>.

    -   <span>qi\$att.ev</span>: the simulated average expected
        treatment effect for the treated from conditional prediction
        models.

    -   <span>qi\$att.pr</span>: the simulated average predicted
        treatment effect for the treated from conditional prediction
        models.

How to Cite {#how-to-cite .unnumbered}
-----------

See also {#see-also .unnumbered}
--------

The exponential function is part of the survival library by by Terry
Therneau, ported to R by Thomas Lumley. Advanced users may wish to refer
to `help(survfit)` in the survival library, and @VenRip02.Sample data
are from @KinAltBur90.
