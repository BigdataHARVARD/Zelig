
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Model Reference and Vignettes &mdash; Zelig 5.0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="static/my-styles.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.1.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.1.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '5.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="top" title="Zelig 5.0.1 documentation" href="index.html" />
    <link rel="next" title="Frequently Asked Questions" href="faq.html" />
    <link rel="prev" title="Installation and Quickstart" href="installation_quickstart.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

<a href="https://github.com/IQSS/Zelig"><img style="position: absolute; top: 45px; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png"" alt="Fork me on GitHub"></a>
<div id="navbar" class="navbar-inverse navbar-default navbar-fixed-top">

    <div class="container">

      <div class="navbar-header">

        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>

        <!-- <a class="logo"> <img height="32" width="32" src="http://datascience.iq.harvard.edu/files/styles/os_files_small/public/datascience/files/zelig-small_1.png?itok=catC420a" /></a> -->
        <a class="navbar-brand" href="index.html">Zelig</a>
        <span class="navbar-text navbar-version pull-left"><b>Version 5.0.1</b></span>
      </div>
        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://datascience.iq.harvard.edu/zelig">Data Science at IQSS</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation_quickstart.html">Installation and Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation_quickstart.html#installing-r-and-zelig">Installing R and Zelig</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation_quickstart.html#quickstart-guide">Quickstart Guide</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Model Reference and Vignettes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#reference">Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="#zelig-exp">zelig-exp</a></li>
<li class="toctree-l2"><a class="reference internal" href="#zelig-gamma">zelig-gamma</a></li>
<li class="toctree-l2"><a class="reference internal" href="#zelig-logit">zelig-logit</a></li>
<li class="toctree-l2"><a class="reference internal" href="#zelig-lognorm">zelig-lognorm</a></li>
<li class="toctree-l2"><a class="reference internal" href="#zelig-ls">zelig-ls</a></li>
<li class="toctree-l2"><a class="reference internal" href="#zelig-negbin">zelig-negbin</a></li>
<li class="toctree-l2"><a class="reference internal" href="#zelig-normal">zelig-normal</a></li>
<li class="toctree-l2"><a class="reference internal" href="#zelig-poisson">zelig-poisson</a></li>
<li class="toctree-l2"><a class="reference internal" href="#zelig-probit">zelig-probit</a></li>
<li class="toctree-l2"><a class="reference internal" href="#zelig-relogit">zelig-relogit</a></li>
<li class="toctree-l2"><a class="reference internal" href="#zelig-tobit">zelig-tobit</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="faq.html#why-cant-i-install-zelig">Why can’t I install Zelig?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#why-cant-i-install-r">Why can’t I install R?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#why-cant-i-load-data">Why can’t I load data?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#r-is-neat-how-can-i-find-out-more">R is neat. How can I find out more?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="about.html">About Zelig</a><ul>
<li class="toctree-l2"><a class="reference internal" href="about.html#technical-vision">Technical Vision</a></li>
<li class="toctree-l2"><a class="reference internal" href="about.html#release-notes">Release Notes</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Model Reference and Vignettes</a><ul>
<li><a class="reference internal" href="#reference">Reference</a></li>
<li><a class="reference internal" href="#zelig-exp">zelig-exp</a><ul>
<li><a class="reference internal" href="#syntax">Syntax</a></li>
<li><a class="reference internal" href="#input-values">Input Values</a></li>
<li><a class="reference internal" href="#example">Example</a></li>
<li><a class="reference internal" href="#model">Model</a></li>
<li><a class="reference internal" href="#quantities-of-interest">Quantities of Interest</a></li>
<li><a class="reference internal" href="#output-values">Output Values</a></li>
<li><a class="reference internal" href="#see-also">See also</a></li>
</ul>
</li>
<li><a class="reference internal" href="#zelig-gamma">zelig-gamma</a><ul>
<li><a class="reference internal" href="#id1">Syntax</a></li>
<li><a class="reference internal" href="#id2">Example</a></li>
<li><a class="reference internal" href="#id3">Model</a></li>
<li><a class="reference internal" href="#id4">Quantities of Interest</a></li>
<li><a class="reference internal" href="#id5">Output Values</a></li>
<li><a class="reference internal" href="#id6">See also</a></li>
</ul>
</li>
<li><a class="reference internal" href="#zelig-logit">zelig-logit</a><ul>
<li><a class="reference internal" href="#id7">Syntax</a></li>
<li><a class="reference internal" href="#examples">Examples</a><ul>
<li><a class="reference internal" href="#basic-example">Basic Example</a></li>
<li><a class="reference internal" href="#simulating-first-differences">Simulating First Differences</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id8">Model</a></li>
<li><a class="reference internal" href="#id9">Quantities of Interest</a></li>
<li><a class="reference internal" href="#id10">Output Values</a></li>
<li><a class="reference internal" href="#id11">See also</a></li>
</ul>
</li>
<li><a class="reference internal" href="#zelig-lognorm">zelig-lognorm</a><ul>
<li><a class="reference internal" href="#id12">Syntax</a></li>
<li><a class="reference internal" href="#id13">Input Values</a></li>
<li><a class="reference internal" href="#id14">Example</a></li>
<li><a class="reference internal" href="#id15">Model</a></li>
<li><a class="reference internal" href="#id16">Quantities of Interest</a></li>
<li><a class="reference internal" href="#id17">Output Values</a></li>
<li><a class="reference internal" href="#id18">See also</a></li>
</ul>
</li>
<li><a class="reference internal" href="#zelig-ls">zelig-ls</a><ul>
<li><a class="reference internal" href="#id19">Syntax</a></li>
<li><a class="reference internal" href="#id20">Examples</a><ul>
<li><a class="reference internal" href="#basic-example-with-first-differences">Basic Example with First Differences</a></li>
<li><a class="reference internal" href="#using-dummy-variables">Using Dummy Variables</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id21">Model</a></li>
<li><a class="reference internal" href="#id22">Quantities of Interest</a></li>
<li><a class="reference internal" href="#id23">Output Values</a></li>
<li><a class="reference internal" href="#id24">See also</a></li>
</ul>
</li>
<li><a class="reference internal" href="#zelig-negbin">zelig-negbin</a><ul>
<li><a class="reference internal" href="#id25">Syntax</a></li>
<li><a class="reference internal" href="#id26">Example</a></li>
<li><a class="reference internal" href="#id27">Model</a></li>
<li><a class="reference internal" href="#id28">Quantities of Interest</a></li>
<li><a class="reference internal" href="#id29">Output Values</a></li>
<li><a class="reference internal" href="#id30">See also</a></li>
</ul>
</li>
<li><a class="reference internal" href="#zelig-normal">zelig-normal</a><ul>
<li><a class="reference internal" href="#id33">Syntax</a></li>
<li><a class="reference internal" href="#id34">Examples</a><ul>
<li><a class="reference internal" href="#id35">Basic Example with First Differences</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id36">Model</a></li>
<li><a class="reference internal" href="#id37">Quantities of Interest</a></li>
<li><a class="reference internal" href="#id38">Output Values</a></li>
<li><a class="reference internal" href="#id39">See also</a></li>
</ul>
</li>
<li><a class="reference internal" href="#zelig-poisson">zelig-poisson</a><ul>
<li><a class="reference internal" href="#id40">Syntax</a></li>
<li><a class="reference internal" href="#id41">Example</a></li>
<li><a class="reference internal" href="#id42">Model</a></li>
<li><a class="reference internal" href="#id43">Quantities of Interest</a></li>
<li><a class="reference internal" href="#id44">Output Values</a></li>
<li><a class="reference internal" href="#id45">See also</a></li>
</ul>
</li>
<li><a class="reference internal" href="#zelig-probit">zelig-probit</a><ul>
<li><a class="reference internal" href="#id46">Syntax</a></li>
<li><a class="reference internal" href="#id47">Example</a></li>
<li><a class="reference internal" href="#id48">Model</a></li>
<li><a class="reference internal" href="#id49">Quantities of Interest</a></li>
<li><a class="reference internal" href="#id50">Output Values</a></li>
<li><a class="reference internal" href="#id51">See also</a></li>
</ul>
</li>
<li><a class="reference internal" href="#zelig-relogit">zelig-relogit</a><ul>
<li><a class="reference internal" href="#id52">Syntax</a></li>
<li><a class="reference internal" href="#arguments">Arguments</a></li>
<li><a class="reference internal" href="#example-1-one-tau-with-prior-correction-and-bias-correction">Example 1: One Tau with Prior Correction and Bias Correction</a></li>
<li><a class="reference internal" href="#example-2-one-tau-with-weighting-robust-standard-errors-and-bias-correction">Example 2: One Tau with Weighting, Robust Standard Errors, and Bias Correction</a></li>
<li><a class="reference internal" href="#example-3-two-taus-with-bias-correction-and-prior-correction">Example 3: Two Taus with Bias Correction and Prior Correction</a></li>
<li><a class="reference internal" href="#id53">Model</a></li>
<li><a class="reference internal" href="#id54">Quantities of Interest</a></li>
<li><a class="reference internal" href="#id55">Output Values</a></li>
<li><a class="reference internal" href="#differences-with-stata-version">Differences with Stata Version</a></li>
<li><a class="reference internal" href="#id56">See also</a></li>
</ul>
</li>
<li><a class="reference internal" href="#zelig-tobit">zelig-tobit</a><ul>
<li><a class="reference internal" href="#id57">Syntax</a></li>
<li><a class="reference internal" href="#inputs">Inputs</a></li>
<li><a class="reference internal" href="#id58">Examples</a><ul>
<li><a class="reference internal" href="#id59">Basic Example</a></li>
<li><a class="reference internal" href="#id60">Simulating First Differences</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id61">Model</a></li>
<li><a class="reference internal" href="#id62">Quantities of Interest</a></li>
<li><a class="reference internal" href="#id63">Output Values</a></li>
<li><a class="reference internal" href="#id66">See also</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="installation_quickstart.html" title="Previous Chapter: Installation and Quickstart"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; Installation and...</span>
    </a>
  </li>
  <li>
    <a href="faq.html" title="Next Chapter: Frequently Asked Questions"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">Frequently Asked... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          

        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation_quickstart.html">Installation and Quickstart</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Model Reference and Vignettes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#reference">Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="#zelig-exp">zelig-exp</a></li>
<li class="toctree-l2"><a class="reference internal" href="#zelig-gamma">zelig-gamma</a></li>
<li class="toctree-l2"><a class="reference internal" href="#zelig-logit">zelig-logit</a></li>
<li class="toctree-l2"><a class="reference internal" href="#zelig-lognorm">zelig-lognorm</a></li>
<li class="toctree-l2"><a class="reference internal" href="#zelig-ls">zelig-ls</a></li>
<li class="toctree-l2"><a class="reference internal" href="#zelig-negbin">zelig-negbin</a></li>
<li class="toctree-l2"><a class="reference internal" href="#zelig-normal">zelig-normal</a></li>
<li class="toctree-l2"><a class="reference internal" href="#zelig-poisson">zelig-poisson</a></li>
<li class="toctree-l2"><a class="reference internal" href="#zelig-probit">zelig-probit</a></li>
<li class="toctree-l2"><a class="reference internal" href="#zelig-relogit">zelig-relogit</a></li>
<li class="toctree-l2"><a class="reference internal" href="#zelig-tobit">zelig-tobit</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html">About Zelig</a></li>
</ul>

<form action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-9">
      
  <div class="section" id="model-reference-and-vignettes">
<span id="vignettes"></span><h1>Model Reference and Vignettes<a class="headerlink" href="#model-reference-and-vignettes" title="Permalink to this headline">¶</a></h1>
<p>This section includes technical information on the models currently implemented in Zelig (5.0.1). This includes a reference with a list of supported models as well as individual model vignettes with detailed information on the model, quantities of interest and syntax.</p>
<hr class="docutils" />
<div class="section" id="reference">
<h2>Reference<a class="headerlink" href="#reference" title="Permalink to this headline">¶</a></h2>
<p>The following models are currently supported in Zelig 5.0.1:</p>
<ul class="simple">
<li><a class="reference external" href="http://zeligproject.org/vignette.html#zelig-exp">Exponential Regression</a>: <tt class="docutils literal"><span class="pre">zexp$new()</span></tt></li>
<li><a class="reference external" href="http://zeligproject.org/vignette.html#zelig-gamma">Gamma Regression</a>: <tt class="docutils literal"><span class="pre">zgamma()</span></tt></li>
<li><a class="reference external" href="http://zeligproject.org/vignette.html#zelig-logit">Logistic Regression</a>: <tt class="docutils literal"><span class="pre">zlogit$new()</span></tt></li>
<li><a class="reference external" href="http://zeligproject.org/vignette.html#zelig-lognorm">Log Normal Regression</a>: <tt class="docutils literal"><span class="pre">zlognorm$new()</span></tt></li>
<li><a class="reference external" href="http://zeligproject.org/vignette.html#zelig-ls">Least Squares Regression</a>: <tt class="docutils literal"><span class="pre">zls$new()</span></tt></li>
<li><a class="reference external" href="http://zeligproject.org/vignette.html#zelig-exp">Negative Binomial Regression</a>: <tt class="docutils literal"><span class="pre">zbinom$new()</span></tt></li>
<li><a class="reference external" href="http://zeligproject.org/vignette.html#zelig-normal">Normal Regression</a>: <tt class="docutils literal"><span class="pre">znormal$new()</span></tt></li>
<li><a class="reference external" href="http://zeligproject.org/vignette.html#zelig-poisson">Poisson Regression</a>: <tt class="docutils literal"><span class="pre">zpoisson$new()</span></tt></li>
<li><a class="reference external" href="http://zeligproject.org/vignette.html#zelig-probit">Probit Regression</a>: <tt class="docutils literal"><span class="pre">zprobit$new()</span></tt></li>
<li><a class="reference external" href="http://zeligproject.org/vignette.html#zelig-relogit">Rare Events Logistic Regression</a>: <tt class="docutils literal"><span class="pre">zrelogit$new()</span></tt></li>
<li><a class="reference external" href="http://zeligproject.org/vignette.html#zelig-tobit">Tobit Regression</a>: <tt class="docutils literal"><span class="pre">ztobit$new()</span></tt></li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="zelig-exp">
<h2>zelig-exp<a class="headerlink" href="#zelig-exp" title="Permalink to this headline">¶</a></h2>
<p>Exponential Regression for Duration Dependent Variables</p>
<p>Use the exponential duration regression model if you have a dependent
variable representing a duration (time until an event). The model
assumes a constant hazard rate for all events. The dependent variable
may be censored (for observations have not yet been completed when data
were collected).</p>
<div class="section" id="syntax">
<h3>Syntax<a class="headerlink" href="#syntax" title="Permalink to this headline">¶</a></h3>
<p>With reference classes:</p>
<div class="highlight-r"><div class="highlight"><pre>z5 <span class="o">&lt;-</span> zexp<span class="o">$</span>new<span class="p">()</span>
z5<span class="o">$</span>zelig<span class="p">(</span>Surv<span class="p">(</span>Y<span class="p">,</span> C<span class="p">)</span> <span class="o">~</span> X<span class="p">,</span> data <span class="o">=</span> mydata<span class="p">)</span>
z5<span class="o">$</span>setx<span class="p">()</span>
z5<span class="o">$</span>sim<span class="p">()</span>
</pre></div>
</div>
<p>With the Zelig 4 compatibility wrappers:</p>
<div class="highlight-r"><div class="highlight"><pre>z.out <span class="o">&lt;-</span> zelig<span class="p">(</span>Surv<span class="p">(</span>Y<span class="p">,</span> C<span class="p">)</span> <span class="o">~</span> X<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;exp&quot;</span><span class="p">,</span> data <span class="o">=</span> mydata<span class="p">)</span>
x.out <span class="o">&lt;-</span> setx<span class="p">(</span>z.out<span class="p">)</span>
s.out <span class="o">&lt;-</span> sim<span class="p">(</span>z.out<span class="p">,</span> x <span class="o">=</span> x.out<span class="p">)</span>
</pre></div>
</div>
<p>Exponential models require that the dependent variable be in the form
Surv(Y, C), where Y and C are vectors of length <img class="math" src="_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/>. For each
observation <img class="math" src="_images/math/a581f053bbfa5115f42c13094857cdd12a37ec49.png" alt="i"/> in 1, …, <img class="math" src="_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/>, the value <img class="math" src="_images/math/410a65f64e2a609a2a7f544ed72f0982b719807a.png" alt="y_i"/> is the
duration (lifetime, for example), and the associated <img class="math" src="_images/math/496867ca68c428fa123f26f0f73997632e61e116.png" alt="c_i"/> is a
binary variable such that <img class="math" src="_images/math/45bd383d229a85e1c894b645ee5ce5cfad178bdf.png" alt="c_i = 1"/> if the duration is not
censored (<em>e.g.</em>, the subject dies during the study) or <img class="math" src="_images/math/839e310a40128c2d71f158db2ee1ff3a1a40b81b.png" alt="c_i = 0"/>
if the duration is censored (<em>e.g.</em>, the subject is still alive at the
end of the study and is know to live at least as long as <img class="math" src="_images/math/410a65f64e2a609a2a7f544ed72f0982b719807a.png" alt="y_i"/>).
If <img class="math" src="_images/math/496867ca68c428fa123f26f0f73997632e61e116.png" alt="c_i"/> is omitted, all Y are assumed to be completed; that is,
time defaults to 1 for all observations.</p>
</div>
<div class="section" id="input-values">
<h3>Input Values<a class="headerlink" href="#input-values" title="Permalink to this headline">¶</a></h3>
<p>In addition to the standard inputs, zelig() takes the following
additional options for exponential regression:</p>
<ul class="simple">
<li>robust: defaults to FALSE. If TRUE, zelig() computes robust standard
errors based on sandwich estimators (see and ) and the options
selected in cluster.</li>
<li>cluster: if robust = TRUE, you may select a variable to define groups
of correlated observations. Let x3 be a variable that consists of
either discrete numeric values, character strings, or factors that
define strata. Then</li>
</ul>
<div class="highlight-r"><div class="highlight"><pre>z.out <span class="o">&lt;-</span> zelig<span class="p">(</span>y <span class="o">~</span> x1 <span class="o">+</span> x2<span class="p">,</span> robust <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> cluster <span class="o">=</span> <span class="s">&quot;x3&quot;</span><span class="p">,</span>
                        model <span class="o">=</span> <span class="s">&quot;exp&quot;</span><span class="p">,</span> data <span class="o">=</span> mydata<span class="p">)</span>
</pre></div>
</div>
<p>means that the observations can be correlated within the strata
defined by the variable x3, and that robust standard errors should be
calculated according to those clusters. If robust = TRUE but cluster
is not specified, zelig() assumes that each observation falls into
its own cluster.</p>
</div>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>Attach the sample data:</p>
<div class="highlight-r"><div class="highlight"><pre>data<span class="p">(</span>coalition<span class="p">)</span>
</pre></div>
</div>
<p>Estimate the model:</p>
<div class="highlight-r"><div class="highlight"><pre>z.out <span class="o">&lt;-</span> zelig<span class="p">(</span>Surv<span class="p">(</span>duration<span class="p">,</span> ciep12<span class="p">)</span> <span class="o">~</span> fract <span class="o">+</span> numst2<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;exp&quot;</span><span class="p">,</span> data <span class="o">=</span> coalition<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## How to cite this model in Zelig:</span>
<span class="c">##   Olivia Lau, Kosuke Imai, Gary King. 2011.</span>
<span class="c">##   exp: Exponential Regression for Duration Dependent Variables</span>
<span class="c">##   in Kosuke Imai, Gary King, and Olivia Lau, &quot;Zelig: Everyone&#39;s Statistical Software,&quot;</span>
<span class="c">##   http://datascience.iq.harvard.edu/zelig</span>
</pre></div>
</div>
<p>View the regression output:</p>
<div class="highlight-r"><div class="highlight"><pre>summary<span class="p">(</span>z.out<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## Model: 1Call:</span>
<span class="c">## survival::survreg(formula = Surv(duration, ciep12) ~ fract +</span>
<span class="c">##     numst2, data = ., dist = &quot;exponential&quot;, model = FALSE)</span>
<span class="c">##</span>
<span class="c">## Coefficients:</span>
<span class="c">## (Intercept)       fract      numst2</span>
<span class="c">##    5.535873   -0.003909    0.461179</span>
<span class="c">##</span>
<span class="c">## Scale fixed at 1</span>
<span class="c">##</span>
<span class="c">## Loglik(model)= -1077   Loglik(intercept only)= -1101</span>
<span class="c">##  Chisq= 46.66 on 2 degrees of freedom, p= 7.4e-11</span>
<span class="c">## n= 314</span>
<span class="c">## Next step: Use &#39;setx&#39; method</span>
</pre></div>
</div>
<p>Set the baseline values (with the ruling coalition in the minority) and
the alternative values (with the ruling coalition in the majority) for
X:</p>
<div class="highlight-r"><div class="highlight"><pre>x.low <span class="o">&lt;-</span> setx<span class="p">(</span>z.out<span class="p">,</span> numst2 <span class="o">=</span> <span class="m">0</span><span class="p">)</span>
x.high <span class="o">&lt;-</span> setx<span class="p">(</span>z.out<span class="p">,</span> numst2 <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Simulate expected values and first differences:</p>
<div class="highlight-r"><div class="highlight"><pre>s.out <span class="o">&lt;-</span> sim<span class="p">(</span>z.out<span class="p">,</span> x <span class="o">=</span> x.low<span class="p">,</span> x1 <span class="o">=</span> x.high<span class="p">)</span>
</pre></div>
</div>
<p>Summarize quantities of interest and produce some plots:</p>
<div class="highlight-r"><div class="highlight"><pre>summary<span class="p">(</span>s.out<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">##</span>
<span class="c">##  sim x :</span>
<span class="c">##  -----</span>
<span class="c">## ev</span>
<span class="c">##    mean    sd   50%  2.5% 97.5%</span>
<span class="c">## 1 15.43 1.508 15.39 12.64 18.55</span>
<span class="c">## pv</span>
<span class="c">##       mean    sd   50%   2.5% 97.5%</span>
<span class="c">## [1,] 15.16 15.48 10.85 0.2435 56.52</span>
<span class="c">##</span>
<span class="c">##  sim x1 :</span>
<span class="c">##  -----</span>
<span class="c">## ev</span>
<span class="c">##    mean    sd   50%  2.5% 97.5%</span>
<span class="c">## 1 24.29 1.968 24.28 20.55 28.26</span>
<span class="c">## pv</span>
<span class="c">##       mean   sd   50%   2.5% 97.5%</span>
<span class="c">## [1,] 24.18 23.3 18.04 0.7319 85.85</span>
<span class="c">## fd</span>
<span class="c">##    mean    sd   50%  2.5% 97.5%</span>
<span class="c">## 1 8.859 2.494 8.807 4.269 13.91</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>plot<span class="p">(</span>s.out<span class="p">)</span>
</pre></div>
</div>
<div class="figure">
<img alt="Zelig-exp" src="_images/Zelig-exp.png" />
<p class="caption">Zelig-exp</p>
</div>
</div>
<div class="section" id="model">
<h3>Model<a class="headerlink" href="#model" title="Permalink to this headline">¶</a></h3>
<p>Let <img class="math" src="_images/math/d618fcc344538f93b4596930823c957af4a11865.png" alt="Y_i^*"/> be the survival time for observation <img class="math" src="_images/math/a581f053bbfa5115f42c13094857cdd12a37ec49.png" alt="i"/>. This
variable might be censored for some observations at a fixed time
<img class="math" src="_images/math/86ef86313546967dcb442753dcc6f50484dc244b.png" alt="y_c"/> such that the fully observed dependent variable,
<img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/>, is defined as</p>
<div class="math">
<p><img src="_images/math/080eb82277537c413153c5a513d4df9309471caf.png" alt="Y_i = \left\{ \begin{array}{ll}
      Y_i^* &amp; \textrm{if }Y_i^* \leq y_c \\
      y_c &amp; \textrm{if }Y_i^* &gt; y_c \\
    \end{array} \right."/></p>
</div><ul>
<li><p class="first">The <em>stochastic component</em> is described by the distribution of the
partially observed variable <img class="math" src="_images/math/e4b82f5d0d0b135c68864771e045dc913778a223.png" alt="Y^*"/>. We assume <img class="math" src="_images/math/d618fcc344538f93b4596930823c957af4a11865.png" alt="Y_i^*"/>
follows the exponential distribution whose density function is given
by</p>
<div class="math">
<p><img src="_images/math/67e1264b7f56ebc4a97823f66b518116f44c057a.png" alt="f(y_i^*\mid \lambda_i) = \frac{1}{\lambda_i} \exp\left(-\frac{y_i^*}{\lambda_i}\right)"/></p>
</div><p>for <img class="math" src="_images/math/aee03fa2ac369970345e3f13ba80325460b429e3.png" alt="y_i^*\ge 0"/> and <img class="math" src="_images/math/7d72a5d0f43da45d3d7a997a9971becc5f8832c8.png" alt="\lambda_i&gt;0"/>. The mean of this
distribution is <img class="math" src="_images/math/3b765ea6939f1eba2541e91f870cb3c078aa29be.png" alt="\lambda_i"/>.</p>
<p>In addition, survival models like the exponential have three
additional properties. The hazard function <img class="math" src="_images/math/8f59c002cacf4a159c9d1b7ccfa141d30d5dc65c.png" alt="h(t)"/> measures the
probability of not surviving past time <img class="math" src="_images/math/ef9270877405055756d345facd044e4ab297f858.png" alt="t"/> given survival up to
<img class="math" src="_images/math/ef9270877405055756d345facd044e4ab297f858.png" alt="t"/>. In general, the hazard function is equal to
<img class="math" src="_images/math/89ae40bbb08f26a2d7a02d4d5af4526f1a20c029.png" alt="f(t)/S(t)"/> where the survival function
<img class="math" src="_images/math/cc2e13874b1a2ecf7f79657e6c3a29960829dcc3.png" alt="S(t) = 1 - \int_{0}^t f(s) ds"/> represents the fraction still
surviving at time <img class="math" src="_images/math/ef9270877405055756d345facd044e4ab297f858.png" alt="t"/>. The cumulative hazard function
<img class="math" src="_images/math/30319a828ec4029a092aefb503bd693e5776e59b.png" alt="H(t)"/> describes the probability of dying before time
<img class="math" src="_images/math/ef9270877405055756d345facd044e4ab297f858.png" alt="t"/>. In general,
<img class="math" src="_images/math/17b2212e68f15f537abbafa6fa716bb8369f7372.png" alt="H(t)= \int_{0}^{t} h(s) ds = -\log S(t)"/>. In the case of the
exponential model,</p>
<div class="math">
<p><img src="_images/math/01d104152a44c6ad669dfd89c7f40028ab4a15e8.png" alt="\begin{aligned}
h(t) &amp;=&amp; \frac{1}{\lambda_i} \\
S(t) &amp;=&amp; \exp\left( -\frac{t}{\lambda_i} \right) \\
H(t) &amp;=&amp; \frac{t}{\lambda_i}\end{aligned}"/></p>
</div><p>For the exponential model, the hazard function <img class="math" src="_images/math/8f59c002cacf4a159c9d1b7ccfa141d30d5dc65c.png" alt="h(t)"/> is
constant over time. The Weibull model and lognormal models allow the
hazard function to vary as a function of elapsed time (see and
respectively).</p>
</li>
<li><p class="first">The <em>systematic component</em> <img class="math" src="_images/math/3b765ea6939f1eba2541e91f870cb3c078aa29be.png" alt="\lambda_i"/> is modeled as</p>
<div class="math">
<p><img src="_images/math/2ef3e09dc6e0d4710d1d8455992bbb32d072fbb7.png" alt="\lambda_i = \exp(x_i \beta),"/></p>
</div><p>where <img class="math" src="_images/math/33dfc32d00ebd5c5791c824010a155d9e5630b6f.png" alt="x_i"/> is the vector of explanatory variables, and
<img class="math" src="_images/math/8ce03f78ed945f2ef3dac87c8799b55b393527e7.png" alt="\beta"/> is the vector of coefficients.</p>
</li>
</ul>
</div>
<div class="section" id="quantities-of-interest">
<h3>Quantities of Interest<a class="headerlink" href="#quantities-of-interest" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">The expected values (qi$ev) for the exponential model are simulations
of the expected duration given <img class="math" src="_images/math/33dfc32d00ebd5c5791c824010a155d9e5630b6f.png" alt="x_i"/> and draws of <img class="math" src="_images/math/8ce03f78ed945f2ef3dac87c8799b55b393527e7.png" alt="\beta"/>
from its posterior,</p>
<div class="math">
<p><img src="_images/math/ad77ed06fe3262275ae476c64b6707e4aee6e543.png" alt="E(Y) = \lambda_i = \exp(x_i \beta)."/></p>
</div></li>
<li><p class="first">The predicted values (qi$pr) are draws from the exponential
distribution with rate equal to the expected value.</p>
</li>
<li><p class="first">The first difference (or difference in expected values, qi$ev.diff),
is</p>
<div class="math">
<p><img src="_images/math/7631b945385f93d17fe8b3a5bf6e15c8143b2b49.png" alt="\textrm{FD} \; = \; E(Y \mid x_1) - E(Y \mid x),"/></p>
</div><p>where <img class="math" src="_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/> and <img class="math" src="_images/math/b31b1ea8e4fe3f618dedfb0e2d8c69a3df7a391d.png" alt="x_1"/> are different vectors of values for
the explanatory variables.</p>
</li>
<li><p class="first">In conditional prediction models, the average expected treatment
effect (att.ev) for the treatment group is</p>
<div class="math">
<p><img src="_images/math/c086d795134e74f3fe435647603c4583f4d1dac3.png" alt="\frac{1}{\sum_{i=1}^n t_i}\sum_{i:t_i=1}^n \left\{ Y_i(t_i=1) - E[Y_i(t_i=0)]
  \right\},"/></p>
</div><p>where <img class="math" src="_images/math/64283d3d8caf93093b91aba9a61dbe26b5c18562.png" alt="t_i"/> is a binary explanatory variable defining the
treatment (<img class="math" src="_images/math/cc6ccc003db65691c9d0aebb91b2001e0d752d18.png" alt="t_i=1"/>) and control (<img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>) groups. When
<img class="math" src="_images/math/3574cfcb10f1bd84fea967193a6ae17c6855de01.png" alt="Y_i(t_i=1)"/> is censored rather than observed, we replace it
with a simulation from the model given available knowledge of the
censoring process. Variation in the simulations is due to two
factors: uncertainty in the imputation process for censored
<img class="math" src="_images/math/9c2fbff8ba260029bc65603e6a06944c5746ad65.png" alt="y_i^*"/> and uncertainty in simulating <img class="math" src="_images/math/f658a3cf4cf830cd65eab505c530fb4796fea0ed.png" alt="E[Y_i(t_i=0)]"/>,
the counterfactual expected value of <img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> for observations in
the treatment group, under the assumption that everything stays the
same except that the treatment indicator is switched to
<img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>.</p>
</li>
<li><p class="first">In conditional prediction models, the average predicted treatment
effect (att.pr) for the treatment group is</p>
<div class="math">
<p><img src="_images/math/df8a385ab7b219b2fed30372b1381df5163a900e.png" alt="\frac{1}{\sum_{i=1}^n t_i}\sum_{i:t_i=1}^n \left\{ Y_i(t_i=1) -
  \widehat{Y_i(t_i=0)} \right\},"/></p>
</div><p>where <img class="math" src="_images/math/64283d3d8caf93093b91aba9a61dbe26b5c18562.png" alt="t_i"/> is a binary explanatory variable defining the
treatment (<img class="math" src="_images/math/cc6ccc003db65691c9d0aebb91b2001e0d752d18.png" alt="t_i=1"/>) and control (<img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>) groups. When
<img class="math" src="_images/math/3574cfcb10f1bd84fea967193a6ae17c6855de01.png" alt="Y_i(t_i=1)"/> is censored rather than observed, we replace it
with a simulation from the model given available knowledge of the
censoring process. Variation in the simulations is due to two
factors: uncertainty in the imputation process for censored
<img class="math" src="_images/math/9c2fbff8ba260029bc65603e6a06944c5746ad65.png" alt="y_i^*"/> and uncertainty in simulating
<img class="math" src="_images/math/8056bf28681ea8573bf29bfeb3c72dffa40a2fa7.png" alt="\widehat{Y_i(t_i=0)}"/>, the counterfactual predicted value of
<img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> for observations in the treatment group, under the
assumption that everything stays the same except that the treatment
indicator is switched to <img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>.</p>
</li>
</ul>
</div>
<div class="section" id="output-values">
<h3>Output Values<a class="headerlink" href="#output-values" title="Permalink to this headline">¶</a></h3>
<p>The output of each Zelig command contains useful information which you
may view. For example, if you run
<tt class="docutils literal"><span class="pre">z.out</span> <span class="pre">&lt;-</span> <span class="pre">zelig(Surv(Y,</span> <span class="pre">C)</span> <span class="pre">~</span> <span class="pre">X,</span> <span class="pre">model</span> <span class="pre">=</span> <span class="pre">exp,</span> <span class="pre">data)</span></tt>, then you may
examine the available information in <tt class="docutils literal"><span class="pre">z.out</span></tt> by using
<tt class="docutils literal"><span class="pre">names(z.out)</span></tt>, see the coefficients by using z.out$coefficients, and
a default summary of information through <tt class="docutils literal"><span class="pre">summary(z.out)</span></tt>.</p>
</div>
<div class="section" id="see-also">
<h3>See also<a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h3>
<p>The exponential function is part of the survival library by Terry
Therneau, ported to R by Thomas Lumley. Advanced users may wish to refer
to <tt class="docutils literal"><span class="pre">help(survfit)</span></tt> in the survival library.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="zelig-gamma">
<h2>zelig-gamma<a class="headerlink" href="#zelig-gamma" title="Permalink to this headline">¶</a></h2>
<p>Gamma Regression for Continuous, Positive Dependent Variables</p>
<p>Use the gamma regression model if you have a positive-valued dependent
variable such as the number of years a parliamentary cabinet endures, or
the seconds you can stay airborne while jumping. The gamma distribution
assumes that all waiting times are complete by the end of the study
(censoring is not allowed).</p>
<div class="section" id="id1">
<h3>Syntax<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>With reference classes:</p>
<div class="highlight-r"><div class="highlight"><pre>z5 <span class="o">&lt;-</span> zgamma<span class="o">$</span>new<span class="p">()</span>
z5<span class="o">$</span>zelig<span class="p">(</span>Y <span class="o">~</span> X1 <span class="o">+</span> X <span class="o">~</span> X<span class="p">,</span> data <span class="o">=</span> mydata<span class="p">)</span>
z5<span class="o">$</span>setx<span class="p">()</span>
z5<span class="o">$</span>sim<span class="p">()</span>
</pre></div>
</div>
<p>With the Zelig 4 compatibility wrappers:</p>
<div class="highlight-r"><div class="highlight"><pre>z.out <span class="o">&lt;-</span> zelig<span class="p">(</span>Y <span class="o">~</span> X1 <span class="o">+</span> X2<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;gamma&quot;</span><span class="p">,</span> data <span class="o">=</span> mydata<span class="p">)</span>
x.out <span class="o">&lt;-</span> setx<span class="p">(</span>z.out<span class="p">)</span>
s.out <span class="o">&lt;-</span> sim<span class="p">(</span>z.out<span class="p">,</span> x <span class="o">=</span> x.out<span class="p">,</span> x1 <span class="o">=</span> <span class="kc">NULL</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h3>Example<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Attach the sample data:</p>
<div class="highlight-r"><div class="highlight"><pre>data<span class="p">(</span>coalition<span class="p">)</span>
</pre></div>
</div>
<p>Estimate the model:</p>
<div class="highlight-r"><div class="highlight"><pre>z.out <span class="o">&lt;-</span> zelig<span class="p">(</span>duration <span class="o">~</span> fract <span class="o">+</span> numst2<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;gamma&quot;</span><span class="p">,</span> data <span class="o">=</span> coalition<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## How to cite this model in Zelig:</span>
<span class="c">##   Kosuke Imai, Gary King, Olivia Lau. 2007.</span>
<span class="c">##   gamma: Gamma Regression for Continuous, Positive Dependent Variables</span>
<span class="c">##   in Kosuke Imai, Gary King, and Olivia Lau, &quot;Zelig: Everyone&#39;s Statistical Software,&quot;</span>
<span class="c">##   http://datascience.iq.harvard.edu/zelig</span>
</pre></div>
</div>
<p>View the regression output:</p>
<div class="highlight-r"><div class="highlight"><pre>summary<span class="p">(</span>z.out<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## Model: 1</span>
<span class="c">## Call:  stats::glm(formula = duration ~ fract + numst2, family = Gamma(&quot;inverse&quot;),</span>
<span class="c">##     data = .)</span>
<span class="c">##</span>
<span class="c">## Coefficients:</span>
<span class="c">## (Intercept)        fract       numst2</span>
<span class="c">##   -0.012960     0.000115    -0.017387</span>
<span class="c">##</span>
<span class="c">## Degrees of Freedom: 313 Total (i.e. Null);  311 Residual</span>
<span class="c">## Null Deviance:       301</span>
<span class="c">## Residual Deviance: 272   AIC: 2430</span>
<span class="c">## Next step: Use &#39;setx&#39; method</span>
</pre></div>
</div>
<p>Set the baseline values (with the ruling coalition in the minority) and
the alternative values (with the ruling coalition in the majority) for
X:</p>
<div class="highlight-r"><div class="highlight"><pre>x.low <span class="o">&lt;-</span> setx<span class="p">(</span>z.out<span class="p">,</span> numst2 <span class="o">=</span> <span class="m">0</span><span class="p">)</span>
x.high <span class="o">&lt;-</span> setx<span class="p">(</span>z.out<span class="p">,</span> numst2 <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Simulate expected values (qi$ev) and first differences (qi$fd):</p>
<div class="highlight-r"><div class="highlight"><pre>s.out <span class="o">&lt;-</span> sim<span class="p">(</span>z.out<span class="p">,</span> x <span class="o">=</span> x.low<span class="p">,</span> x1 <span class="o">=</span> x.high<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>summary<span class="p">(</span>s.out<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">##</span>
<span class="c">##  sim x :</span>
<span class="c">##  -----</span>
<span class="c">## ev</span>
<span class="c">##       mean    sd   50%  2.5% 97.5%</span>
<span class="c">## [1,] 14.45 1.098 14.34 12.57 16.86</span>
<span class="c">## pv</span>
<span class="c">##       mean    sd   50%   2.5% 97.5%</span>
<span class="c">## [1,] 14.25 13.35 10.08 0.5954 51.44</span>
<span class="c">##</span>
<span class="c">##  sim x1 :</span>
<span class="c">##  -----</span>
<span class="c">## ev</span>
<span class="c">##       mean    sd  50%  2.5% 97.5%</span>
<span class="c">## [1,] 19.26 1.123 19.2 17.24 21.58</span>
<span class="c">## pv</span>
<span class="c">##       mean    sd   50%   2.5% 97.5%</span>
<span class="c">## [1,] 18.55 16.97 13.94 0.8285 65.77</span>
<span class="c">## fd</span>
<span class="c">##       mean    sd   50%  2.5% 97.5%</span>
<span class="c">## [1,] 4.812 1.567 4.847 1.676 7.674</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>plot<span class="p">(</span>s.out<span class="p">)</span>
</pre></div>
</div>
<div class="figure">
<img alt="Zelig-gamma" src="_images/Zelig-gamma.png" />
<p class="caption">Zelig-gamma</p>
</div>
</div>
<div class="section" id="id3">
<h3>Model<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">The Gamma distribution with scale parameter <img class="math" src="_images/math/ad59b6e24a4a00ac621801f8d7513d68be654ab5.png" alt="\alpha"/> has a
<em>stochastic component</em>:</p>
<div class="math">
<p><img src="_images/math/05d44853b67b61aea8416dec47c4bb271c39feee.png" alt="\begin{aligned}
Y &amp;\sim&amp; \textrm{Gamma}(y_i \mid \lambda_i, \alpha) \\
f(y)  &amp;=&amp; \frac{1}{\alpha^{\lambda_i} \, \Gamma \lambda_i} \, y_i^{\lambda_i
  - 1} \exp -\left\{ \frac{y_i}{\alpha} \right\}\end{aligned}"/></p>
</div><div class="line-block">
<div class="line">for <img class="math" src="_images/math/d4a2907c3d8ac12950c8e344f35236de63f31929.png" alt="\alpha, \lambda_i, y_i &gt; 0"/>.</div>
</div>
</li>
<li><p class="first">The <em>systematic component</em> is given by</p>
<div class="math">
<p><img src="_images/math/d89022e0c4ea97317e8099dc27fd004602d759b8.png" alt="\lambda_i = \frac{1}{x_i \beta}"/></p>
</div></li>
</ul>
</div>
<div class="section" id="id4">
<h3>Quantities of Interest<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">The expected values (qi$ev) are simulations of the mean of the
stochastic component given draws of <img class="math" src="_images/math/ad59b6e24a4a00ac621801f8d7513d68be654ab5.png" alt="\alpha"/> and <img class="math" src="_images/math/8ce03f78ed945f2ef3dac87c8799b55b393527e7.png" alt="\beta"/>
from their posteriors:</p>
<div class="math">
<p><img src="_images/math/c59d39819f033b5ae240c27b97121ccceb2b3a82.png" alt="E(Y) = \alpha \lambda_i."/></p>
</div></li>
<li><p class="first">The predicted values (qi$pr) are draws from the gamma distribution
for each given set of parameters <img class="math" src="_images/math/d625e4d40861475147286b5a40866be5ac03ff8c.png" alt="(\alpha, \lambda_i)"/>.</p>
</li>
<li><p class="first">If x1 is specified, sim() also returns the differences in the
expected values (qi$fd),</p>
<div class="math">
<p><img src="_images/math/15f1a5b5e19ffd4d3b304de7da740b451173e4f9.png" alt="E(Y \mid x_1) -
  E(Y \mid x)"/></p>
</div><p>.</p>
</li>
<li><p class="first">In conditional prediction models, the average expected treatment
effect (att.ev) for the treatment group is</p>
<div class="math">
<p><img src="_images/math/f120915a77efb3200aab141647a59f51df9b4611.png" alt="\frac{1}{\sum_{i=1}^n t_i}\sum_{i:t_i=1}^n \left\{ Y_i(t_i=1) -
      E[Y_i(t_i=0)] \right\},"/></p>
</div><p>where <img class="math" src="_images/math/64283d3d8caf93093b91aba9a61dbe26b5c18562.png" alt="t_i"/> is a binary explanatory variable defining the
treatment (<img class="math" src="_images/math/cc6ccc003db65691c9d0aebb91b2001e0d752d18.png" alt="t_i=1"/>) and control (<img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>) groups.
Variation in the simulations are due to uncertainty in simulating
<img class="math" src="_images/math/f658a3cf4cf830cd65eab505c530fb4796fea0ed.png" alt="E[Y_i(t_i=0)]"/>, the counterfactual expected value of
<img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> for observations in the treatment group, under the
assumption that everything stays the same except that the treatment
indicator is switched to <img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>.</p>
</li>
<li><p class="first">In conditional prediction models, the average predicted treatment
effect (att.pr) for the treatment group is</p>
<div class="math">
<p><img src="_images/math/da7e72f6d651b92ad0874d3b40cd633ac38f5663.png" alt="\frac{1}{\sum_{i=1}^n t_i}\sum_{i:t_i=1}^n \left\{ Y_i(t_i=1) -
      \widehat{Y_i(t_i=0)} \right\},"/></p>
</div><p>where <img class="math" src="_images/math/64283d3d8caf93093b91aba9a61dbe26b5c18562.png" alt="t_i"/> is a binary explanatory variable defining the
treatment (<img class="math" src="_images/math/cc6ccc003db65691c9d0aebb91b2001e0d752d18.png" alt="t_i=1"/>) and control (<img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>) groups.
Variation in the simulations are due to uncertainty in simulating
<img class="math" src="_images/math/8056bf28681ea8573bf29bfeb3c72dffa40a2fa7.png" alt="\widehat{Y_i(t_i=0)}"/>, the counterfactual predicted value of
<img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> for observations in the treatment group, under the
assumption that everything stays the same except that the treatment
indicator is switched to <img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>.</p>
</li>
</ul>
</div>
<div class="section" id="id5">
<h3>Output Values<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>The output of each Zelig command contains useful information which you
may view. For example, if you run
<tt class="docutils literal"><span class="pre">z.out</span> <span class="pre">&lt;-</span> <span class="pre">zelig(y</span> <span class="pre">~</span> <span class="pre">x,</span> <span class="pre">model</span> <span class="pre">=</span> <span class="pre">gamma,</span> <span class="pre">data)</span></tt>, then you may examine the
available information in <tt class="docutils literal"><span class="pre">z.out</span></tt> by using <tt class="docutils literal"><span class="pre">names(z.out)</span></tt>, see the
coefficients by using z.out$coefficients, and a default summary of
information through <tt class="docutils literal"><span class="pre">summary(z.out)</span></tt>.</p>
</div>
<div class="section" id="id6">
<h3>See also<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>The gamma model is part of the stats package. Advanced users may
wish to refer to <tt class="docutils literal"><span class="pre">help(glm)</span></tt> and <tt class="docutils literal"><span class="pre">help(family)</span></tt>.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="zelig-logit">
<h2>zelig-logit<a class="headerlink" href="#zelig-logit" title="Permalink to this headline">¶</a></h2>
<p>Logistic Regression for Dichotomous Dependent Variables</p>
<p>Logistic regression specifies a dichotomous dependent variable as a
function of a set of explanatory variables.</p>
<div class="section" id="id7">
<h3>Syntax<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>With reference classes:</p>
<div class="highlight-r"><div class="highlight"><pre>z5 <span class="o">&lt;-</span> zlogit<span class="o">$</span>new<span class="p">()</span>
z5<span class="o">$</span>zelig<span class="p">(</span>Y <span class="o">~</span> X1 <span class="o">+</span> X <span class="o">~</span> X<span class="p">,</span> data <span class="o">=</span> mydata<span class="p">)</span>
z5<span class="o">$</span>setx<span class="p">()</span>
z5<span class="o">$</span>sim<span class="p">()</span>
</pre></div>
</div>
<p>With the Zelig 4 compatibility wrappers:</p>
<div class="highlight-r"><div class="highlight"><pre>z.out <span class="o">&lt;-</span> zelig<span class="p">(</span>Y <span class="o">~</span> X1 <span class="o">+</span> X2<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;logit&quot;</span><span class="p">,</span> data <span class="o">=</span> mydata<span class="p">)</span>
x.out <span class="o">&lt;-</span> setx<span class="p">(</span>z.out<span class="p">)</span>
s.out <span class="o">&lt;-</span> sim<span class="p">(</span>z.out<span class="p">,</span> x <span class="o">=</span> x.out<span class="p">,</span> x1 <span class="o">=</span> <span class="kc">NULL</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<div class="section" id="basic-example">
<h4>Basic Example<a class="headerlink" href="#basic-example" title="Permalink to this headline">¶</a></h4>
<p>Attaching the sample turnout dataset:</p>
<div class="highlight-r"><div class="highlight"><pre>data<span class="p">(</span>turnout<span class="p">)</span>
</pre></div>
</div>
<p>Estimating parameter values for the logistic regression:</p>
<div class="highlight-r"><div class="highlight"><pre>z.out1 <span class="o">&lt;-</span> zelig<span class="p">(</span>vote <span class="o">~</span> age <span class="o">+</span> race<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;logit&quot;</span><span class="p">,</span> data <span class="o">=</span> turnout<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## How to cite this model in Zelig:</span>
<span class="c">##   Kosuke Imai, Gary King, Olivia Lau. 2007.</span>
<span class="c">##   logit: Logistic Regression for Dichotomous Dependent Variables</span>
<span class="c">##   in Kosuke Imai, Gary King, and Olivia Lau, &quot;Zelig: Everyone&#39;s Statistical Software,&quot;</span>
<span class="c">##   http://datascience.iq.harvard.edu/zelig</span>
</pre></div>
</div>
<p>Setting values for the explanatory variables:</p>
<div class="highlight-r"><div class="highlight"><pre>x.out1 <span class="o">&lt;-</span> setx<span class="p">(</span>z.out1<span class="p">,</span> age <span class="o">=</span> <span class="m">36</span><span class="p">,</span> race <span class="o">=</span> <span class="s">&quot;white&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Simulating quantities of interest from the posterior distribution.</p>
<div class="highlight-r"><div class="highlight"><pre>s.out1 <span class="o">&lt;-</span> sim<span class="p">(</span>z.out1<span class="p">,</span> x <span class="o">=</span> x.out1<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>summary<span class="p">(</span>s.out1<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">##</span>
<span class="c">##  sim x :</span>
<span class="c">##  -----</span>
<span class="c">## ev</span>
<span class="c">##        mean      sd   50%   2.5%  97.5%</span>
<span class="c">## [1,] 0.7482 0.01172 0.748 0.7247 0.7701</span>
<span class="c">## pv</span>
<span class="c">##          0     1</span>
<span class="c">## [1,] 0.253 0.747</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>plot<span class="p">(</span>s.out1<span class="p">)</span>
</pre></div>
</div>
<div class="figure">
<img alt="Zelig-logit-1" src="_images/Zelig-logit-1.png" />
<p class="caption">Zelig-logit-1</p>
</div>
</div>
<div class="section" id="simulating-first-differences">
<h4>Simulating First Differences<a class="headerlink" href="#simulating-first-differences" title="Permalink to this headline">¶</a></h4>
<p>Estimating the risk difference (and risk ratio) between low education
(25th percentile) and high education (75th percentile) while all the
other variables held at their default values.</p>
<div class="highlight-r"><div class="highlight"><pre>z.out2 <span class="o">&lt;-</span> zelig<span class="p">(</span>vote <span class="o">~</span> race <span class="o">+</span> educate<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;logit&quot;</span><span class="p">,</span> data <span class="o">=</span> turnout<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## How to cite this model in Zelig:</span>
<span class="c">##   Kosuke Imai, Gary King, Olivia Lau. 2007.</span>
<span class="c">##   logit: Logistic Regression for Dichotomous Dependent Variables</span>
<span class="c">##   in Kosuke Imai, Gary King, and Olivia Lau, &quot;Zelig: Everyone&#39;s Statistical Software,&quot;</span>
<span class="c">##   http://datascience.iq.harvard.edu/zelig</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>x.high <span class="o">&lt;-</span> setx<span class="p">(</span>z.out2<span class="p">,</span> educate <span class="o">=</span> quantile<span class="p">(</span>turnout<span class="o">$</span>educate<span class="p">,</span> prob <span class="o">=</span> <span class="m">0.75</span><span class="p">))</span>
x.low <span class="o">&lt;-</span> setx<span class="p">(</span>z.out2<span class="p">,</span> educate <span class="o">=</span> quantile<span class="p">(</span>turnout<span class="o">$</span>educate<span class="p">,</span> prob <span class="o">=</span> <span class="m">0.25</span><span class="p">))</span>
s.out2 <span class="o">&lt;-</span> sim<span class="p">(</span>z.out2<span class="p">,</span> x <span class="o">=</span> x.high<span class="p">,</span> x1 <span class="o">=</span> x.low<span class="p">)</span>
summary<span class="p">(</span>s.out2<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">##</span>
<span class="c">##  sim x :</span>
<span class="c">##  -----</span>
<span class="c">## ev</span>
<span class="c">##        mean      sd    50%   2.5%  97.5%</span>
<span class="c">## [1,] 0.8231 0.01035 0.8234 0.8025 0.8421</span>
<span class="c">## pv</span>
<span class="c">##          0     1</span>
<span class="c">## [1,] 0.203 0.797</span>
<span class="c">##</span>
<span class="c">##  sim x1 :</span>
<span class="c">##  -----</span>
<span class="c">## ev</span>
<span class="c">##        mean      sd    50%   2.5%  97.5%</span>
<span class="c">## [1,] 0.7095 0.01308 0.7098 0.6834 0.7355</span>
<span class="c">## pv</span>
<span class="c">##          0     1</span>
<span class="c">## [1,] 0.265 0.735</span>
<span class="c">## fd</span>
<span class="c">##         mean      sd     50%    2.5%    97.5%</span>
<span class="c">## [1,] -0.1136 0.01189 -0.1131 -0.1373 -0.09121</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>plot<span class="p">(</span>s.out2<span class="p">)</span>
</pre></div>
</div>
<div class="figure">
<img alt="Zelig-logit-2" src="_images/Zelig-logit-2.png" />
<p class="caption">Zelig-logit-2</p>
</div>
</div>
</div>
<div class="section" id="id8">
<h3>Model<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>Let <img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> be the binary dependent variable for observation
<img class="math" src="_images/math/a581f053bbfa5115f42c13094857cdd12a37ec49.png" alt="i"/> which takes the value of either 0 or 1.</p>
<ul>
<li><p class="first">The <em>stochastic component</em> is given by</p>
<div class="math">
<p><img src="_images/math/beb30650790678aa2d5315baf665f9effc8ac3ad.png" alt="\begin{aligned}
Y_i &amp;\sim&amp; \textrm{Bernoulli}(y_i \mid \pi_i) \\
    &amp;=&amp; \pi_i^{y_i} (1-\pi_i)^{1-y_i}\end{aligned}"/></p>
</div><p>where <img class="math" src="_images/math/204ad227887156eca0ea3882997e3c5d0703174b.png" alt="\pi_i=\Pr(Y_i=1)"/>.</p>
</li>
<li><p class="first">The <em>systematic component</em> is given by:</p>
<div class="math">
<p><img src="_images/math/59cf11e927045c99a310cdaa15d32bc7cfacb160.png" alt="\pi_i \; = \; \frac{1}{1 + \exp(-x_i \beta)}."/></p>
</div><p>where <img class="math" src="_images/math/33dfc32d00ebd5c5791c824010a155d9e5630b6f.png" alt="x_i"/> is the vector of <img class="math" src="_images/math/e9203da50e1059455123460d4e716c9c7f440cc3.png" alt="k"/> explanatory variables
for observation <img class="math" src="_images/math/a581f053bbfa5115f42c13094857cdd12a37ec49.png" alt="i"/> and <img class="math" src="_images/math/8ce03f78ed945f2ef3dac87c8799b55b393527e7.png" alt="\beta"/> is the vector of
coefficients.</p>
</li>
</ul>
</div>
<div class="section" id="id9">
<h3>Quantities of Interest<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">The expected values (qi$ev) for the logit model are simulations of
the predicted probability of a success:</p>
<div class="math">
<p><img src="_images/math/bd411b566ef1222a52b2c10e6eca8f7f994040d4.png" alt="E(Y) =
  \pi_i= \frac{1}{1 + \exp(-x_i \beta)},"/></p>
</div><p>given draws of <img class="math" src="_images/math/8ce03f78ed945f2ef3dac87c8799b55b393527e7.png" alt="\beta"/> from its sampling distribution.</p>
</li>
<li><p class="first">The predicted values (qi$pr) are draws from the Binomial distribution
with mean equal to the simulated expected value <img class="math" src="_images/math/916754f7e7de4247fa27c52f610948b4055311fe.png" alt="\pi_i"/>.</p>
</li>
<li><p class="first">The first difference (qi$fd) for the logit model is defined as</p>
<div class="math">
<p><img src="_images/math/8f669920018c72d7f23a4ba843925381c4703f17.png" alt="\textrm{FD} = \Pr(Y = 1 \mid x_1) - \Pr(Y = 1 \mid x)."/></p>
</div></li>
<li><p class="first">The risk ratio (qi$rr) is defined as</p>
<div class="math">
<p><img src="_images/math/8540cd3e413420e1eceaa11af2b8fc70ef717f37.png" alt="\textrm{RR} = \Pr(Y = 1 \mid x_1) \ / \ \Pr(Y = 1 \mid x)."/></p>
</div></li>
<li><p class="first">In conditional prediction models, the average expected treatment
effect (att.ev) for the treatment group is</p>
<div class="math">
<p><img src="_images/math/f120915a77efb3200aab141647a59f51df9b4611.png" alt="\frac{1}{\sum_{i=1}^n t_i}\sum_{i:t_i=1}^n \left\{ Y_i(t_i=1) -
      E[Y_i(t_i=0)] \right\},"/></p>
</div><p>where <img class="math" src="_images/math/64283d3d8caf93093b91aba9a61dbe26b5c18562.png" alt="t_i"/> is a binary explanatory variable defining the
treatment (<img class="math" src="_images/math/cc6ccc003db65691c9d0aebb91b2001e0d752d18.png" alt="t_i=1"/>) and control (<img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>) groups.
Variation in the simulations are due to uncertainty in simulating
<img class="math" src="_images/math/f658a3cf4cf830cd65eab505c530fb4796fea0ed.png" alt="E[Y_i(t_i=0)]"/>, the counterfactual expected value of
<img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> for observations in the treatment group, under the
assumption that everything stays the same except that the treatment
indicator is switched to <img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>.</p>
</li>
<li><p class="first">In conditional prediction models, the average predicted treatment
effect (att.pr) for the treatment group is</p>
<div class="math">
<p><img src="_images/math/77d8002d68a309fc60d4b182880a2dbe1cde6c81.png" alt="\frac{1}{\sum_{i=1}^n t_i}\sum_{i:t_i=1}^n \left\{ Y_i(t_i=1) -
      \widehat{Y_i(t_i=0)}\right\},"/></p>
</div><p>where <img class="math" src="_images/math/64283d3d8caf93093b91aba9a61dbe26b5c18562.png" alt="t_i"/> is a binary explanatory variable defining the
treatment (<img class="math" src="_images/math/cc6ccc003db65691c9d0aebb91b2001e0d752d18.png" alt="t_i=1"/>) and control (<img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>) groups.
Variation in the simulations are due to uncertainty in simulating
<img class="math" src="_images/math/8056bf28681ea8573bf29bfeb3c72dffa40a2fa7.png" alt="\widehat{Y_i(t_i=0)}"/>, the counterfactual predicted value of
<img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> for observations in the treatment group, under the
assumption that everything stays the same except that the treatment
indicator is switched to <img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>.</p>
</li>
</ul>
</div>
<div class="section" id="id10">
<h3>Output Values<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<p>The output of each Zelig command contains useful information which you
may view. For example, if you run
<tt class="docutils literal"><span class="pre">z.out</span> <span class="pre">&lt;-</span> <span class="pre">zelig(y</span> <span class="pre">~</span> <span class="pre">x,</span> <span class="pre">model</span> <span class="pre">=</span> <span class="pre">logit,</span> <span class="pre">data)</span></tt>, then you may examine the
available information in <tt class="docutils literal"><span class="pre">z.out</span></tt> by using <tt class="docutils literal"><span class="pre">names(z.out)</span></tt>, see the
coefficients by using z.out$coefficients, and a default summary of
information through <tt class="docutils literal"><span class="pre">summary(z.out)</span></tt>.</p>
</div>
<div class="section" id="id11">
<h3>See also<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<p>The logit model is part of the stats package. Advanced users may
wish to refer to <tt class="docutils literal"><span class="pre">help(glm)</span></tt> and <tt class="docutils literal"><span class="pre">help(family)</span></tt>.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="zelig-lognorm">
<h2>zelig-lognorm<a class="headerlink" href="#zelig-lognorm" title="Permalink to this headline">¶</a></h2>
<p>Log-Normal Regression for Duration Dependent Variables</p>
<p>The log-normal model describes an event’s duration, the dependent
variable, as a function of a set of explanatory variables. The
log-normal model may take time censored dependent variables, and allows
the hazard rate to increase and decrease.</p>
<div class="section" id="id12">
<h3>Syntax<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h3>
<p>With reference classes:</p>
<div class="highlight-r"><div class="highlight"><pre>z5 <span class="o">&lt;-</span> zlognorm<span class="o">$</span>new<span class="p">()</span>
z5<span class="o">$</span>zelig<span class="p">(</span>Surv<span class="p">(</span>Y<span class="p">,</span> C<span class="p">)</span> <span class="o">~</span> X<span class="p">,</span> data <span class="o">=</span> mydata<span class="p">)</span>
z5<span class="o">$</span>setx<span class="p">()</span>
z5<span class="o">$</span>sim<span class="p">()</span>
</pre></div>
</div>
<p>With reference classes:</p>
<div class="highlight-r"><div class="highlight"><pre>z5 <span class="o">&lt;-</span> zlognorm<span class="o">$</span>new<span class="p">()</span>
z5<span class="o">$</span>zelig<span class="p">(</span>Surv<span class="p">(</span>Y<span class="p">,</span> C<span class="p">)</span> <span class="o">~</span> X<span class="p">,</span> data <span class="o">=</span> mydata<span class="p">)</span>
z5<span class="o">$</span>setx<span class="p">()</span>
z5<span class="o">$</span>sim<span class="p">()</span>
</pre></div>
</div>
<p>With the Zelig 4 compatibility wrappers:</p>
<div class="highlight-r"><div class="highlight"><pre>z.out <span class="o">&lt;-</span> zelig<span class="p">(</span>Surv<span class="p">(</span>Y<span class="p">,</span> C<span class="p">)</span> <span class="o">~</span> X<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;lognorm&quot;</span><span class="p">,</span> data <span class="o">=</span> mydata<span class="p">)</span>
x.out <span class="o">&lt;-</span> setx<span class="p">(</span>z.out<span class="p">)</span>
s.out <span class="o">&lt;-</span> sim<span class="p">(</span>z.out<span class="p">,</span> x <span class="o">=</span> x.out<span class="p">)</span>
</pre></div>
</div>
<p>Log-normal models require that the dependent variable be in the form
Surv(Y, C), where Y and C are vectors of length <img class="math" src="_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/>. For each
observation <img class="math" src="_images/math/a581f053bbfa5115f42c13094857cdd12a37ec49.png" alt="i"/> in 1, …, <img class="math" src="_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/>, the value <img class="math" src="_images/math/410a65f64e2a609a2a7f544ed72f0982b719807a.png" alt="y_i"/> is the
duration (lifetime, for example) of each subject, and the associated
<img class="math" src="_images/math/496867ca68c428fa123f26f0f73997632e61e116.png" alt="c_i"/> is a binary variable such that <img class="math" src="_images/math/45bd383d229a85e1c894b645ee5ce5cfad178bdf.png" alt="c_i = 1"/> if the
duration is not censored (<em>e.g.</em>, the subject dies during the study) or
<img class="math" src="_images/math/839e310a40128c2d71f158db2ee1ff3a1a40b81b.png" alt="c_i = 0"/> if the duration is censored (<em>e.g.</em>, the subject is
still alive at the end of the study). If <img class="math" src="_images/math/496867ca68c428fa123f26f0f73997632e61e116.png" alt="c_i"/> is omitted, all Y
are assumed to be completed; that is, time defaults to 1 for all
observations.</p>
</div>
<div class="section" id="id13">
<h3>Input Values<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h3>
<p>In addition to the standard inputs, zelig() takes the following
additional options for lognormal regression:</p>
<ul class="simple">
<li>robust: defaults to FALSE. If TRUE, zelig() computes robust standard
errors based on sandwich estimators (see and ) based on the options
in cluster.</li>
<li>cluster: if robust = TRUE, you may select a variable to define groups
of correlated observations. Let x3 be a variable that consists of
either discrete numeric values, character strings, or factors that
define strata. Then</li>
</ul>
<div class="highlight-r"><div class="highlight"><pre>z.out <span class="o">&lt;-</span> zelig<span class="p">(</span>y <span class="o">~</span> x1 <span class="o">+</span> x2<span class="p">,</span> robust <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> cluster <span class="o">=</span> <span class="s">&quot;x3&quot;</span><span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;exp&quot;</span><span class="p">,</span> data <span class="o">=</span> mydata<span class="p">)</span>
</pre></div>
</div>
<p>means that the observations can be correlated within the strata
defined by the variable x3, and that robust standard errors should be
calculated according to those clusters. If robust = TRUE but cluster
is not specified, zelig() assumes that each observation falls into
its own cluster.</p>
</div>
<div class="section" id="id14">
<h3>Example<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h3>
<p>Attach the sample data:</p>
<div class="highlight-r"><div class="highlight"><pre>data<span class="p">(</span>coalition<span class="p">)</span>
</pre></div>
</div>
<p>Estimate the model:</p>
<div class="highlight-r"><div class="highlight"><pre>z.out <span class="o">&lt;-</span> zelig<span class="p">(</span>Surv<span class="p">(</span>duration<span class="p">,</span> ciep12<span class="p">)</span> <span class="o">~</span> fract <span class="o">+</span> numst2<span class="p">,</span> model <span class="o">=</span><span class="s">&quot;lognorm&quot;</span><span class="p">,</span>  data <span class="o">=</span> coalition<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## How to cite this model in Zelig:</span>
<span class="c">##   Matthew Owen, Olivia Lau, Kosuke Imai, Gary King. 2007.</span>
<span class="c">##   lognorm: Log-Normal Regression for Duration Dependent Variables</span>
<span class="c">##   in Kosuke Imai, Gary King, and Olivia Lau, &quot;Zelig: Everyone&#39;s Statistical Software,&quot;</span>
<span class="c">##   http://datascience.iq.harvard.edu/zelig</span>
</pre></div>
</div>
<p>View the regression output:</p>
<div class="highlight-r"><div class="highlight"><pre>summary<span class="p">(</span>z.out<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## Model: 1Call:</span>
<span class="c">## survival::survreg(formula = Surv(duration, ciep12) ~ fract +</span>
<span class="c">##     numst2, data = ., dist = &quot;lognormal&quot;, model = FALSE)</span>
<span class="c">##</span>
<span class="c">## Coefficients:</span>
<span class="c">## (Intercept)       fract      numst2</span>
<span class="c">##    5.366670   -0.004438    0.559833</span>
<span class="c">##</span>
<span class="c">## Scale= 1.2</span>
<span class="c">##</span>
<span class="c">## Loglik(model)= -1078   Loglik(intercept only)= -1101</span>
<span class="c">##  Chisq= 46.58 on 2 degrees of freedom, p= 7.7e-11</span>
<span class="c">## n= 314</span>
<span class="c">## Next step: Use &#39;setx&#39; method</span>
</pre></div>
</div>
<p>Set the baseline values (with the ruling coalition in the minority) and
the alternative values (with the ruling coalition in the majority) for
X:</p>
<div class="highlight-r"><div class="highlight"><pre>x.low <span class="o">&lt;-</span> setx<span class="p">(</span>z.out<span class="p">,</span> numst2 <span class="o">=</span> <span class="m">0</span><span class="p">)</span>
x.high <span class="o">&lt;-</span> setx<span class="p">(</span>z.out<span class="p">,</span> numst2<span class="o">=</span> <span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Simulate expected values (qi$ev) and first differences (qi$fd):</p>
<div class="highlight-r"><div class="highlight"><pre>s.out <span class="o">&lt;-</span> sim<span class="p">(</span>z.out<span class="p">,</span> x <span class="o">=</span> x.low<span class="p">,</span> x1 <span class="o">=</span> x.high<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>summary<span class="p">(</span>s.out<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">##</span>
<span class="c">##  sim x :</span>
<span class="c">##  -----</span>
<span class="c">## ev</span>
<span class="c">##    mean    sd   50%  2.5% 97.5%</span>
<span class="c">## 1 18.41 2.493 18.15 14.43 23.72</span>
<span class="c">## pv</span>
<span class="c">##    mean    sd   50%  2.5% 97.5%</span>
<span class="c">## 1 18.41 2.493 18.15 14.43 23.72</span>
<span class="c">##</span>
<span class="c">##  sim x1 :</span>
<span class="c">##  -----</span>
<span class="c">## ev</span>
<span class="c">##    mean   sd   50%  2.5% 97.5%</span>
<span class="c">## 1 31.84 3.45 31.81 25.65 39.21</span>
<span class="c">## pv</span>
<span class="c">##    mean   sd   50%  2.5% 97.5%</span>
<span class="c">## 1 31.84 3.45 31.81 25.65 39.21</span>
<span class="c">## fd</span>
<span class="c">##    mean   sd   50%  2.5% 97.5%</span>
<span class="c">## 1 13.44 3.58 13.48 6.544 20.64</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>plot<span class="p">(</span>s.out<span class="p">)</span>
</pre></div>
</div>
<div class="figure">
<img alt="Zelig-lognorm" src="_images/Zelig-lognorm.png" />
<p class="caption">Zelig-lognorm</p>
</div>
</div>
<div class="section" id="id15">
<h3>Model<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h3>
<p>Let <img class="math" src="_images/math/d618fcc344538f93b4596930823c957af4a11865.png" alt="Y_i^*"/> be the survival time for observation <img class="math" src="_images/math/a581f053bbfa5115f42c13094857cdd12a37ec49.png" alt="i"/> with
the density function <img class="math" src="_images/math/c52f3efaf426aaf75ff6fea4bb823873865b1303.png" alt="f(y)"/> and the corresponding distribution
function <img class="math" src="_images/math/39c3fab3abd2a55f823cd0336db679ce1b36eead.png" alt="F(t)=\int_{0}^t f(y) dy"/>. This variable might be
censored for some observations at a fixed time <img class="math" src="_images/math/86ef86313546967dcb442753dcc6f50484dc244b.png" alt="y_c"/> such that the
fully observed dependent variable, <img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/>, is defined as</p>
<div class="math">
<p><img src="_images/math/080eb82277537c413153c5a513d4df9309471caf.png" alt="Y_i = \left\{ \begin{array}{ll}
      Y_i^* &amp; \textrm{if }Y_i^* \leq y_c \\
      y_c &amp; \textrm{if }Y_i^* &gt; y_c \\
    \end{array} \right."/></p>
</div><ul>
<li><p class="first">The <em>stochastic component</em> is described by the distribution of the
partially observed variable, <img class="math" src="_images/math/e4b82f5d0d0b135c68864771e045dc913778a223.png" alt="Y^*"/>. For the lognormal model,
there are two equivalent representations:</p>
<div class="math">
<p><img src="_images/math/2d2f0134ef7cd6c7d89866a45b1771b6a1fde79b.png" alt="\begin{aligned}
    Y_i^* \; \sim \; \textrm{LogNormal}(\mu_i, \sigma^2) &amp; \textrm{ or
} &amp; \log(Y_i^*) \; \sim \; \textrm{Normal}(\mu_i, \sigma^2)\end{aligned}"/></p>
</div><p>where the parameters <img class="math" src="_images/math/fe45a709c71e4160e1a09e3b4cc03d2d36d15644.png" alt="\mu_i"/> and <img class="math" src="_images/math/93c29bfedc993de115781b4fbb7e3a8b9e8d6b51.png" alt="\sigma^2"/> are the mean
and variance of the Normal distribution. (Note that the output from
zelig() parameterizes scale:math:` = sigma`.)</p>
<p>In addition, survival models like the lognormal have three additional
properties. The hazard function <img class="math" src="_images/math/8f59c002cacf4a159c9d1b7ccfa141d30d5dc65c.png" alt="h(t)"/> measures the probability
of not surviving past time <img class="math" src="_images/math/ef9270877405055756d345facd044e4ab297f858.png" alt="t"/> given survival up to <img class="math" src="_images/math/ef9270877405055756d345facd044e4ab297f858.png" alt="t"/>.
In general, the hazard function is equal to <img class="math" src="_images/math/89ae40bbb08f26a2d7a02d4d5af4526f1a20c029.png" alt="f(t)/S(t)"/> where
the survival function <img class="math" src="_images/math/967eb1670359684fab112e11f3a002670dbbff45.png" alt="S(t) =1 - \int_{0}^t f(s) ds"/> represents the fraction still surviving at
time <img class="math" src="_images/math/ef9270877405055756d345facd044e4ab297f858.png" alt="t"/>. The cumulative hazard function <img class="math" src="_images/math/30319a828ec4029a092aefb503bd693e5776e59b.png" alt="H(t)"/> describes
the probability of dying before time <img class="math" src="_images/math/ef9270877405055756d345facd044e4ab297f858.png" alt="t"/>. In general,
<img class="math" src="_images/math/a951cf862eec77b95758fc88815c3addfff6ba11.png" alt="H(t)=
\int_{0}^{t} h(s) ds = -\log S(t)"/>. In the case of the lognormal
model,</p>
<div class="math">
<p><img src="_images/math/deea3408797487ffda9af0b8e8b0ea0b87db7ef5.png" alt="\begin{aligned}
h(t) &amp;=&amp; \frac{1}{\sqrt{2 \pi} \, \sigma t \, S(t)}
\exp\left\{-\frac{1}{2 \sigma^2} (\log \lambda t)^2\right\} \\
S(t) &amp;=&amp; 1 - \Phi\left(\frac{1}{\sigma} \log \lambda t\right) \\
H(t) &amp;=&amp; -\log \left\{ 1 - \Phi\left(\frac{1}{\sigma} \log \lambda t\right) \right\}\end{aligned}"/></p>
</div><p>where <img class="math" src="_images/math/262565daee431ce18fed8cbe6ff35db082bb6a9b.png" alt="\Phi(\cdot)"/> is the cumulative density function for the
Normal distribution.</p>
</li>
<li><p class="first">The <em>systematic component</em> is described as:</p>
<div class="math">
<p><img src="_images/math/41364463bbef7e4f118743532ee95c3ebf4ba7a3.png" alt="\mu_i = x_i \beta ."/></p>
</div></li>
</ul>
</div>
<div class="section" id="id16">
<h3>Quantities of Interest<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">The expected values (qi$ev) for the lognormal model are simulations
of the expected duration:</p>
<div class="math">
<p><img src="_images/math/31ea238b8fad5a97c190036baed367c1644d71d9.png" alt="E(Y) =  \exp\left(\mu_i + \frac{1}{2}\sigma^2 \right),"/></p>
</div><p>given draws of <img class="math" src="_images/math/8ce03f78ed945f2ef3dac87c8799b55b393527e7.png" alt="\beta"/> and <img class="math" src="_images/math/2298cf1485084afe72757a9c8483af49a138d81f.png" alt="\sigma"/> from their sampling
distributions.</p>
</li>
<li><p class="first">The predicted value is a draw from the log-normal distribution given
simulations of the parameters <img class="math" src="_images/math/212bf4406b9299a69a57ea55bc3cf9ccdb9489ad.png" alt="(\lambda_i, \sigma)"/>.</p>
</li>
<li><p class="first">The first difference (qi$fd) is</p>
<div class="math">
<p><img src="_images/math/47e62bb3ada6780d6fd2b247bf221d015d2207d2.png" alt="\textrm{FD} = E(Y \mid x_1) - E(Y \mid x)."/></p>
</div></li>
<li><p class="first">In conditional prediction models, the average expected treatment
effect (att.ev) for the treatment group is</p>
<div class="math">
<p><img src="_images/math/a42073a06e5f64918f546d89584110fe35c0e21d.png" alt="\frac{1}{\sum_{i=1}^n t_i}\sum_{i:t_i=1}^n \{ Y_i(t_i=1) - E[Y_i(t_i=0)] \},"/></p>
</div><p>where <img class="math" src="_images/math/64283d3d8caf93093b91aba9a61dbe26b5c18562.png" alt="t_i"/> is a binary explanatory variable defining the
treatment (<img class="math" src="_images/math/cc6ccc003db65691c9d0aebb91b2001e0d752d18.png" alt="t_i=1"/>) and control (<img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>) groups. When
<img class="math" src="_images/math/3574cfcb10f1bd84fea967193a6ae17c6855de01.png" alt="Y_i(t_i=1)"/> is censored rather than observed, we replace it
with a simulation from the model given available knowledge of the
censoring process. Variation in the simulations is due to two
factors: uncertainty in the imputation process for censored
<img class="math" src="_images/math/9c2fbff8ba260029bc65603e6a06944c5746ad65.png" alt="y_i^*"/> and uncertainty in simulating <img class="math" src="_images/math/f658a3cf4cf830cd65eab505c530fb4796fea0ed.png" alt="E[Y_i(t_i=0)]"/>,
the counterfactual expected value of <img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> for observations in
the treatment group, under the assumption that everything stays the
same except that the treatment indicator is switched to
<img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>.</p>
</li>
<li><p class="first">In conditional prediction models, the average predicted treatment
effect (att.pr) for the treatment group is</p>
<div class="math">
<p><img src="_images/math/db43e079e29b09aa583b792c735eafc894037a2a.png" alt="\frac{1}{\sum_{i=1}^n t_i} \sum_{i:t_i=1}^n \{  Y_i(t_i=1) -
\widehat{Y_i(t_i=0)} \},"/></p>
</div><p>where <img class="math" src="_images/math/64283d3d8caf93093b91aba9a61dbe26b5c18562.png" alt="t_i"/> is a binary explanatory variable defining the
treatment (<img class="math" src="_images/math/cc6ccc003db65691c9d0aebb91b2001e0d752d18.png" alt="t_i=1"/>) and control (<img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>) groups. When
<img class="math" src="_images/math/3574cfcb10f1bd84fea967193a6ae17c6855de01.png" alt="Y_i(t_i=1)"/> is censored rather than observed, we replace it
with a simulation from the model given available knowledge of the
censoring process. Variation in the simulations are due to two
factors: uncertainty in the imputation process for censored
<img class="math" src="_images/math/9c2fbff8ba260029bc65603e6a06944c5746ad65.png" alt="y_i^*"/> and uncertainty in simulating
<img class="math" src="_images/math/8056bf28681ea8573bf29bfeb3c72dffa40a2fa7.png" alt="\widehat{Y_i(t_i=0)}"/>, the counterfactual predicted value of
<img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> for observations in the treatment group, under the
assumption that everything stays the same except that the treatment
indicator is switched to <img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>.</p>
</li>
</ul>
</div>
<div class="section" id="id17">
<h3>Output Values<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h3>
<p>The output of each Zelig command contains useful information which you
may view. For example, if you run
<tt class="docutils literal"><span class="pre">z.out</span> <span class="pre">&lt;-</span> <span class="pre">zelig(Surv(Y,</span> <span class="pre">C)</span> <span class="pre">~</span> <span class="pre">X,</span> <span class="pre">model</span> <span class="pre">=</span> <span class="pre">lognorm,</span> <span class="pre">data)</span></tt>, then you may
examine the available information in <tt class="docutils literal"><span class="pre">z.out</span></tt> by using
<tt class="docutils literal"><span class="pre">names(z.out)</span></tt>, see the coefficients by using z.out$coefficients, and
a default summary of information through <tt class="docutils literal"><span class="pre">summary(z.out)</span></tt>.</p>
</div>
<div class="section" id="id18">
<h3>See also<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h3>
<p>The exponential function is part of the survival library by by Terry
Therneau, ported to R by Thomas Lumley. Advanced users may wish to refer
to <tt class="docutils literal"><span class="pre">help(survfit)</span></tt> in the survival library.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="zelig-ls">
<h2>zelig-ls<a class="headerlink" href="#zelig-ls" title="Permalink to this headline">¶</a></h2>
<p>Least Squares Regression for Continuous Dependent Variables</p>
<p>Use least squares regression analysis to estimate the best linear
predictor for the specified dependent variables.</p>
<div class="section" id="id19">
<h3>Syntax<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h3>
<p>With reference classes:</p>
<div class="highlight-r"><div class="highlight"><pre>z5 <span class="o">&lt;-</span> zls<span class="o">$</span>new<span class="p">()</span>
z5<span class="o">$</span>zelig<span class="p">(</span>Y <span class="o">~</span> X1 <span class="o">+</span> X <span class="o">~</span> X<span class="p">,</span> data <span class="o">=</span> mydata<span class="p">)</span>
z5<span class="o">$</span>setx<span class="p">()</span>
z5<span class="o">$</span>sim<span class="p">()</span>
</pre></div>
</div>
<p>With the Zelig 4 compatibility wrappers:</p>
<div class="highlight-r"><div class="highlight"><pre>z.out <span class="o">&lt;-</span> zelig<span class="p">(</span>Y <span class="o">~</span> X1 <span class="o">+</span> X2<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;ls&quot;</span><span class="p">,</span> data <span class="o">=</span> mydata<span class="p">)</span>
x.out <span class="o">&lt;-</span> setx<span class="p">(</span>z.out<span class="p">)</span>
s.out <span class="o">&lt;-</span> sim<span class="p">(</span>z.out<span class="p">,</span> x <span class="o">=</span> x.out<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id20">
<h3>Examples<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h3>
<div class="section" id="basic-example-with-first-differences">
<h4>Basic Example with First Differences<a class="headerlink" href="#basic-example-with-first-differences" title="Permalink to this headline">¶</a></h4>
<p>Attach sample data:</p>
<div class="highlight-r"><div class="highlight"><pre>data<span class="p">(</span>macro<span class="p">)</span>
</pre></div>
</div>
<p>Estimate model:</p>
<div class="highlight-r"><div class="highlight"><pre>z.out1 <span class="o">&lt;-</span> zelig<span class="p">(</span>unem <span class="o">~</span> gdp <span class="o">+</span> capmob <span class="o">+</span> trade<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;ls&quot;</span><span class="p">,</span> data <span class="o">=</span> macro<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## How to cite this model in Zelig:</span>
<span class="c">##   Kosuke Imai, Gary King, and Olivia Lau. 2007.</span>
<span class="c">##   ls: Least Squares Regression for Continuous Dependent Variables</span>
<span class="c">##   in Kosuke Imai, Gary King, and Olivia Lau, &quot;Zelig: Everyone&#39;s Statistical Software,&quot;</span>
<span class="c">##   http://datascience.iq.harvard.edu/zelig</span>
</pre></div>
</div>
<p>Summarize regression coefficients:</p>
<div class="highlight-r"><div class="highlight"><pre>summary<span class="p">(</span>z.out1<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## Model: 1</span>
<span class="c">## Call:</span>
<span class="c">## stats::lm(formula = unem ~ gdp + capmob + trade, data = .)</span>
<span class="c">##</span>
<span class="c">## Coefficients:</span>
<span class="c">## (Intercept)          gdp       capmob        trade</span>
<span class="c">##      6.1813      -0.3236       1.4219       0.0199</span>
<span class="c">##</span>
<span class="c">## Next step: Use &#39;setx&#39; method</span>
</pre></div>
</div>
<p>Set explanatory variables to their default (mean/mode) values, with
high (80th percentile) and low (20th percentile) values for the trade
variable:</p>
<div class="highlight-r"><div class="highlight"><pre>x.high <span class="o">&lt;-</span> setx<span class="p">(</span>z.out1<span class="p">,</span> trade <span class="o">=</span> quantile<span class="p">(</span>macro<span class="o">$</span>trade<span class="p">,</span> <span class="m">0.8</span><span class="p">))</span>
x.low <span class="o">&lt;-</span> setx<span class="p">(</span>z.out1<span class="p">,</span> trade <span class="o">=</span> quantile<span class="p">(</span>macro<span class="o">$</span>trade<span class="p">,</span> <span class="m">0.2</span><span class="p">))</span>
</pre></div>
</div>
<p>Generate first differences for the effect of high versus low trade on GDP:</p>
<div class="highlight-r"><div class="highlight"><pre>s.out1 <span class="o">&lt;-</span> sim<span class="p">(</span>z.out1<span class="p">,</span> x <span class="o">=</span> x.high<span class="p">,</span> x1 <span class="o">=</span> x.low<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>summary<span class="p">(</span>s.out1<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">##</span>
<span class="c">##  sim x :</span>
<span class="c">##  -----</span>
<span class="c">## ev</span>
<span class="c">##    mean     sd   50%  2.5% 97.5%</span>
<span class="c">## 1 5.426 0.1933 5.423 5.045   5.8</span>
<span class="c">## pv</span>
<span class="c">##    mean     sd   50%  2.5% 97.5%</span>
<span class="c">## 1 5.426 0.1933 5.423 5.045   5.8</span>
<span class="c">##</span>
<span class="c">##  sim x1 :</span>
<span class="c">##  -----</span>
<span class="c">## ev</span>
<span class="c">##   mean     sd   50%  2.5% 97.5%</span>
<span class="c">## 1  4.6 0.1857 4.603 4.255 4.967</span>
<span class="c">## pv</span>
<span class="c">##   mean     sd   50%  2.5% 97.5%</span>
<span class="c">## 1  4.6 0.1857 4.603 4.255 4.967</span>
<span class="c">## fd</span>
<span class="c">##      mean     sd     50%   2.5%   97.5%</span>
<span class="c">## 1 -0.8263 0.2281 -0.8278 -1.254 -0.3708</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>plot<span class="p">(</span>s.out1<span class="p">)</span>
</pre></div>
</div>
<div class="figure">
<img alt="" src="_images/unnamed-chunk-10.png" />
</div>
</div>
<div class="section" id="using-dummy-variables">
<h4>Using Dummy Variables<a class="headerlink" href="#using-dummy-variables" title="Permalink to this headline">¶</a></h4>
<p>Estimate a model with fixed effects for each country (see for help
with dummy variables). Note that you do not need to create dummy
variables, as the program will automatically parse the unique values
in the selected variable into discrete levels.</p>
<div class="highlight-r"><div class="highlight"><pre>z.out2 <span class="o">&lt;-</span> zelig<span class="p">(</span>unem <span class="o">~</span> gdp <span class="o">+</span> trade <span class="o">+</span> capmob <span class="o">+</span> as.factor<span class="p">(</span>country<span class="p">),</span> model <span class="o">=</span> <span class="s">&quot;ls&quot;</span><span class="p">,</span> data <span class="o">=</span> macro<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## How to cite this model in Zelig:</span>
<span class="c">##   Kosuke Imai, Gary King, and Olivia Lau. 2007.</span>
<span class="c">##   ls: Least Squares Regression for Continuous Dependent Variables</span>
<span class="c">##   in Kosuke Imai, Gary King, and Olivia Lau, &quot;Zelig: Everyone&#39;s Statistical Software,&quot;</span>
<span class="c">##   http://datascience.iq.harvard.edu/zelig</span>
</pre></div>
</div>
<p>Set values for the explanatory variables, using the default mean/mode
values, with country set to the United States and Japan,
respectively:</p>
<div class="highlight-r"><div class="highlight"><pre>x.US <span class="o">&lt;-</span> setx<span class="p">(</span>z.out2<span class="p">,</span> country <span class="o">=</span> <span class="s">&quot;United States&quot;</span><span class="p">)</span>
x.Japan <span class="o">&lt;-</span> setx<span class="p">(</span>z.out2<span class="p">,</span> country <span class="o">=</span> <span class="s">&quot;Japan&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Simulate quantities of interest:</p>
<div class="highlight-r"><div class="highlight"><pre>s.out2 <span class="o">&lt;-</span> sim<span class="p">(</span>z.out2<span class="p">,</span> x <span class="o">=</span> x.US<span class="p">,</span> x1 <span class="o">=</span> x.Japan<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>plot<span class="p">(</span>s.out2<span class="p">)</span>
</pre></div>
</div>
<div class="figure">
<img alt="" src="_images/unnamed-chunk-14.png" />
</div>
</div>
</div>
<div class="section" id="id21">
<h3>Model<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">The <em>stochastic component</em> is described by a density with mean
<img class="math" src="_images/math/fe45a709c71e4160e1a09e3b4cc03d2d36d15644.png" alt="\mu_i"/> and the common variance <img class="math" src="_images/math/93c29bfedc993de115781b4fbb7e3a8b9e8d6b51.png" alt="\sigma^2"/></p>
<div class="math">
<p><img src="_images/math/34d94a6f5d061597bbcec0b62d41637f1106c37d.png" alt="Y_i \; \sim \; f(y_i \mid \mu_i, \sigma^2)."/></p>
</div></li>
<li><p class="first">The <em>systematic component</em> models the conditional mean as</p>
<div class="math">
<p><img src="_images/math/e9096bd766e29271a33d6f06c16ab7464b39dd16.png" alt="\mu_i =  x_i \beta"/></p>
</div><p>where <img class="math" src="_images/math/33dfc32d00ebd5c5791c824010a155d9e5630b6f.png" alt="x_i"/> is the vector of covariates, and <img class="math" src="_images/math/8ce03f78ed945f2ef3dac87c8799b55b393527e7.png" alt="\beta"/> is
the vector of coefficients.</p>
<p>The least squares estimator is the best linear predictor of a
dependent variable given <img class="math" src="_images/math/33dfc32d00ebd5c5791c824010a155d9e5630b6f.png" alt="x_i"/>, and minimizes the sum of
squared residuals, <img class="math" src="_images/math/26c72a7cbda08b0d6d18fbed4a88be6d712a98bc.png" alt="\sum_{i=1}^n (Y_i-x_i \beta)^2"/>.</p>
</li>
</ul>
</div>
<div class="section" id="id22">
<h3>Quantities of Interest<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">The expected value (qi$ev) is the mean of simulations from the
stochastic component,</p>
<div class="math">
<p><img src="_images/math/6742e8f4c9da4bc790debe293a4448142af6d624.png" alt="E(Y) = x_i \beta,"/></p>
</div><p>given a draw of <img class="math" src="_images/math/8ce03f78ed945f2ef3dac87c8799b55b393527e7.png" alt="\beta"/> from its sampling distribution.</p>
</li>
<li><p class="first">In conditional prediction models, the average expected treatment
effect (att.ev) for the treatment group is</p>
<div class="math">
<p><img src="_images/math/f120915a77efb3200aab141647a59f51df9b4611.png" alt="\frac{1}{\sum_{i=1}^n t_i}\sum_{i:t_i=1}^n \left\{ Y_i(t_i=1) -
      E[Y_i(t_i=0)] \right\},"/></p>
</div><p>where <img class="math" src="_images/math/64283d3d8caf93093b91aba9a61dbe26b5c18562.png" alt="t_i"/> is a binary explanatory variable defining the
treatment (<img class="math" src="_images/math/cc6ccc003db65691c9d0aebb91b2001e0d752d18.png" alt="t_i=1"/>) and control (<img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>) groups.
Variation in the simulations are due to uncertainty in simulating
<img class="math" src="_images/math/f658a3cf4cf830cd65eab505c530fb4796fea0ed.png" alt="E[Y_i(t_i=0)]"/>, the counterfactual expected value of
<img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> for observations in the treatment group, under the
assumption that everything stays the same except that the treatment
indicator is switched to <img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>.</p>
</li>
</ul>
</div>
<div class="section" id="id23">
<h3>Output Values<a class="headerlink" href="#id23" title="Permalink to this headline">¶</a></h3>
<p>The output of each Zelig command contains useful information which you
may view. For example, if you run
<tt class="docutils literal"><span class="pre">z.out</span> <span class="pre">&lt;-</span> <span class="pre">zelig(y</span> <span class="pre">~</span> <span class="pre">x,</span> <span class="pre">model</span> <span class="pre">=</span> <span class="pre">ls,</span> <span class="pre">data)</span></tt>, then you may examine the
available information in <tt class="docutils literal"><span class="pre">z.out</span></tt> by using <tt class="docutils literal"><span class="pre">names(z.out)</span></tt>, see the
coefficients by using z.out$coefficients, and a default summary of
information through <tt class="docutils literal"><span class="pre">summary(z.out)</span></tt>. Other elements available through
the $ operator are listed below.</p>
<ul>
<li><p class="first">From the zelig() output object z.out, you may extract:</p>
<ul class="simple">
<li>coefficients: parameter estimates for the explanatory variables.</li>
<li>residuals: the working residuals in the final iteration of the
IWLS fit.</li>
<li>fitted.values: fitted values.</li>
<li>df.residual: the residual degrees of freedom.</li>
<li>zelig.data: the input data frame if save.data = TRUE.</li>
</ul>
</li>
<li><p class="first">From summary(z.out), you may extract:</p>
<ul>
<li><p class="first">coefficients: the parameter estimates with their associated
standard errors, <img class="math" src="_images/math/3eca8557203e86160952e1c0f735f7417f3285b1.png" alt="p"/>-values, and <img class="math" src="_images/math/ef9270877405055756d345facd044e4ab297f858.png" alt="t"/>-statistics.</p>
<div class="math">
<p><img src="_images/math/e58a382501917d62fae84d66164159e3f1b6c2ee.png" alt="\hat{\beta} \; = \; \left(\sum_{i=1}^n x_i' x_i\right)^{-1} \sum x_i y_i"/></p>
</div></li>
<li><p class="first">sigma: the square root of the estimate variance of the random
error <img class="math" src="_images/math/630e3a780577ea7921e81ee2ac5237dd1802ec8d.png" alt="e"/>:</p>
<div class="math">
<p><img src="_images/math/ffc81e7e9c9aac1ae3fdf35621486649779a8ed9.png" alt="\hat{\sigma} \; = \; \frac{\sum (Y_i-x_i\hat{\beta})^2}{n-k}"/></p>
</div></li>
<li><p class="first">r.squared: the fraction of the variance explained by the model.</p>
<div class="math">
<p><img src="_images/math/00412d048f95c80e8dd72b1e864c6bda22059802.png" alt="R^2 \; = \; 1 - \frac{\sum (Y_i-x_i\hat{\beta})^2}{\sum (y_i -
         \bar{y})^2}"/></p>
</div></li>
<li><p class="first">adj.r.squared: the above <img class="math" src="_images/math/4f58a3b2897df3c0b9d53a442ae896516ecdeaa0.png" alt="R^2"/> statistic, penalizing for an
increased number of explanatory variables.</p>
</li>
<li><p class="first">cov.unscaled: a <img class="math" src="_images/math/3908ba50237c94909083edd0295cd1c9345b0a8c.png" alt="k \times k"/> matrix of unscaled covariances.</p>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="id24">
<h3>See also<a class="headerlink" href="#id24" title="Permalink to this headline">¶</a></h3>
<p>The least squares regression is part of the stats package by William N.
Venables and Brian D. Ripley .In addition, advanced users may wish to
refer to <tt class="docutils literal"><span class="pre">help(lm)</span></tt> and <tt class="docutils literal"><span class="pre">help(lm.fit)</span></tt>.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="zelig-negbin">
<h2>zelig-negbin<a class="headerlink" href="#zelig-negbin" title="Permalink to this headline">¶</a></h2>
<p>Negative Binomial Regression for Event Count Dependent Variables</p>
<p>Use the negative binomial regression if you have a count of events for
each observation of your dependent variable. The negative binomial model
is frequently used to estimate over-dispersed event count models.</p>
<div class="section" id="id25">
<h3>Syntax<a class="headerlink" href="#id25" title="Permalink to this headline">¶</a></h3>
<p>With reference classes:</p>
<div class="highlight-r"><div class="highlight"><pre>z5 <span class="o">&lt;-</span> znegbin<span class="o">$</span>new<span class="p">()</span>
z5<span class="o">$</span>zelig<span class="p">(</span>Y <span class="o">~</span> X1 <span class="o">+</span> X <span class="o">~</span> X<span class="p">,</span> data <span class="o">=</span> mydata<span class="p">)</span>
z5<span class="o">$</span>setx<span class="p">()</span>
z5<span class="o">$</span>sim<span class="p">()</span>
</pre></div>
</div>
<p>With the Zelig 4 compatibility wrappers:</p>
<div class="highlight-r"><div class="highlight"><pre>z.out <span class="o">&lt;-</span> zelig<span class="p">(</span>Y <span class="o">~</span> X1 <span class="o">+</span> X2<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;negbin&quot;</span><span class="p">,</span> data <span class="o">=</span> mydata<span class="p">)</span>
x.out <span class="o">&lt;-</span> setx<span class="p">(</span>z.out<span class="p">)</span>
s.out <span class="o">&lt;-</span> sim<span class="p">(</span>z.out<span class="p">,</span> x <span class="o">=</span> x.out<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id26">
<h3>Example<a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h3>
<p>Load sample data:</p>
<div class="highlight-r"><div class="highlight"><pre>data<span class="p">(</span>sanction<span class="p">)</span>
</pre></div>
</div>
<p>Estimate the model:</p>
<div class="highlight-r"><div class="highlight"><pre>z.out <span class="o">&lt;-</span> zelig<span class="p">(</span>num <span class="o">~</span> target <span class="o">+</span> coop<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;negbinom&quot;</span><span class="p">,</span> data <span class="o">=</span> sanction<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## Error: Model &#39;negbinom&#39; not found</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>summary<span class="p">(</span>z.out<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## Model: 1Call:</span>
<span class="c">## survival::survreg(formula = Surv(duration, ciep12) ~ fract +</span>
<span class="c">##     numst2, data = ., dist = &quot;lognormal&quot;, model = FALSE)</span>
<span class="c">##</span>
<span class="c">## Coefficients:</span>
<span class="c">## (Intercept)       fract      numst2</span>
<span class="c">##    5.366670   -0.004438    0.559833</span>
<span class="c">##</span>
<span class="c">## Scale= 1.2</span>
<span class="c">##</span>
<span class="c">## Loglik(model)= -1078   Loglik(intercept only)= -1101</span>
<span class="c">##  Chisq= 46.58 on 2 degrees of freedom, p= 7.7e-11</span>
<span class="c">## n= 314</span>
<span class="c">## Next step: Use &#39;setx&#39; method</span>
</pre></div>
</div>
<p>Set values for the explanatory variables to their default mean values:</p>
<div class="highlight-r"><div class="highlight"><pre>x.out <span class="o">&lt;-</span> setx<span class="p">(</span>z.out<span class="p">)</span>
</pre></div>
</div>
<p>Simulate fitted values:</p>
<div class="highlight-r"><div class="highlight"><pre>s.out <span class="o">&lt;-</span> sim<span class="p">(</span>z.out<span class="p">,</span> x <span class="o">=</span> x.out<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>summary<span class="p">(</span>s.out<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">##</span>
<span class="c">##  sim x :</span>
<span class="c">##  -----</span>
<span class="c">## ev</span>
<span class="c">##    mean    sd   50%  2.5% 97.5%</span>
<span class="c">## 1 26.04 2.564 25.95 21.36 31.45</span>
<span class="c">## pv</span>
<span class="c">##    mean    sd   50%  2.5% 97.5%</span>
<span class="c">## 1 26.04 2.564 25.95 21.36 31.45</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>plot<span class="p">(</span>s.out<span class="p">)</span>
</pre></div>
</div>
<div class="figure">
<img alt="Zelig-negbin" src="_images/Zelig-negbin.png" />
<p class="caption">Zelig-negbin</p>
</div>
</div>
<div class="section" id="id27">
<h3>Model<a class="headerlink" href="#id27" title="Permalink to this headline">¶</a></h3>
<p>Let <img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> be the number of independent events that occur during a
fixed time period. This variable can take any non-negative integer
value.</p>
<ul>
<li><p class="first">The negative binomial distribution is derived by letting the mean of
the Poisson distribution vary according to a fixed parameter
<img class="math" src="_images/math/1a534f73d7999c523b01512801d3bda18adee3b7.png" alt="\zeta"/> given by the Gamma distribution. The <em>stochastic
component</em> is given by</p>
<div class="math">
<p><img src="_images/math/bd08836a98d9156598663d31c4c76c26581aab11.png" alt="\begin{aligned}
     Y_i \mid \zeta_i &amp; \sim &amp; \textrm{Poisson}(\zeta_i \mu_i),\\
     \zeta_i &amp; \sim &amp; \frac{1}{\theta}\textrm{Gamma}(\theta).
   \end{aligned}"/></p>
</div><p>The marginal distribution of <img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> is then the negative
binomial with mean <img class="math" src="_images/math/fe45a709c71e4160e1a09e3b4cc03d2d36d15644.png" alt="\mu_i"/> and variance
<img class="math" src="_images/math/4b5943fd01fbda26432b4db9936abed9fb52cc64.png" alt="\mu_i + \mu_i^2/\theta"/>:</p>
<div class="math">
<p><img src="_images/math/bfcce2bd73058487e73f11f41d0a02f9837e2ec3.png" alt="\begin{aligned}
   Y_i &amp; \sim &amp; \textrm{NegBin}(\mu_i, \theta), \\
       &amp; = &amp; \frac{\Gamma (\theta + y_i)}{y! \, \Gamma(\theta)}
             \frac{\mu_i^{y_i} \, \theta^{\theta}}{(\mu_i + \theta)^{\theta + y_i}},
   \end{aligned}"/></p>
</div><p>where <img class="math" src="_images/math/a9cfbeb8ebee1f365919e147a79e242dcb67ee5d.png" alt="\theta"/> is the systematic parameter of the Gamma
distribution modeling <img class="math" src="_images/math/b2c74aae8f9d0cb0072e974b47723f2e5521b401.png" alt="\zeta_i"/>.</p>
</li>
<li><p class="first">The <em>systematic component</em> is given by</p>
<div class="math">
<p><img src="_images/math/81474e43896f32f2f86670eec250ff10b8653b09.png" alt="\mu_i = \exp(x_i \beta)"/></p>
</div><p>where <img class="math" src="_images/math/33dfc32d00ebd5c5791c824010a155d9e5630b6f.png" alt="x_i"/> is the vector of <img class="math" src="_images/math/e9203da50e1059455123460d4e716c9c7f440cc3.png" alt="k"/> explanatory variables
and <img class="math" src="_images/math/8ce03f78ed945f2ef3dac87c8799b55b393527e7.png" alt="\beta"/> is the vector of coefficients.</p>
</li>
</ul>
</div>
<div class="section" id="id28">
<h3>Quantities of Interest<a class="headerlink" href="#id28" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">The expected values (qi$ev) are simulations of the mean of the
stochastic component. Thus,</p>
<div class="math">
<p><img src="_images/math/ed68ddf7d6e8d78ed9fb9a9bb55febcf8f71d49e.png" alt="E(Y) = \mu_i = \exp(x_i
  \beta),"/></p>
</div><p>given simulations of <img class="math" src="_images/math/8ce03f78ed945f2ef3dac87c8799b55b393527e7.png" alt="\beta"/>.</p>
</li>
<li><p class="first">The predicted value (qi$pr) drawn from the distribution defined by
the set of parameters <img class="math" src="_images/math/9054fec1d747aca9cfcaa9d679834cf2fd26b899.png" alt="(\mu_i, \theta)"/>.</p>
</li>
<li><p class="first">The first difference (qi$fd) is</p>
<div class="math">
<p><img src="_images/math/82a49121147fab5307d7df11a6b69165b3f6794c.png" alt="\textrm{FD} \; = \; E(Y | x_1) - E(Y \mid x)"/></p>
</div></li>
<li><p class="first">In conditional prediction models, the average expected treatment
effect (att.ev) for the treatment group is</p>
<div class="math">
<p><img src="_images/math/f120915a77efb3200aab141647a59f51df9b4611.png" alt="\frac{1}{\sum_{i=1}^n t_i}\sum_{i:t_i=1}^n \left\{ Y_i(t_i=1) -
      E[Y_i(t_i=0)] \right\},"/></p>
</div><p>where <img class="math" src="_images/math/64283d3d8caf93093b91aba9a61dbe26b5c18562.png" alt="t_i"/> is a binary explanatory variable defining the
treatment (<img class="math" src="_images/math/cc6ccc003db65691c9d0aebb91b2001e0d752d18.png" alt="t_i=1"/>) and control (<img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>) groups.
Variation in the simulations are due to uncertainty in simulating
<img class="math" src="_images/math/f658a3cf4cf830cd65eab505c530fb4796fea0ed.png" alt="E[Y_i(t_i=0)]"/>, the counterfactual expected value of
<img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> for observations in the treatment group, under the
assumption that everything stays the same except that the treatment
indicator is switched to <img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>.</p>
</li>
<li><p class="first">In conditional prediction models, the average predicted treatment
effect (att.pr) for the treatment group is</p>
<div class="math">
<p><img src="_images/math/da7e72f6d651b92ad0874d3b40cd633ac38f5663.png" alt="\frac{1}{\sum_{i=1}^n t_i}\sum_{i:t_i=1}^n \left\{ Y_i(t_i=1) -
      \widehat{Y_i(t_i=0)} \right\},"/></p>
</div><p>where <img class="math" src="_images/math/64283d3d8caf93093b91aba9a61dbe26b5c18562.png" alt="t_i"/> is a binary explanatory variable defining the
treatment (<img class="math" src="_images/math/cc6ccc003db65691c9d0aebb91b2001e0d752d18.png" alt="t_i=1"/>) and control (<img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>) groups.
Variation in the simulations are due to uncertainty in simulating
<img class="math" src="_images/math/8056bf28681ea8573bf29bfeb3c72dffa40a2fa7.png" alt="\widehat{Y_i(t_i=0)}"/>, the counterfactual predicted value of
<img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> for observations in the treatment group, under the
assumption that everything stays the same except that the treatment
indicator is switched to <img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>.</p>
</li>
</ul>
</div>
<div class="section" id="id29">
<h3>Output Values<a class="headerlink" href="#id29" title="Permalink to this headline">¶</a></h3>
<p>The output of each Zelig command contains useful information which you
may view. For example, if you run
<tt class="docutils literal"><span class="pre">z.out</span> <span class="pre">&lt;-</span> <span class="pre">zelig(y</span> <span class="pre">~</span> <span class="pre">x,</span> <span class="pre">model</span> <span class="pre">=</span> <span class="pre">negbin,</span> <span class="pre">data)</span></tt>, then you may examine
the available information in <tt class="docutils literal"><span class="pre">z.out</span></tt> by using <tt class="docutils literal"><span class="pre">names(z.out)</span></tt>, see
the coefficients by using z.out$coefficients, and a default summary of
information through <tt class="docutils literal"><span class="pre">summary(z.out)</span></tt>.</p>
</div>
<div class="section" id="id30">
<h3>See also<a class="headerlink" href="#id30" title="Permalink to this headline">¶</a></h3>
<p>The negative binomial model is part of the MASS package by William N.
Venable and Brian D. Ripley . Advanced users may wish to refer to
<a href="#id31"><span class="problematic" id="id32">``</span></a>help(glm.nb)`.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="zelig-normal">
<h2>zelig-normal<a class="headerlink" href="#zelig-normal" title="Permalink to this headline">¶</a></h2>
<p>Normal Regression for Continuous Dependent Variables</p>
<p>The Normal regression model is a close variant of the more standard
least squares regression model (see ). Both models specify a continuous
dependent variable as a linear function of a set of explanatory
variables. The Normal model reports maximum likelihood (rather than
least squares) estimates. The two models differ only in their estimate
for the stochastic parameter <img class="math" src="_images/math/2298cf1485084afe72757a9c8483af49a138d81f.png" alt="\sigma"/>.</p>
<div class="section" id="id33">
<h3>Syntax<a class="headerlink" href="#id33" title="Permalink to this headline">¶</a></h3>
<p>With reference classes:</p>
<div class="highlight-r"><div class="highlight"><pre>z5 <span class="o">&lt;-</span> znormal<span class="o">$</span>new<span class="p">()</span>
z5<span class="o">$</span>zelig<span class="p">(</span>Y <span class="o">~</span> X1 <span class="o">+</span> X <span class="o">~</span> X<span class="p">,</span> data <span class="o">=</span> mydata<span class="p">)</span>
z5<span class="o">$</span>setx<span class="p">()</span>
z5<span class="o">$</span>sim<span class="p">()</span>
</pre></div>
</div>
<p>With the Zelig 4 compatibility wrappers:</p>
<div class="highlight-r"><div class="highlight"><pre>z.out <span class="o">&lt;-</span> zelig<span class="p">(</span>Y <span class="o">~</span> X1 <span class="o">+</span> X2<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;normal&quot;</span><span class="p">,</span> data <span class="o">=</span> mydata<span class="p">)</span>
x.out <span class="o">&lt;-</span> setx<span class="p">(</span>z.out<span class="p">)</span>
s.out <span class="o">&lt;-</span> sim<span class="p">(</span>z.out<span class="p">,</span> x <span class="o">=</span> x.out<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id34">
<h3>Examples<a class="headerlink" href="#id34" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id35">
<h4>Basic Example with First Differences<a class="headerlink" href="#id35" title="Permalink to this headline">¶</a></h4>
<p>Attach sample data:</p>
<div class="highlight-r"><div class="highlight"><pre>data<span class="p">(</span>macro<span class="p">)</span>
</pre></div>
</div>
<p>Estimate model:</p>
<div class="highlight-r"><div class="highlight"><pre>z.out1 <span class="o">&lt;-</span> zelig<span class="p">(</span>unem <span class="o">~</span> gdp <span class="o">+</span> capmob <span class="o">+</span> trade<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;normal&quot;</span><span class="p">,</span> data <span class="o">=</span> macro<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## How to cite this model in Zelig:</span>
<span class="c">##   Kosuke Imai, Gary King, Olivia Lau. 2008.</span>
<span class="c">##   normal: Normal Regression for Continuous Dependent Variables</span>
<span class="c">##   in Kosuke Imai, Gary King, and Olivia Lau, &quot;Zelig: Everyone&#39;s Statistical Software,&quot;</span>
<span class="c">##   http://datascience.iq.harvard.edu/zelig</span>
</pre></div>
</div>
<p>Summarize of regression coefficients:</p>
<div class="highlight-r"><div class="highlight"><pre>summary<span class="p">(</span>z.out1<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## Model: 1</span>
<span class="c">## Call:  stats::glm(formula = unem ~ gdp + capmob + trade, family = gaussian(&quot;identity&quot;),</span>
<span class="c">##     data = .)</span>
<span class="c">##</span>
<span class="c">## Coefficients:</span>
<span class="c">## (Intercept)          gdp       capmob        trade</span>
<span class="c">##      6.1813      -0.3236       1.4219       0.0199</span>
<span class="c">##</span>
<span class="c">## Degrees of Freedom: 349 Total (i.e. Null);  346 Residual</span>
<span class="c">## Null Deviance:       3660</span>
<span class="c">## Residual Deviance: 2610  AIC: 1710</span>
<span class="c">## Next step: Use &#39;setx&#39; method</span>
</pre></div>
</div>
<p>Set explanatory variables to their default (mean/mode) values, with
high (80th percentile) and low (20th percentile) values for trade:</p>
<div class="highlight-r"><div class="highlight"><pre>x.high <span class="o">&lt;-</span> setx<span class="p">(</span>z.out1<span class="p">,</span> trade <span class="o">=</span> quantile<span class="p">(</span>macro<span class="o">$</span>trade<span class="p">,</span> <span class="m">0.8</span><span class="p">))</span>
x.low <span class="o">&lt;-</span> setx<span class="p">(</span>z.out1<span class="p">,</span> trade <span class="o">=</span> quantile<span class="p">(</span>macro<span class="o">$</span>trade<span class="p">,</span> <span class="m">0.2</span><span class="p">))</span>
</pre></div>
</div>
<p>Generate first differences for the effect of high versus low trade on GDP:</p>
<div class="highlight-r"><div class="highlight"><pre>s.out1 <span class="o">&lt;-</span> sim<span class="p">(</span>z.out1<span class="p">,</span> x <span class="o">=</span> x.high<span class="p">,</span> x1 <span class="o">=</span> x.low<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>summary<span class="p">(</span>s.out1<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">##</span>
<span class="c">##  sim x :</span>
<span class="c">##  -----</span>
<span class="c">## ev</span>
<span class="c">##       mean     sd   50%  2.5% 97.5%</span>
<span class="c">## [1,] 5.424 0.1955 5.424 5.045 5.815</span>
<span class="c">## pv</span>
<span class="c">##       mean    sd   50%   2.5% 97.5%</span>
<span class="c">## [1,] 5.559 2.767 5.472 0.4313 11.18</span>
<span class="c">##</span>
<span class="c">##  sim x1 :</span>
<span class="c">##  -----</span>
<span class="c">## ev</span>
<span class="c">##      mean     sd   50%  2.5% 97.5%</span>
<span class="c">## [1,] 4.59 0.1831 4.582 4.233 4.963</span>
<span class="c">## pv</span>
<span class="c">##       mean    sd   50%    2.5% 97.5%</span>
<span class="c">## [1,] 4.526 2.828 4.505 -0.9631 10.21</span>
<span class="c">## fd</span>
<span class="c">##         mean     sd     50%   2.5%   97.5%</span>
<span class="c">## [1,] -0.8335 0.2352 -0.8346 -1.307 -0.3656</span>
</pre></div>
</div>
<p>A visual summary of quantities of interest:</p>
<div class="highlight-r"><div class="highlight"><pre>plot<span class="p">(</span>s.out1<span class="p">)</span>
</pre></div>
</div>
<div class="figure">
<img alt="Zelig-normal" src="_images/Zelig-normal.png" />
<p class="caption">Zelig-normal</p>
</div>
</div>
</div>
<div class="section" id="id36">
<h3>Model<a class="headerlink" href="#id36" title="Permalink to this headline">¶</a></h3>
<p>Let <img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> be the continuous dependent variable for observation
<img class="math" src="_images/math/a581f053bbfa5115f42c13094857cdd12a37ec49.png" alt="i"/>.</p>
<ul>
<li><p class="first">The <em>stochastic component</em> is described by a univariate normal model
with a vector of means <img class="math" src="_images/math/fe45a709c71e4160e1a09e3b4cc03d2d36d15644.png" alt="\mu_i"/> and scalar variance
<img class="math" src="_images/math/93c29bfedc993de115781b4fbb7e3a8b9e8d6b51.png" alt="\sigma^2"/>:</p>
<div class="math">
<p><img src="_images/math/92cca0a95579bbd947f5e2566bdf78a2027f3f9b.png" alt="Y_i \; \sim \; \textrm{Normal}(\mu_i, \sigma^2)."/></p>
</div></li>
<li><p class="first">The <em>systematic component</em> is</p>
<div class="math">
<p><img src="_images/math/e2582c2521dff40fd1d1a9e277d397dccf4919cb.png" alt="\mu_i \;= \; x_i \beta,"/></p>
</div><p>where <img class="math" src="_images/math/33dfc32d00ebd5c5791c824010a155d9e5630b6f.png" alt="x_i"/> is the vector of <img class="math" src="_images/math/e9203da50e1059455123460d4e716c9c7f440cc3.png" alt="k"/> explanatory variables
and <img class="math" src="_images/math/8ce03f78ed945f2ef3dac87c8799b55b393527e7.png" alt="\beta"/> is the vector of coefficients.</p>
</li>
</ul>
</div>
<div class="section" id="id37">
<h3>Quantities of Interest<a class="headerlink" href="#id37" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">The expected value (qi$ev) is the mean of simulations from the the
stochastic component,</p>
<div class="math">
<p><img src="_images/math/4c7424be232769f740891d7a55f7aef33f47572f.png" alt="E(Y) = \mu_i = x_i \beta,"/></p>
</div><p>given a draw of <img class="math" src="_images/math/8ce03f78ed945f2ef3dac87c8799b55b393527e7.png" alt="\beta"/> from its posterior.</p>
</li>
<li><p class="first">The predicted value (qi$pr) is drawn from the distribution defined by
the set of parameters <img class="math" src="_images/math/26ce59f07ba5807f8bb61216cbf3188c6cb18c80.png" alt="(\mu_i, \sigma)"/>.</p>
</li>
<li><p class="first">The first difference (qi$fd) is:</p>
<div class="math">
<p><img src="_images/math/5eb5fe9153bef31d3b9734bb97e106810e590906.png" alt="\textrm{FD}\; = \;E(Y \mid x_1) -  E(Y \mid x)"/></p>
</div></li>
<li><p class="first">In conditional prediction models, the average expected treatment
effect (att.ev) for the treatment group is</p>
<div class="math">
<p><img src="_images/math/f120915a77efb3200aab141647a59f51df9b4611.png" alt="\frac{1}{\sum_{i=1}^n t_i}\sum_{i:t_i=1}^n \left\{ Y_i(t_i=1) -
      E[Y_i(t_i=0)] \right\},"/></p>
</div><p>where <img class="math" src="_images/math/64283d3d8caf93093b91aba9a61dbe26b5c18562.png" alt="t_i"/> is a binary explanatory variable defining the
treatment (<img class="math" src="_images/math/cc6ccc003db65691c9d0aebb91b2001e0d752d18.png" alt="t_i=1"/>) and control (<img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>) groups.
Variation in the simulations are due to uncertainty in simulating
<img class="math" src="_images/math/f658a3cf4cf830cd65eab505c530fb4796fea0ed.png" alt="E[Y_i(t_i=0)]"/>, the counterfactual expected value of
<img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> for observations in the treatment group, under the
assumption that everything stays the same except that the treatment
indicator is switched to <img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>.</p>
</li>
<li><p class="first">In conditional prediction models, the average predicted treatment
effect (att.pr) for the treatment group is</p>
<div class="math">
<p><img src="_images/math/da7e72f6d651b92ad0874d3b40cd633ac38f5663.png" alt="\frac{1}{\sum_{i=1}^n t_i}\sum_{i:t_i=1}^n \left\{ Y_i(t_i=1) -
      \widehat{Y_i(t_i=0)} \right\},"/></p>
</div><p>where <img class="math" src="_images/math/64283d3d8caf93093b91aba9a61dbe26b5c18562.png" alt="t_i"/> is a binary explanatory variable defining the
treatment (<img class="math" src="_images/math/cc6ccc003db65691c9d0aebb91b2001e0d752d18.png" alt="t_i=1"/>) and control (<img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>) groups.
Variation in the simulations are due to uncertainty in simulating
<img class="math" src="_images/math/8056bf28681ea8573bf29bfeb3c72dffa40a2fa7.png" alt="\widehat{Y_i(t_i=0)}"/>, the counterfactual predicted value of
<img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> for observations in the treatment group, under the
assumption that everything stays the same except that the treatment
indicator is switched to <img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>.</p>
</li>
</ul>
</div>
<div class="section" id="id38">
<h3>Output Values<a class="headerlink" href="#id38" title="Permalink to this headline">¶</a></h3>
<p>The output of each Zelig command contains useful information which you
may view. For example, if you run
<tt class="docutils literal"><span class="pre">z.out</span> <span class="pre">&lt;-</span> <span class="pre">zelig(y</span> <span class="pre">~</span> <span class="pre">x,</span> <span class="pre">model</span> <span class="pre">=</span> <span class="pre">normal,</span> <span class="pre">data)</span></tt>, then you may examine
the available information in <tt class="docutils literal"><span class="pre">z.out</span></tt> by using <tt class="docutils literal"><span class="pre">names(z.out)</span></tt>, see
the coefficients by using z.out$coefficients, and a default summary of
information through <tt class="docutils literal"><span class="pre">summary(z.out)</span></tt>.</p>
</div>
<div class="section" id="id39">
<h3>See also<a class="headerlink" href="#id39" title="Permalink to this headline">¶</a></h3>
<p>The normal model is part of the stats package by . Advanced users may
wish to refer to <tt class="docutils literal"><span class="pre">help(glm)</span></tt> and <tt class="docutils literal"><span class="pre">help(family)</span></tt>.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="zelig-poisson">
<h2>zelig-poisson<a class="headerlink" href="#zelig-poisson" title="Permalink to this headline">¶</a></h2>
<p>Poisson Regression for Event Count Dependent Variables</p>
<p>Use the Poisson regression model if the observations of your dependent
variable represents the number of independent events that occur during a
fixed period of time (see the negative binomial model, , for
over-dispersed event counts.) For a Bayesian implementation of this
model, see .</p>
<div class="section" id="id40">
<h3>Syntax<a class="headerlink" href="#id40" title="Permalink to this headline">¶</a></h3>
<p>With reference classes:</p>
<div class="highlight-r"><div class="highlight"><pre>z5 <span class="o">&lt;-</span> zpoisson<span class="o">$</span>new<span class="p">()</span>
z5<span class="o">$</span>zelig<span class="p">(</span>Y <span class="o">~</span> X1 <span class="o">+</span> X <span class="o">~</span> X<span class="p">,</span> data <span class="o">=</span> mydata<span class="p">)</span>
z5<span class="o">$</span>setx<span class="p">()</span>
z5<span class="o">$</span>sim<span class="p">()</span>
</pre></div>
</div>
<p>With the Zelig 4 compatibility wrappers:</p>
<div class="highlight-r"><div class="highlight"><pre>z.out <span class="o">&lt;-</span> zelig<span class="p">(</span>Y <span class="o">~</span> X1 <span class="o">+</span> X2<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;poisson&quot;</span><span class="p">,</span> data <span class="o">=</span> mydata<span class="p">)</span>
x.out <span class="o">&lt;-</span> setx<span class="p">(</span>z.out<span class="p">)</span>
s.out <span class="o">&lt;-</span> sim<span class="p">(</span>z.out<span class="p">,</span> x <span class="o">=</span> x.out<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id41">
<h3>Example<a class="headerlink" href="#id41" title="Permalink to this headline">¶</a></h3>
<p>Load sample data:</p>
<div class="highlight-r"><div class="highlight"><pre>data<span class="p">(</span>sanction<span class="p">)</span>
</pre></div>
</div>
<p>Estimate Poisson model:</p>
<div class="highlight-r"><div class="highlight"><pre>z.out <span class="o">&lt;-</span> zelig<span class="p">(</span>num <span class="o">~</span> target <span class="o">+</span> coop<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;poisson&quot;</span><span class="p">,</span> data <span class="o">=</span> sanction<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## How to cite this model in Zelig:</span>
<span class="c">##   Kosuke Imai, Gary King, Olivia Lau. 2007.</span>
<span class="c">##   poisson: Poisson Regression for Event Count Dependent Variables</span>
<span class="c">##   in Kosuke Imai, Gary King, and Olivia Lau, &quot;Zelig: Everyone&#39;s Statistical Software,&quot;</span>
<span class="c">##   http://datascience.iq.harvard.edu/zelig</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>summary<span class="p">(</span>z.out<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## Model: 1</span>
<span class="c">## Call:  stats::glm(formula = num ~ target + coop, family = poisson(&quot;log&quot;),</span>
<span class="c">##     data = .)</span>
<span class="c">##</span>
<span class="c">## Coefficients:</span>
<span class="c">## (Intercept)       target         coop</span>
<span class="c">##      -0.968       -0.021        1.211</span>
<span class="c">##</span>
<span class="c">## Degrees of Freedom: 77 Total (i.e. Null);  75 Residual</span>
<span class="c">## Null Deviance:       1580</span>
<span class="c">## Residual Deviance: 721   AIC: 944</span>
<span class="c">## Next step: Use &#39;setx&#39; method</span>
</pre></div>
</div>
<p>Set values for the explanatory variables to their default mean values:</p>
<div class="highlight-r"><div class="highlight"><pre>x.out <span class="o">&lt;-</span> setx<span class="p">(</span>z.out<span class="p">)</span>
</pre></div>
</div>
<p>Simulate fitted values:</p>
<div class="highlight-r"><div class="highlight"><pre>s.out <span class="o">&lt;-</span> sim<span class="p">(</span>z.out<span class="p">,</span> x <span class="o">=</span> x.out<span class="p">)</span>
summary<span class="p">(</span>s.out<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">##</span>
<span class="c">##  sim x :</span>
<span class="c">##  -----</span>
<span class="c">## ev</span>
<span class="c">##       mean     sd   50%  2.5% 97.5%</span>
<span class="c">## [1,] 3.238 0.2288 3.227 2.831 3.703</span>
<span class="c">## pv</span>
<span class="c">##      mean    sd 50% 2.5% 97.5%</span>
<span class="c">## [1,] 3.32 1.856   3    0     7</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>plot<span class="p">(</span>s.out<span class="p">)</span>
</pre></div>
</div>
<div class="figure">
<img alt="Zelig-poisson" src="_images/Zelig-poisson.png" />
<p class="caption">Zelig-poisson</p>
</div>
</div>
<div class="section" id="id42">
<h3>Model<a class="headerlink" href="#id42" title="Permalink to this headline">¶</a></h3>
<p>Let <img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> be the number of independent events that occur during a
fixed time period. This variable can take any non-negative integer.</p>
<ul>
<li><p class="first">The Poisson distribution has <em>stochastic component</em></p>
<div class="math">
<p><img src="_images/math/5540ca84e8f5169523335a479866020c89dcb8e1.png" alt="Y_i \; \sim \; \textrm{Poisson}(\lambda_i),"/></p>
</div><p>where <img class="math" src="_images/math/3b765ea6939f1eba2541e91f870cb3c078aa29be.png" alt="\lambda_i"/> is the mean and variance parameter.</p>
</li>
<li><p class="first">The <em>systematic component</em> is</p>
<div class="math">
<p><img src="_images/math/2340a2662ddcb518d4617bd57234f976b60fc74d.png" alt="\lambda_i \; = \; \exp(x_i \beta),"/></p>
</div><p>where <img class="math" src="_images/math/33dfc32d00ebd5c5791c824010a155d9e5630b6f.png" alt="x_i"/> is the vector of explanatory variables, and
<img class="math" src="_images/math/8ce03f78ed945f2ef3dac87c8799b55b393527e7.png" alt="\beta"/> is the vector of coefficients.</p>
</li>
</ul>
</div>
<div class="section" id="id43">
<h3>Quantities of Interest<a class="headerlink" href="#id43" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">The expected value (qi$ev) is the mean of simulations from the
stochastic component,</p>
<div class="math">
<p><img src="_images/math/df22f703cd62d9dfefbd0f0a3b9972af7ca4e507.png" alt="E(Y) = \lambda_i =  \exp(x_i
  \beta),"/></p>
</div><p>given draws of <img class="math" src="_images/math/8ce03f78ed945f2ef3dac87c8799b55b393527e7.png" alt="\beta"/> from its sampling distribution.</p>
</li>
<li><p class="first">The predicted value (qi$pr) is a random draw from the poisson
distribution defined by mean <img class="math" src="_images/math/3b765ea6939f1eba2541e91f870cb3c078aa29be.png" alt="\lambda_i"/>.</p>
</li>
<li><p class="first">The first difference in the expected values (qi$fd) is given by:</p>
<div class="math">
<p><img src="_images/math/82a49121147fab5307d7df11a6b69165b3f6794c.png" alt="\textrm{FD} \; = \; E(Y | x_1) - E(Y \mid x)"/></p>
</div></li>
<li><p class="first">In conditional prediction models, the average expected treatment
effect (att.ev) for the treatment group is</p>
<div class="math">
<p><img src="_images/math/f120915a77efb3200aab141647a59f51df9b4611.png" alt="\frac{1}{\sum_{i=1}^n t_i}\sum_{i:t_i=1}^n \left\{ Y_i(t_i=1) -
      E[Y_i(t_i=0)] \right\},"/></p>
</div><p>where <img class="math" src="_images/math/64283d3d8caf93093b91aba9a61dbe26b5c18562.png" alt="t_i"/> is a binary explanatory variable defining the
treatment (<img class="math" src="_images/math/cc6ccc003db65691c9d0aebb91b2001e0d752d18.png" alt="t_i=1"/>) and control (<img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>) groups.
Variation in the simulations are due to uncertainty in simulating
<img class="math" src="_images/math/f658a3cf4cf830cd65eab505c530fb4796fea0ed.png" alt="E[Y_i(t_i=0)]"/>, the counterfactual expected value of
<img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> for observations in the treatment group, under the
assumption that everything stays the same except that the treatment
indicator is switched to <img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>.</p>
</li>
<li><p class="first">In conditional prediction models, the average predicted treatment
effect (att.pr) for the treatment group is</p>
<div class="math">
<p><img src="_images/math/da7e72f6d651b92ad0874d3b40cd633ac38f5663.png" alt="\frac{1}{\sum_{i=1}^n t_i}\sum_{i:t_i=1}^n \left\{ Y_i(t_i=1) -
      \widehat{Y_i(t_i=0)} \right\},"/></p>
</div><p>where <img class="math" src="_images/math/64283d3d8caf93093b91aba9a61dbe26b5c18562.png" alt="t_i"/> is a binary explanatory variable defining the
treatment (<img class="math" src="_images/math/cc6ccc003db65691c9d0aebb91b2001e0d752d18.png" alt="t_i=1"/>) and control (<img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>) groups.
Variation in the simulations are due to uncertainty in simulating
<img class="math" src="_images/math/8056bf28681ea8573bf29bfeb3c72dffa40a2fa7.png" alt="\widehat{Y_i(t_i=0)}"/>, the counterfactual predicted value of
<img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> for observations in the treatment group, under the
assumption that everything stays the same except that the treatment
indicator is switched to <img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>.</p>
</li>
</ul>
</div>
<div class="section" id="id44">
<h3>Output Values<a class="headerlink" href="#id44" title="Permalink to this headline">¶</a></h3>
<p>The output of each Zelig command contains useful information which you
may view. For example, if you run
<tt class="docutils literal"><span class="pre">z.out</span> <span class="pre">&lt;-</span> <span class="pre">zelig(y</span> <span class="pre">~</span> <span class="pre">x,</span> <span class="pre">model</span> <span class="pre">=</span> <span class="pre">poisson,</span> <span class="pre">data)</span></tt>, then you may examine
the available information in <tt class="docutils literal"><span class="pre">z.out</span></tt> by using <tt class="docutils literal"><span class="pre">names(z.out)</span></tt>, see
the coefficients by using z.out$coefficients, and a default summary of
information through <tt class="docutils literal"><span class="pre">summary(z.out)</span></tt>.</p>
</div>
<div class="section" id="id45">
<h3>See also<a class="headerlink" href="#id45" title="Permalink to this headline">¶</a></h3>
<p>The poisson model is part of the stats package by . Advanced users may
wish to refer to <tt class="docutils literal"><span class="pre">help(glm)</span></tt> and <tt class="docutils literal"><span class="pre">help(family)</span></tt>.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="zelig-probit">
<h2>zelig-probit<a class="headerlink" href="#zelig-probit" title="Permalink to this headline">¶</a></h2>
<p>Probit Regression for Dichotomous Dependent Variables</p>
<p>Use probit regression to model binary dependent variables specified as a
function of a set of explanatory variables.</p>
<div class="section" id="id46">
<h3>Syntax<a class="headerlink" href="#id46" title="Permalink to this headline">¶</a></h3>
<p>With reference classes:</p>
<div class="highlight-r"><div class="highlight"><pre>z5 <span class="o">&lt;-</span> zprobit<span class="o">$</span>new<span class="p">()</span>
z5<span class="o">$</span>zelig<span class="p">(</span>Y <span class="o">~</span> X1 <span class="o">+</span> X <span class="o">~</span> X<span class="p">,</span> data <span class="o">=</span> mydata<span class="p">)</span>
z5<span class="o">$</span>setx<span class="p">()</span>
z5<span class="o">$</span>sim<span class="p">()</span>
</pre></div>
</div>
<p>With the Zelig 4 compatibility wrappers:</p>
<div class="highlight-r"><div class="highlight"><pre>z.out <span class="o">&lt;-</span> zelig<span class="p">(</span>Y <span class="o">~</span> X1 <span class="o">+</span> X2<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;probit&quot;</span><span class="p">,</span> data <span class="o">=</span> mydata<span class="p">)</span>
x.out <span class="o">&lt;-</span> setx<span class="p">(</span>z.out<span class="p">)</span>
s.out <span class="o">&lt;-</span> sim<span class="p">(</span>z.out<span class="p">,</span> x <span class="o">=</span> x.out<span class="p">,</span> x1 <span class="o">=</span> <span class="kc">NULL</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id47">
<h3>Example<a class="headerlink" href="#id47" title="Permalink to this headline">¶</a></h3>
<p>Attach the sample turnout dataset:</p>
<div class="highlight-r"><div class="highlight"><pre>data<span class="p">(</span>turnout<span class="p">)</span>
</pre></div>
</div>
<p>Estimate parameter values for the probit regression:</p>
<div class="highlight-r"><div class="highlight"><pre>z.out <span class="o">&lt;-</span> zelig<span class="p">(</span>vote <span class="o">~</span> race <span class="o">+</span> educate<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;probit&quot;</span><span class="p">,</span> data <span class="o">=</span> turnout<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## How to cite this model in Zelig:</span>
<span class="c">##   Kosuke Imai, Gary King, Olivia Lau. 2007.</span>
<span class="c">##   probit: Probit Regression for Dichotomous Dependent Variables</span>
<span class="c">##   in Kosuke Imai, Gary King, and Olivia Lau, &quot;Zelig: Everyone&#39;s Statistical Software,&quot;</span>
<span class="c">##   http://datascience.iq.harvard.edu/zelig</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>summary<span class="p">(</span>z.out<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## Model: 1</span>
<span class="c">## Call:  stats::glm(formula = vote ~ race + educate, family = binomial(&quot;probit&quot;),</span>
<span class="c">##     data = .)</span>
<span class="c">##</span>
<span class="c">## Coefficients:</span>
<span class="c">## (Intercept)    racewhite      educate</span>
<span class="c">##     -0.7259       0.2991       0.0971</span>
<span class="c">##</span>
<span class="c">## Degrees of Freedom: 1999 Total (i.e. Null);  1997 Residual</span>
<span class="c">## Null Deviance:       2270</span>
<span class="c">## Residual Deviance: 2140  AIC: 2140</span>
<span class="c">## Next step: Use &#39;setx&#39; method</span>
</pre></div>
</div>
<p>Set values for the explanatory variables to their default values.</p>
<div class="highlight-r"><div class="highlight"><pre>x.out <span class="o">&lt;-</span> setx<span class="p">(</span>z.out<span class="p">)</span>
</pre></div>
</div>
<p>Simulate quantities of interest from the posterior distribution.</p>
<div class="highlight-r"><div class="highlight"><pre>s.out <span class="o">&lt;-</span> sim<span class="p">(</span>z.out<span class="p">,</span> x <span class="o">=</span> x.out<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>summary<span class="p">(</span>s.out<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>plot<span class="p">(</span>s.out1<span class="p">)</span>
</pre></div>
</div>
<div class="figure">
<img alt="Zelig-probi" src="_images/Zelig-probit.png" />
<p class="caption">Zelig-probi</p>
</div>
</div>
<div class="section" id="id48">
<h3>Model<a class="headerlink" href="#id48" title="Permalink to this headline">¶</a></h3>
<p>Let <img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> be the observed binary dependent variable for
observation <img class="math" src="_images/math/a581f053bbfa5115f42c13094857cdd12a37ec49.png" alt="i"/> which takes the value of either 0 or 1.</p>
<ul>
<li><p class="first">The <em>stochastic component</em> is given by</p>
<div class="math">
<p><img src="_images/math/e6ab2177225a79f988ab416b0353405999e15789.png" alt="Y_i \; \sim \; \textrm{Bernoulli}(\pi_i),"/></p>
</div><p>where <img class="math" src="_images/math/204ad227887156eca0ea3882997e3c5d0703174b.png" alt="\pi_i=\Pr(Y_i=1)"/>.</p>
</li>
<li><p class="first">The <em>systematic component</em> is</p>
<div class="math">
<p><img src="_images/math/a8bd29a343890834661f63d7510931e96651bc8d.png" alt="\pi_i \; = \; \Phi (x_i \beta)"/></p>
</div><p>where <img class="math" src="_images/math/e4f08b55c6f99b472e0a295b96ff6487d545dfd0.png" alt="\Phi(\mu)"/> is the cumulative distribution function of
the Normal distribution with mean 0 and unit variance.</p>
</li>
</ul>
</div>
<div class="section" id="id49">
<h3>Quantities of Interest<a class="headerlink" href="#id49" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">The expected value (qi$ev) is a simulation of predicted probability
of success</p>
<div class="math">
<p><img src="_images/math/28b543f2a46c190d6f10c93b07f717ac6d15a5b4.png" alt="E(Y) = \pi_i = \Phi(x_i
  \beta),"/></p>
</div><p>given a draw of <img class="math" src="_images/math/8ce03f78ed945f2ef3dac87c8799b55b393527e7.png" alt="\beta"/> from its sampling distribution.</p>
</li>
<li><p class="first">The predicted value (qi$pr) is a draw from a Bernoulli distribution
with mean <img class="math" src="_images/math/916754f7e7de4247fa27c52f610948b4055311fe.png" alt="\pi_i"/>.</p>
</li>
<li><p class="first">The first difference (qi$fd) in expected values is defined as</p>
<div class="math">
<p><img src="_images/math/8f669920018c72d7f23a4ba843925381c4703f17.png" alt="\textrm{FD} = \Pr(Y = 1 \mid x_1) - \Pr(Y = 1 \mid x)."/></p>
</div></li>
<li><p class="first">The risk ratio (qi$rr) is defined as</p>
<div class="math">
<p><img src="_images/math/6a3b874e942e65340c5fd207b718ea58c330392c.png" alt="\textrm{RR} = \Pr(Y = 1 \mid x_1) / \Pr(Y = 1 \mid x)."/></p>
</div></li>
<li><p class="first">In conditional prediction models, the average expected treatment
effect (att.ev) for the treatment group is</p>
<div class="math">
<p><img src="_images/math/f120915a77efb3200aab141647a59f51df9b4611.png" alt="\frac{1}{\sum_{i=1}^n t_i}\sum_{i:t_i=1}^n \left\{ Y_i(t_i=1) -
      E[Y_i(t_i=0)] \right\},"/></p>
</div><p>where <img class="math" src="_images/math/64283d3d8caf93093b91aba9a61dbe26b5c18562.png" alt="t_i"/> is a binary explanatory variable defining the
treatment (<img class="math" src="_images/math/cc6ccc003db65691c9d0aebb91b2001e0d752d18.png" alt="t_i=1"/>) and control (<img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>) groups.
Variation in the simulations are due to uncertainty in simulating
<img class="math" src="_images/math/f658a3cf4cf830cd65eab505c530fb4796fea0ed.png" alt="E[Y_i(t_i=0)]"/>, the counterfactual expected value of
<img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> for observations in the treatment group, under the
assumption that everything stays the same except that the treatment
indicator is switched to <img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>.</p>
</li>
<li><p class="first">In conditional prediction models, the average predicted treatment
effect (att.pr) for the treatment group is</p>
<div class="math">
<p><img src="_images/math/da7e72f6d651b92ad0874d3b40cd633ac38f5663.png" alt="\frac{1}{\sum_{i=1}^n t_i}\sum_{i:t_i=1}^n \left\{ Y_i(t_i=1) -
      \widehat{Y_i(t_i=0)} \right\},"/></p>
</div><p>where <img class="math" src="_images/math/64283d3d8caf93093b91aba9a61dbe26b5c18562.png" alt="t_i"/> is a binary explanatory variable defining the
treatment (<img class="math" src="_images/math/cc6ccc003db65691c9d0aebb91b2001e0d752d18.png" alt="t_i=1"/>) and control (<img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>) groups.
Variation in the simulations are due to uncertainty in simulating
<img class="math" src="_images/math/8056bf28681ea8573bf29bfeb3c72dffa40a2fa7.png" alt="\widehat{Y_i(t_i=0)}"/>, the counterfactual predicted value of
<img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> for observations in the treatment group, under the
assumption that everything stays the same except that the treatment
indicator is switched to <img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>.</p>
</li>
</ul>
</div>
<div class="section" id="id50">
<h3>Output Values<a class="headerlink" href="#id50" title="Permalink to this headline">¶</a></h3>
<p>The output of each Zelig command contains useful information which you
may view. For example, if you run
<tt class="docutils literal"><span class="pre">z.out</span> <span class="pre">&lt;-</span> <span class="pre">zelig(y</span> <span class="pre">~</span> <span class="pre">x,</span> <span class="pre">model</span> <span class="pre">=</span> <span class="pre">probit,</span> <span class="pre">data)</span></tt>, then you may examine
the available information in <tt class="docutils literal"><span class="pre">z.out</span></tt> by using <tt class="docutils literal"><span class="pre">names(z.out)</span></tt>, see
the coefficients by using z.out$coefficients, and a default summary of
information through <tt class="docutils literal"><span class="pre">summary(z.out)</span></tt>.</p>
</div>
<div class="section" id="id51">
<h3>See also<a class="headerlink" href="#id51" title="Permalink to this headline">¶</a></h3>
<p>The probit model is part of the stats package by . Advanced users may
wish to refer to <tt class="docutils literal"><span class="pre">help(glm)</span></tt> and <tt class="docutils literal"><span class="pre">help(family)</span></tt>.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="zelig-relogit">
<h2>zelig-relogit<a class="headerlink" href="#zelig-relogit" title="Permalink to this headline">¶</a></h2>
<p>Rare Events Logistic Regression for Dichotomous Dependent Variables</p>
<p>The relogit procedure estimates the same model as standard logistic
regression (appropriate when you have a dichotomous dependent variable
and a set of explanatory variables; see ), but the estimates are
corrected for the bias that occurs when the sample is small or the
observed events are rare (i.e., if the dependent variable has many more
1s than 0s or the reverse). The relogit procedure also optionally uses
prior correction for case-control sampling designs.</p>
<div class="section" id="id52">
<h3>Syntax<a class="headerlink" href="#id52" title="Permalink to this headline">¶</a></h3>
<p>With reference classes:</p>
<div class="highlight-r"><div class="highlight"><pre>z5 <span class="o">&lt;-</span> zrelogit<span class="o">$</span>new<span class="p">()</span>
z5<span class="o">$</span>zelig<span class="p">(</span>Y <span class="o">~</span> X1 <span class="o">+</span> X2<span class="p">,</span> tau <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span>
                       case.control <span class="o">=</span> c<span class="p">(</span><span class="s">&quot;prior&quot;</span><span class="p">,</span> <span class="s">&quot;weighting&quot;</span><span class="p">),</span>
                       bias.correct <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> robust <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
                       data <span class="o">=</span> mydata<span class="p">,</span> <span class="kc">...</span><span class="p">)</span>
z5<span class="o">$</span>setx<span class="p">()</span>
z5<span class="o">$</span>sim<span class="p">()</span>
</pre></div>
</div>
<p>With the Zelig 4 compatibility wrappers:</p>
<div class="highlight-r"><div class="highlight"><pre>z.out <span class="o">&lt;-</span> zelig<span class="p">(</span>Y <span class="o">~</span> X1 <span class="o">+</span> X2<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;relogit&quot;</span><span class="p">,</span> tau <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span>
                       case.control <span class="o">=</span> c<span class="p">(</span><span class="s">&quot;prior&quot;</span><span class="p">,</span> <span class="s">&quot;weighting&quot;</span><span class="p">),</span>
                       bias.correct <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> robust <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
                       data <span class="o">=</span> mydata<span class="p">,</span> <span class="kc">...</span><span class="p">)</span>
x.out <span class="o">&lt;-</span> setx<span class="p">(</span>z.out<span class="p">)</span>
s.out <span class="o">&lt;-</span> sim<span class="p">(</span>z.out<span class="p">,</span> x <span class="o">=</span> x.out<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="arguments">
<h3>Arguments<a class="headerlink" href="#arguments" title="Permalink to this headline">¶</a></h3>
<p>The relogit procedure supports four optional arguments in addition to
the standard arguments for zelig(). You may additionally use:</p>
<ul class="simple">
<li>tau: a vector containing either one or two values for <img class="math" src="_images/math/d9e99c35d3632bb156b7aca0e93cd78a148a10e8.png" alt="\tau"/>,
the true population fraction of ones. Use, for example, tau = c(0.05,
0.1) to specify that the lower bound on tau is 0.05 and the upper
bound is 0.1. If left unspecified, only finite-sample bias correction
is performed, not case-control correction.</li>
<li>case.control: if tau is specified, choose a method to correct for
case-control sampling design: “prior” (default) or “weighting”.</li>
<li>bias.correct: a logical value of TRUE (default) or FALSE indicating
whether the intercept should be corrected for finite sample (rare
events) bias.</li>
</ul>
<p>Note that if tau = NULL, bias.correct = FALSE, the
relogit procedure performs a standard logistic regression without any
correction.</p>
</div>
<div class="section" id="example-1-one-tau-with-prior-correction-and-bias-correction">
<h3>Example 1: One Tau with Prior Correction and Bias Correction<a class="headerlink" href="#example-1-one-tau-with-prior-correction-and-bias-correction" title="Permalink to this headline">¶</a></h3>
<p>Due to memory and space considerations, the data used here are a sample
drawn from the full data set used in King and Zeng, 2001, The proportion
of militarized interstate conflicts to the absence of disputes is
<img class="math" src="_images/math/0476daae6e85154c40577131b46dfc345e403b50.png" alt="\tau = 1,042 / 303,772
\approx 0.00343"/>. To estimate the model,</p>
<div class="highlight-r"><div class="highlight"><pre>data<span class="p">(</span>mid<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>z.out1 <span class="o">&lt;-</span> zelig<span class="p">(</span>conflict <span class="o">~</span> major <span class="o">+</span> contig <span class="o">+</span> power <span class="o">+</span> maxdem <span class="o">+</span> mindem <span class="o">+</span> years<span class="p">,</span> data <span class="o">=</span> mid<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;relogit&quot;</span><span class="p">,</span> tau <span class="o">=</span> <span class="m">1042</span><span class="o">/</span><span class="m">303772</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## How to cite this model in Zelig:</span>
<span class="c">##   Kosuke Imai, Gary King, and Olivia Lau. 2014.</span>
<span class="c">##   relogit: Rare Events Logistic Regression for Dichotomous Dependent Variables</span>
<span class="c">##   in Kosuke Imai, Gary King, and Olivia Lau, &quot;Zelig: Everyone&#39;s Statistical Software,&quot;</span>
<span class="c">##   http://datascience.iq.harvard.edu/zelig</span>
</pre></div>
</div>
<p>Summarize the model output:</p>
<div class="highlight-r"><div class="highlight"><pre>summary<span class="p">(</span>z.out1<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## Model: 1</span>
<span class="c">## Call:  relogit(formula = cbind(conflict, 1 - conflict) ~ major + contig +</span>
<span class="c">##     power + maxdem + mindem + years, data = ., tau = 0.00343020423212146,</span>
<span class="c">##     bias.correct = TRUE, case.control = &quot;prior&quot;)</span>
<span class="c">##</span>
<span class="c">## Coefficients:</span>
<span class="c">## (Intercept)        major       contig        power       maxdem</span>
<span class="c">##     -7.5084       2.4320       4.1080       1.0536       0.0480</span>
<span class="c">##      mindem        years</span>
<span class="c">##     -0.0641      -0.0629</span>
<span class="c">##</span>
<span class="c">## Degrees of Freedom: 3125 Total (i.e. Null);  3119 Residual</span>
<span class="c">## Null Deviance:       3980</span>
<span class="c">## Residual Deviance: 1870  AIC: 1880</span>
<span class="c">## Next step: Use &#39;setx&#39; method</span>
</pre></div>
</div>
<p>Set the explanatory variables to their means:</p>
<div class="highlight-r"><div class="highlight"><pre>x.out1 <span class="o">&lt;-</span> setx<span class="p">(</span>z.out1<span class="p">)</span>
</pre></div>
</div>
<p>Simulate quantities of interest:</p>
<div class="highlight-r"><div class="highlight"><pre>s.out1 <span class="o">&lt;-</span> sim<span class="p">(</span>z.out1<span class="p">,</span> x <span class="o">=</span> x.out1<span class="p">)</span>
summary<span class="p">(</span>s.out1<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">##</span>
<span class="c">##  sim x :</span>
<span class="c">##  -----</span>
<span class="c">## ev</span>
<span class="c">##        mean        sd      50%     2.5%    97.5%</span>
<span class="c">## [1,] 0.0024 0.0001529 0.002389 0.002118 0.002728</span>
<span class="c">## pv</span>
<span class="c">##          0     1</span>
<span class="c">## [1,] 0.997 0.003</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>plot<span class="p">(</span>s.out1<span class="p">)</span>
</pre></div>
</div>
<div class="figure">
<img alt="Zelig-relogit" src="_images/Zelig-relogit.png" />
<p class="caption">Zelig-relogit</p>
</div>
</div>
<div class="section" id="example-2-one-tau-with-weighting-robust-standard-errors-and-bias-correction">
<h3>Example 2: One Tau with Weighting, Robust Standard Errors, and Bias Correction<a class="headerlink" href="#example-2-one-tau-with-weighting-robust-standard-errors-and-bias-correction" title="Permalink to this headline">¶</a></h3>
<p>Suppose that we wish to perform case control correction using weighting
(rather than the default prior correction). To estimate the model:</p>
<div class="highlight-r"><div class="highlight"><pre>z.out2 <span class="o">&lt;-</span> zelig<span class="p">(</span>conflict <span class="o">~</span> major <span class="o">+</span> contig <span class="o">+</span> power <span class="o">+</span> maxdem <span class="o">+</span> mindem <span class="o">+</span> years<span class="p">,</span> data <span class="o">=</span> mid<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;relogit&quot;</span><span class="p">,</span> tau <span class="o">=</span> <span class="m">1042</span><span class="o">/</span><span class="m">303772</span><span class="p">,</span> case.control <span class="o">=</span> <span class="s">&quot;weighting&quot;</span><span class="p">,</span> robust <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## Error: unused argument (robust = TRUE)</span>
</pre></div>
</div>
<p>Summarize the model output:</p>
<div class="highlight-r"><div class="highlight"><pre>summary<span class="p">(</span>z.out2<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## Model: 1</span>
<span class="c">## Call:</span>
<span class="c">## stats::lm(formula = unem ~ gdp + trade + capmob + as.factor(country),</span>
<span class="c">##     data = .)</span>
<span class="c">##</span>
<span class="c">## Coefficients:</span>
<span class="c">##                      (Intercept)                               gdp</span>
<span class="c">##                           -5.843                            -0.110</span>
<span class="c">##                            trade                            capmob</span>
<span class="c">##                            0.144                             0.815</span>
<span class="c">##        as.factor(country)Belgium          as.factor(country)Canada</span>
<span class="c">##                           -1.599                             6.759</span>
<span class="c">##        as.factor(country)Denmark         as.factor(country)Finland</span>
<span class="c">##                            4.311                             4.810</span>
<span class="c">##         as.factor(country)France           as.factor(country)Italy</span>
<span class="c">##                            6.905                             9.290</span>
<span class="c">##          as.factor(country)Japan     as.factor(country)Netherlands</span>
<span class="c">##                            5.459                            -1.459</span>
<span class="c">##         as.factor(country)Norway          as.factor(country)Sweden</span>
<span class="c">##                           -2.754                             0.925</span>
<span class="c">## as.factor(country)United Kingdom   as.factor(country)United States</span>
<span class="c">##                            5.601                            10.066</span>
<span class="c">##   as.factor(country)West Germany</span>
<span class="c">##                            3.364</span>
<span class="c">##</span>
<span class="c">## Next step: Use &#39;setx&#39; method</span>
</pre></div>
</div>
<p>Set the explanatory variables to their means:</p>
<div class="highlight-r"><div class="highlight"><pre>x.out2 <span class="o">&lt;-</span> setx<span class="p">(</span>z.out2<span class="p">)</span>
</pre></div>
</div>
<p>Simulate quantities of interest:</p>
<div class="highlight-r"><div class="highlight"><pre>s.out2 <span class="o">&lt;-</span> sim<span class="p">(</span>z.out2<span class="p">,</span> x <span class="o">=</span> x.out2<span class="p">)</span>
summary<span class="p">(</span>s.out2<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">##</span>
<span class="c">##  sim x :</span>
<span class="c">##  -----</span>
<span class="c">## ev</span>
<span class="c">##    mean     sd   50%  2.5% 97.5%</span>
<span class="c">## 1 4.692 0.3945 4.695 3.919 5.457</span>
<span class="c">## pv</span>
<span class="c">##    mean     sd   50%  2.5% 97.5%</span>
<span class="c">## 1 4.692 0.3945 4.695 3.919 5.457</span>
</pre></div>
</div>
</div>
<div class="section" id="example-3-two-taus-with-bias-correction-and-prior-correction">
<h3>Example 3: Two Taus with Bias Correction and Prior Correction<a class="headerlink" href="#example-3-two-taus-with-bias-correction-and-prior-correction" title="Permalink to this headline">¶</a></h3>
<p>Suppose that we did not know that <img class="math" src="_images/math/3ea6d30492110055362e739a5b4776f93c6f1814.png" alt="\tau \approx 0.00343"/>, but only
that it was somewhere between <img class="math" src="_images/math/501e197d9ac2263e0c31dbecb1a332a39f7f0c84.png" alt="(0.002, 0.005)"/>. To estimate a
model with a range of feasible estimates for <img class="math" src="_images/math/d9e99c35d3632bb156b7aca0e93cd78a148a10e8.png" alt="\tau"/> (using the
default prior correction method for case control correction):</p>
<div class="highlight-r"><div class="highlight"><pre>z.out2 <span class="o">&lt;-</span> zelig<span class="p">(</span>conflict <span class="o">~</span> major <span class="o">+</span> contig <span class="o">+</span> power <span class="o">+</span> maxdem <span class="o">+</span> mindem <span class="o">+</span> years<span class="p">,</span> data <span class="o">=</span> mid<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;relogit&quot;</span><span class="p">,</span> tau <span class="o">=</span> c<span class="p">(</span><span class="m">0.002</span><span class="p">,</span> <span class="m">0.005</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## How to cite this model in Zelig:</span>
<span class="c">##   Kosuke Imai, Gary King, and Olivia Lau. 2014.</span>
<span class="c">##   relogit: Rare Events Logistic Regression for Dichotomous Dependent Variables</span>
<span class="c">##   in Kosuke Imai, Gary King, and Olivia Lau, &quot;Zelig: Everyone&#39;s Statistical Software,&quot;</span>
<span class="c">##   http://datascience.iq.harvard.edu/zelig</span>
</pre></div>
</div>
<p>Summarize the model output:</p>
<div class="highlight-r"><div class="highlight"><pre>z.out2
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## Model: 1$lower.estimate</span>
<span class="c">##</span>
<span class="c">## Call:  (function (formula, data = sys.parent(), tau = NULL, bias.correct = TRUE,</span>
<span class="c">##     case.control = &quot;prior&quot;, ...)</span>
<span class="c">## {</span>
<span class="c">##     mf &lt;- match.call()</span>
<span class="c">##     mf$tau &lt;- mf$bias.correct &lt;- mf$case.control &lt;- NULL</span>
<span class="c">##     if (!is.null(tau)) {</span>
<span class="c">##         tau &lt;- unique(tau)</span>
<span class="c">##         if (length(case.control) &gt; 1)</span>
<span class="c">##             stop(&quot;You can only choose one option for case control correction.&quot;)</span>
<span class="c">##         ck1 &lt;- grep(&quot;p&quot;, case.control)</span>
<span class="c">##         ck2 &lt;- grep(&quot;w&quot;, case.control)</span>
<span class="c">##         if (length(ck1) == 0 &amp; length(ck2) == 0)</span>
<span class="c">##             stop(&quot;choose either case.control = \&quot;prior\&quot; &quot;, &quot;or case.control = \&quot;weighting\&quot;&quot;)</span>
<span class="c">##         if (length(ck2) == 0)</span>
<span class="c">##             weighting &lt;- FALSE</span>
<span class="c">##         else weighting &lt;- TRUE</span>
<span class="c">##     }</span>
<span class="c">##     else weighting &lt;- FALSE</span>
<span class="c">##     if (length(tau) &gt; 2)</span>
<span class="c">##         stop(&quot;tau must be a vector of length less than or equal to 2&quot;)</span>
<span class="c">##     else if (length(tau) == 2) {</span>
<span class="c">##         mf[[1]] &lt;- relogit</span>
<span class="c">##         res &lt;- list()</span>
<span class="c">##         mf$tau &lt;- min(tau)</span>
<span class="c">##         res$lower.estimate &lt;- eval(as.call(mf), parent.frame())</span>
<span class="c">##         mf$tau &lt;- max(tau)</span>
<span class="c">##         res$upper.estimate &lt;- eval(as.call(mf), parent.frame())</span>
<span class="c">##         res$formula &lt;- formula</span>
<span class="c">##         class(res) &lt;- c(&quot;Relogit2&quot;, &quot;Relogit&quot;)</span>
<span class="c">##         return(res)</span>
<span class="c">##     }</span>
<span class="c">##     else {</span>
<span class="c">##         mf[[1]] &lt;- glm</span>
<span class="c">##         mf$family &lt;- binomial(link = &quot;logit&quot;)</span>
<span class="c">##         y2 &lt;- model.response(model.frame(mf$formula, data))</span>
<span class="c">##         if (is.matrix(y2))</span>
<span class="c">##             y &lt;- y2[, 1]</span>
<span class="c">##         else y &lt;- y2</span>
<span class="c">##         ybar &lt;- mean(y)</span>
<span class="c">##         if (weighting) {</span>
<span class="c">##             w1 &lt;- tau/ybar</span>
<span class="c">##             w0 &lt;- (1 - tau)/(1 - ybar)</span>
<span class="c">##             wi &lt;- w1 * y + w0 * (1 - y)</span>
<span class="c">##             mf$weights &lt;- wi</span>
<span class="c">##         }</span>
<span class="c">##         res &lt;- eval(as.call(mf), parent.frame())</span>
<span class="c">##         res$call &lt;- match.call(expand.dots = TRUE)</span>
<span class="c">##         res$tau &lt;- tau</span>
<span class="c">##         X &lt;- model.matrix(res)</span>
<span class="c">##         if (bias.correct) {</span>
<span class="c">##             pihat &lt;- fitted(res)</span>
<span class="c">##             if (is.null(tau))</span>
<span class="c">##                 wi &lt;- rep(1, length(y))</span>
<span class="c">##             else if (weighting)</span>
<span class="c">##                 res$weighting &lt;- TRUE</span>
<span class="c">##             else {</span>
<span class="c">##                 w1 &lt;- tau/ybar</span>
<span class="c">##                 w0 &lt;- (1 - tau)/(1 - ybar)</span>
<span class="c">##                 wi &lt;- w1 * y + w0 * (1 - y)</span>
<span class="c">##                 res$weighting &lt;- FALSE</span>
<span class="c">##             }</span>
<span class="c">##             W &lt;- pihat * (1 - pihat) * wi</span>
<span class="c">##             Qdiag &lt;- lm.influence(lm(y ~ X - 1, weights = W))$hat/W</span>
<span class="c">##             if (is.null(tau))</span>
<span class="c">##                 xi &lt;- 0.5 * Qdiag * (2 * pihat - 1)</span>
<span class="c">##             else xi &lt;- 0.5 * Qdiag * ((1 + w0) * pihat - w0)</span>
<span class="c">##             res$coefficients &lt;- res$coefficients - lm(xi ~ X -</span>
<span class="c">##                 1, weights = W)$coefficients</span>
<span class="c">##             res$bias.correct &lt;- TRUE</span>
<span class="c">##         }</span>
<span class="c">##         else res$bias.correct &lt;- FALSE</span>
<span class="c">##         if (!is.null(tau) &amp; !weighting) {</span>
<span class="c">##             if (tau &lt;= 0 || tau &gt;= 1)</span>
<span class="c">##                 stop(&quot;\ntau needs to be between 0 and 1.\n&quot;)</span>
<span class="c">##             res$coefficients[&quot;(Intercept)&quot;] &lt;- res$coefficients[&quot;(Intercept)&quot;] -</span>
<span class="c">##                 log(((1 - tau)/tau) * (ybar/(1 - ybar)))</span>
<span class="c">##             res$prior.correct &lt;- TRUE</span>
<span class="c">##             res$weighting &lt;- FALSE</span>
<span class="c">##         }</span>
<span class="c">##         else res$prior.correct &lt;- FALSE</span>
<span class="c">##         if (is.null(res$weighting))</span>
<span class="c">##             res$weighting &lt;- FALSE</span>
<span class="c">##         res$linear.predictors &lt;- t(res$coefficients) %*% t(X)</span>
<span class="c">##         res$fitted.values &lt;- 1/(1 + exp(-res$linear.predictors))</span>
<span class="c">##         res$zelig &lt;- &quot;Relogit&quot;</span>
<span class="c">##         class(res) &lt;- c(&quot;Relogit&quot;, &quot;glm&quot;)</span>
<span class="c">##         return(res)</span>
<span class="c">##     }</span>
<span class="c">## })(formula = cbind(conflict, 1 - conflict) ~ major + contig +</span>
<span class="c">##     power + maxdem + mindem + years, data = ., tau = 0.002)</span>
<span class="c">##</span>
<span class="c">## Coefficients:</span>
<span class="c">## (Intercept)        major       contig        power       maxdem</span>
<span class="c">##     -8.0492       2.4320       4.1079       1.0536       0.0480</span>
<span class="c">##      mindem        years</span>
<span class="c">##     -0.0641      -0.0629</span>
<span class="c">##</span>
<span class="c">## Degrees of Freedom: 3125 Total (i.e. Null);  3119 Residual</span>
<span class="c">## Null Deviance:       3980</span>
<span class="c">## Residual Deviance: 1870  AIC: 1880</span>
<span class="c">##</span>
<span class="c">## $upper.estimate</span>
<span class="c">##</span>
<span class="c">## Call:  (function (formula, data = sys.parent(), tau = NULL, bias.correct = TRUE,</span>
<span class="c">##     case.control = &quot;prior&quot;, ...)</span>
<span class="c">## {</span>
<span class="c">##     mf &lt;- match.call()</span>
<span class="c">##     mf$tau &lt;- mf$bias.correct &lt;- mf$case.control &lt;- NULL</span>
<span class="c">##     if (!is.null(tau)) {</span>
<span class="c">##         tau &lt;- unique(tau)</span>
<span class="c">##         if (length(case.control) &gt; 1)</span>
<span class="c">##             stop(&quot;You can only choose one option for case control correction.&quot;)</span>
<span class="c">##         ck1 &lt;- grep(&quot;p&quot;, case.control)</span>
<span class="c">##         ck2 &lt;- grep(&quot;w&quot;, case.control)</span>
<span class="c">##         if (length(ck1) == 0 &amp; length(ck2) == 0)</span>
<span class="c">##             stop(&quot;choose either case.control = \&quot;prior\&quot; &quot;, &quot;or case.control = \&quot;weighting\&quot;&quot;)</span>
<span class="c">##         if (length(ck2) == 0)</span>
<span class="c">##             weighting &lt;- FALSE</span>
<span class="c">##         else weighting &lt;- TRUE</span>
<span class="c">##     }</span>
<span class="c">##     else weighting &lt;- FALSE</span>
<span class="c">##     if (length(tau) &gt; 2)</span>
<span class="c">##         stop(&quot;tau must be a vector of length less than or equal to 2&quot;)</span>
<span class="c">##     else if (length(tau) == 2) {</span>
<span class="c">##         mf[[1]] &lt;- relogit</span>
<span class="c">##         res &lt;- list()</span>
<span class="c">##         mf$tau &lt;- min(tau)</span>
<span class="c">##         res$lower.estimate &lt;- eval(as.call(mf), parent.frame())</span>
<span class="c">##         mf$tau &lt;- max(tau)</span>
<span class="c">##         res$upper.estimate &lt;- eval(as.call(mf), parent.frame())</span>
<span class="c">##         res$formula &lt;- formula</span>
<span class="c">##         class(res) &lt;- c(&quot;Relogit2&quot;, &quot;Relogit&quot;)</span>
<span class="c">##         return(res)</span>
<span class="c">##     }</span>
<span class="c">##     else {</span>
<span class="c">##         mf[[1]] &lt;- glm</span>
<span class="c">##         mf$family &lt;- binomial(link = &quot;logit&quot;)</span>
<span class="c">##         y2 &lt;- model.response(model.frame(mf$formula, data))</span>
<span class="c">##         if (is.matrix(y2))</span>
<span class="c">##             y &lt;- y2[, 1]</span>
<span class="c">##         else y &lt;- y2</span>
<span class="c">##         ybar &lt;- mean(y)</span>
<span class="c">##         if (weighting) {</span>
<span class="c">##             w1 &lt;- tau/ybar</span>
<span class="c">##             w0 &lt;- (1 - tau)/(1 - ybar)</span>
<span class="c">##             wi &lt;- w1 * y + w0 * (1 - y)</span>
<span class="c">##             mf$weights &lt;- wi</span>
<span class="c">##         }</span>
<span class="c">##         res &lt;- eval(as.call(mf), parent.frame())</span>
<span class="c">##         res$call &lt;- match.call(expand.dots = TRUE)</span>
<span class="c">##         res$tau &lt;- tau</span>
<span class="c">##         X &lt;- model.matrix(res)</span>
<span class="c">##         if (bias.correct) {</span>
<span class="c">##             pihat &lt;- fitted(res)</span>
<span class="c">##             if (is.null(tau))</span>
<span class="c">##                 wi &lt;- rep(1, length(y))</span>
<span class="c">##             else if (weighting)</span>
<span class="c">##                 res$weighting &lt;- TRUE</span>
<span class="c">##             else {</span>
<span class="c">##                 w1 &lt;- tau/ybar</span>
<span class="c">##                 w0 &lt;- (1 - tau)/(1 - ybar)</span>
<span class="c">##                 wi &lt;- w1 * y + w0 * (1 - y)</span>
<span class="c">##                 res$weighting &lt;- FALSE</span>
<span class="c">##             }</span>
<span class="c">##             W &lt;- pihat * (1 - pihat) * wi</span>
<span class="c">##             Qdiag &lt;- lm.influence(lm(y ~ X - 1, weights = W))$hat/W</span>
<span class="c">##             if (is.null(tau))</span>
<span class="c">##                 xi &lt;- 0.5 * Qdiag * (2 * pihat - 1)</span>
<span class="c">##             else xi &lt;- 0.5 * Qdiag * ((1 + w0) * pihat - w0)</span>
<span class="c">##             res$coefficients &lt;- res$coefficients - lm(xi ~ X -</span>
<span class="c">##                 1, weights = W)$coefficients</span>
<span class="c">##             res$bias.correct &lt;- TRUE</span>
<span class="c">##         }</span>
<span class="c">##         else res$bias.correct &lt;- FALSE</span>
<span class="c">##         if (!is.null(tau) &amp; !weighting) {</span>
<span class="c">##             if (tau &lt;= 0 || tau &gt;= 1)</span>
<span class="c">##                 stop(&quot;\ntau needs to be between 0 and 1.\n&quot;)</span>
<span class="c">##             res$coefficients[&quot;(Intercept)&quot;] &lt;- res$coefficients[&quot;(Intercept)&quot;] -</span>
<span class="c">##                 log(((1 - tau)/tau) * (ybar/(1 - ybar)))</span>
<span class="c">##             res$prior.correct &lt;- TRUE</span>
<span class="c">##             res$weighting &lt;- FALSE</span>
<span class="c">##         }</span>
<span class="c">##         else res$prior.correct &lt;- FALSE</span>
<span class="c">##         if (is.null(res$weighting))</span>
<span class="c">##             res$weighting &lt;- FALSE</span>
<span class="c">##         res$linear.predictors &lt;- t(res$coefficients) %*% t(X)</span>
<span class="c">##         res$fitted.values &lt;- 1/(1 + exp(-res$linear.predictors))</span>
<span class="c">##         res$zelig &lt;- &quot;Relogit&quot;</span>
<span class="c">##         class(res) &lt;- c(&quot;Relogit&quot;, &quot;glm&quot;)</span>
<span class="c">##         return(res)</span>
<span class="c">##     }</span>
<span class="c">## })(formula = cbind(conflict, 1 - conflict) ~ major + contig +</span>
<span class="c">##     power + maxdem + mindem + years, data = ., tau = 0.005)</span>
<span class="c">##</span>
<span class="c">## Coefficients:</span>
<span class="c">## (Intercept)        major       contig        power       maxdem</span>
<span class="c">##     -7.1300       2.4320       4.1080       1.0536       0.0480</span>
<span class="c">##      mindem        years</span>
<span class="c">##     -0.0641      -0.0629</span>
<span class="c">##</span>
<span class="c">## Degrees of Freedom: 3125 Total (i.e. Null);  3119 Residual</span>
<span class="c">## Null Deviance:       3980</span>
<span class="c">## Residual Deviance: 1870  AIC: 1880</span>
<span class="c">##</span>
<span class="c">## $formula</span>
<span class="c">## cbind(conflict, 1 - conflict) ~ major + contig + power + maxdem +</span>
<span class="c">##     mindem + years</span>
<span class="c">## &lt;environment: 0x7fb0a26eb8a8&gt;</span>
<span class="c">##</span>
<span class="c">## attr(,&quot;class&quot;)</span>
<span class="c">## [1] &quot;Relogit2&quot; &quot;Relogit&quot;</span>
<span class="c">## Next step: Use &#39;setx&#39; method</span>
</pre></div>
</div>
<p>Set the explanatory variables to their means:</p>
<div class="highlight-r"><div class="highlight"><pre>x.out2 <span class="o">&lt;-</span> setx<span class="p">(</span>z.out2<span class="p">)</span>
</pre></div>
</div>
<p>Simulate quantities of interest:</p>
<div class="highlight-r"><div class="highlight"><pre>s.out <span class="o">&lt;-</span> sim<span class="p">(</span>z.out2<span class="p">,</span> x <span class="o">=</span> x.out2<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## Error: no applicable method for &#39;vcov&#39; applied to an object of class</span>
<span class="c">## &quot;c(&#39;Relogit2&#39;, &#39;Relogit&#39;)&quot;</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>summary<span class="p">(</span>s.out2<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">##</span>
<span class="c">##  sim x :</span>
<span class="c">##  -----</span>
<span class="c">## ev</span>
<span class="c">##    mean     sd   50%  2.5% 97.5%</span>
<span class="c">## 1 4.692 0.3945 4.695 3.919 5.457</span>
<span class="c">## pv</span>
<span class="c">##    mean     sd   50%  2.5% 97.5%</span>
<span class="c">## 1 4.692 0.3945 4.695 3.919 5.457</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>plot<span class="p">(</span>s.out2<span class="p">)</span>
</pre></div>
</div>
<div class="figure">
<img alt="" src="_images/unnamed-chunk-18.png" />
</div>
<p>The cost of giving a range of values for <img class="math" src="_images/math/d9e99c35d3632bb156b7aca0e93cd78a148a10e8.png" alt="\tau"/> is that point
estimates are not available for quantities of interest. Instead,
quantities are presented as confidence intervals with significance less
than or equal to a specified level (e.g., at least 95% of the
simulations are contained in the nominal 95% confidence interval).</p>
</div>
<div class="section" id="id53">
<h3>Model<a class="headerlink" href="#id53" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Like the standard logistic regression, the <em>stochastic component</em> for
the rare events logistic regression is:</p>
<div class="math">
<p><img src="_images/math/e6ab2177225a79f988ab416b0353405999e15789.png" alt="Y_i \; \sim \; \textrm{Bernoulli}(\pi_i),"/></p>
</div><p>where <img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> is the binary dependent variable, and takes a value
of either 0 or 1.</p>
</li>
<li><p class="first">The <em>systematic component</em> is:</p>
<div class="math">
<p><img src="_images/math/59cf11e927045c99a310cdaa15d32bc7cfacb160.png" alt="\pi_i \; = \; \frac{1}{1 + \exp(-x_i \beta)}."/></p>
</div></li>
<li><p class="first">If the sample is generated via a case-control (or choice-based)
design, such as when drawing all events (or “cases”) and a sample
from the non-events (or “controls”) and going backwards to collect
the explanatory variables, you must correct for selecting on the
dependent variable. While the slope coefficients are approximately
unbiased, the constant term may be significantly biased. Zelig has
two methods for case control correction:</p>
<ol class="arabic">
<li><p class="first">The “prior correction” method adjusts the intercept term. Let
<img class="math" src="_images/math/d9e99c35d3632bb156b7aca0e93cd78a148a10e8.png" alt="\tau"/> be the true population fraction of events,
<img class="math" src="_images/math/eff822074d94619ea86dcccd9f1e410360a711c3.png" alt="\bar{y}"/> the fraction of events in the sample, and
<img class="math" src="_images/math/7f7c57d3dd82a0c7d00c82f510f14400a1cc4435.png" alt="\hat{\beta_0}"/> the uncorrected intercept term. The
corrected intercept <img class="math" src="_images/math/90acdaf850915294d7ef3bdc540005ee22197903.png" alt="\beta_0"/> is:</p>
<div class="math">
<p><img src="_images/math/b3f4429515a74871c61649fe2b350bfe49da7123.png" alt="\beta =  \hat{\beta_0} - \ln \left[ \bigg( \frac{1 - \tau}{\tau}
  \bigg) \bigg( \frac{\bar{y}}{1 - \bar{y}} \bigg) \right]."/></p>
</div></li>
<li><p class="first">The “weighting” method performs a weighted logistic regression to
correct for a case-control sampling design. Let the 1 subscript
denote observations for which the dependent variable is observed
as a 1, and the 0 subscript denote observations for which the
dependent variable is observed as a 0. Then the vector of weights
<img class="math" src="_images/math/b4e1bc8e2dfd2c26158273aef285b08a816f960a.png" alt="w_i"/></p>
<div class="math">
<p><img src="_images/math/50c4c6190b58f44612c516cb9e9ac3e6420f5b9c.png" alt="\begin{aligned}
w_1 &amp;=&amp; \frac{\tau}{\bar{y}} \\
w_0 &amp;=&amp; \frac{(1 - \tau)}{(1 - \bar{y})} \\
w_i &amp;=&amp; w_1 Y_i + w_0 (1 - Y_i)\end{aligned}"/></p>
</div></li>
</ol>
<p>If <img class="math" src="_images/math/d9e99c35d3632bb156b7aca0e93cd78a148a10e8.png" alt="\tau"/> is unknown, you may alternatively specify an upper
and lower bound for the possible range of <img class="math" src="_images/math/d9e99c35d3632bb156b7aca0e93cd78a148a10e8.png" alt="\tau"/>. In this case,
the relogit procedure uses “robust Bayesian” methods to generate a
confidence interval (rather than a point estimate) for each quantity
of interest. The nominal coverage of the confidence interval is at
least as great as the actual coverage.</p>
</li>
<li><p class="first">By default, estimates of the the coefficients <img class="math" src="_images/math/8ce03f78ed945f2ef3dac87c8799b55b393527e7.png" alt="\beta"/> are
bias-corrected to account for finite sample or rare events bias. In
addition, quantities of interest, such as predicted probabilities,
are also corrected of rare-events bias. If <img class="math" src="_images/math/d8af2dda6c66ca3f8936a4c3f429636ab9950ddc.png" alt="\widehat{\beta}"/>
are the uncorrected logit coefficients and
bias(<img class="math" src="_images/math/d8af2dda6c66ca3f8936a4c3f429636ab9950ddc.png" alt="\widehat{\beta}"/>) is the bias term, the corrected
coefficients <img class="math" src="_images/math/4024b5e1e832a4e71c716cc1f7383be57826b0b0.png" alt="\tilde{\beta}"/> are</p>
<div class="math">
<p><img src="_images/math/321de0f40e0675fea03bff2a20ea559cb463d6ea.png" alt="\widehat{\beta} - \textrm{bias}(\widehat{\beta}) = \tilde{\beta}"/></p>
</div><p>The bias term is</p>
<div class="math">
<p><img src="_images/math/b0553d525251be7ec5507573c00d1e00eee0e435.png" alt="\textrm{bias}(\widehat{\beta}) = (X'WX)^{-1} X'W \xi"/></p>
</div><p>where</p>
<div class="math">
<p><img src="_images/math/ffeae8f68e041844fe15a30663badb58587cb67d.png" alt="\begin{aligned}
\xi_i &amp;=&amp; 0.5 Q_{ii} \Big( (1 + w-1)\widehat{\pi}_i - w_1 \Big) \\
Q &amp;=&amp; X(X'WX)^{-1} X' \\
W = \textrm{diag}\{\widehat{\pi}_i (1 - \widehat{\pi}_i) w_i\}\end{aligned}"/></p>
</div><p>where <img class="math" src="_images/math/b4e1bc8e2dfd2c26158273aef285b08a816f960a.png" alt="w_i"/> and <img class="math" src="_images/math/ee71d9a60992887aa4b7a1e010886633661a7ada.png" alt="w_1"/> are given in the “weighting”
section above.</p>
</li>
</ul>
</div>
<div class="section" id="id54">
<h3>Quantities of Interest<a class="headerlink" href="#id54" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">For either one or no <img class="math" src="_images/math/d9e99c35d3632bb156b7aca0e93cd78a148a10e8.png" alt="\tau"/>:</p>
<ul>
<li><p class="first">The expected values (qi$ev) for the rare events logit are
simulations of the predicted probability</p>
<div class="math">
<p><img src="_images/math/fd2856bc7fec152ef785c927c85393b0f70596ac.png" alt="E(Y) = \pi_i =
    \frac{1}{1 + \exp(-x_i \beta)},"/></p>
</div><p>given draws of <img class="math" src="_images/math/8ce03f78ed945f2ef3dac87c8799b55b393527e7.png" alt="\beta"/> from its posterior.</p>
</li>
<li><p class="first">The predicted value (qi$pr) is a draw from a binomial distribution
with mean equal to the simulated <img class="math" src="_images/math/916754f7e7de4247fa27c52f610948b4055311fe.png" alt="\pi_i"/>.</p>
</li>
<li><p class="first">The first difference (qi$fd) is defined as</p>
<div class="math">
<p><img src="_images/math/9b4dec5fa18c43963e1e8ce022f3dce869dc2403.png" alt="\textrm{FD} = \Pr(Y = 1 \mid x_1, \tau) - \Pr(Y = 1 \mid x, \tau)."/></p>
</div></li>
<li><p class="first">The risk ratio (qi$rr) is defined as</p>
<div class="math">
<p><img src="_images/math/840169782526b263d8745f139e906c4cbb6be812.png" alt="\textrm{RR} = \Pr(Y = 1 \mid x_1, \tau) \ / \ \Pr(Y = 1 \mid x, \tau)."/></p>
</div></li>
</ul>
</li>
<li><p class="first">For a range of <img class="math" src="_images/math/d9e99c35d3632bb156b7aca0e93cd78a148a10e8.png" alt="\tau"/> defined by <img class="math" src="_images/math/9c8d376f26cfc87ab8a0956d91e826558ef973d6.png" alt="[\tau_1, \tau_2]"/>, each
of the quantities of interest are <img class="math" src="_images/math/4f7a2e44ef1042deffae3520085171846386e918.png" alt="n \times 2"/> matrices, which
report the lower and upper bounds, respectively, for a confidence
interval with nominal coverage at least as great as the actual
coverage. At worst, these bounds are conservative estimates for the
likely range for each quantity of interest. Please refer to for the
specific method of calculating bounded quantities of interest.</p>
</li>
<li><p class="first">In conditional prediction models, the average expected treatment
effect (att.ev) for the treatment group is</p>
<div class="math">
<p><img src="_images/math/f120915a77efb3200aab141647a59f51df9b4611.png" alt="\frac{1}{\sum_{i=1}^n t_i}\sum_{i:t_i=1}^n \left\{ Y_i(t_i=1) -
      E[Y_i(t_i=0)] \right\},"/></p>
</div><p>where <img class="math" src="_images/math/64283d3d8caf93093b91aba9a61dbe26b5c18562.png" alt="t_i"/> is a binary explanatory variable defining the
treatment (<img class="math" src="_images/math/cc6ccc003db65691c9d0aebb91b2001e0d752d18.png" alt="t_i=1"/>) and control (<img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>) groups.
Variation in the simulations are due to uncertainty in simulating
<img class="math" src="_images/math/f658a3cf4cf830cd65eab505c530fb4796fea0ed.png" alt="E[Y_i(t_i=0)]"/>, the counterfactual expected value of
<img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> for observations in the treatment group, under the
assumption that everything stays the same except that the treatment
indicator is switched to <img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>.</p>
</li>
<li><p class="first">In conditional prediction models, the average predicted treatment
effect (att.pr) for the treatment group is</p>
<div class="math">
<p><img src="_images/math/da7e72f6d651b92ad0874d3b40cd633ac38f5663.png" alt="\frac{1}{\sum_{i=1}^n t_i}\sum_{i:t_i=1}^n \left\{ Y_i(t_i=1) -
      \widehat{Y_i(t_i=0)} \right\},"/></p>
</div><p>where <img class="math" src="_images/math/64283d3d8caf93093b91aba9a61dbe26b5c18562.png" alt="t_i"/> is a binary explanatory variable defining the
treatment (<img class="math" src="_images/math/cc6ccc003db65691c9d0aebb91b2001e0d752d18.png" alt="t_i=1"/>) and control (<img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>) groups.
Variation in the simulations are due to uncertainty in simulating
<img class="math" src="_images/math/8056bf28681ea8573bf29bfeb3c72dffa40a2fa7.png" alt="\widehat{Y_i(t_i=0)}"/>, the counterfactual predicted value of
<img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> for observations in the treatment group, under the
assumption that everything stays the same except that the treatment
indicator is switched to <img class="math" src="_images/math/906dfa4d36ff6837226de6ec10a5e18d37c41bc0.png" alt="t_i=0"/>.</p>
</li>
</ul>
</div>
<div class="section" id="id55">
<h3>Output Values<a class="headerlink" href="#id55" title="Permalink to this headline">¶</a></h3>
<p>The output of each Zelig command contains useful information which you
may view. For example, if you run
<tt class="docutils literal"><span class="pre">z.out</span> <span class="pre">&lt;-</span> <span class="pre">zelig(y</span> <span class="pre">~</span> <span class="pre">x,</span> <span class="pre">model</span> <span class="pre">=</span> <span class="pre">relogit,</span> <span class="pre">data)</span></tt>, then you may examine
the available information in <tt class="docutils literal"><span class="pre">z.out</span></tt> by using <tt class="docutils literal"><span class="pre">names(z.out)</span></tt>, see
the coefficients by using z.out$coefficients, and a default summary of
information through <tt class="docutils literal"><span class="pre">summary(z.out)</span></tt>.</p>
</div>
<div class="section" id="differences-with-stata-version">
<h3>Differences with Stata Version<a class="headerlink" href="#differences-with-stata-version" title="Permalink to this headline">¶</a></h3>
<p>The Stata version of ReLogit and the R implementation differ slightly in
their coefficient estimates due to differences in the matrix inversion
routines implemented in R and Stata. Zelig uses orthogonal-triangular
decomposition (through lm.influence()) to compute the bias term, which
is more numerically stable than standard matrix calculations.</p>
</div>
<div class="section" id="id56">
<h3>See also<a class="headerlink" href="#id56" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<hr class="docutils" />
<div class="section" id="zelig-tobit">
<h2>zelig-tobit<a class="headerlink" href="#zelig-tobit" title="Permalink to this headline">¶</a></h2>
<p>Linear Regression for a Left-Censored Dependent Variable</p>
<p>Tobit regression estimates a linear regression model for a left-censored
dependent variable, where the dependent variable is censored from below.
While the classical tobit model has values censored at 0, you may select
another censoring point. For other linear regression models with fully
observed dependent variables, see Bayesian regression (), maximum
likelihood normal regression (), or least squares ().</p>
<div class="section" id="id57">
<h3>Syntax<a class="headerlink" href="#id57" title="Permalink to this headline">¶</a></h3>
<div class="highlight-r"><div class="highlight"><pre>z5 <span class="o">&lt;-</span> ztobit<span class="o">$</span>new<span class="p">()</span>
z5<span class="o">$</span>zelig<span class="p">(</span>Y <span class="o">~</span> X1 <span class="o">+</span> X2<span class="p">,</span> below <span class="o">=</span> <span class="m">0</span><span class="p">,</span> above <span class="o">=</span> <span class="kc">Inf</span><span class="p">,</span> data <span class="o">=</span> mydata<span class="p">)</span>
z5<span class="o">$</span>setx<span class="p">()</span>
z5<span class="o">$</span>sim<span class="p">()</span>
</pre></div>
</div>
<p>With the Zelig 4 compatibility wrappers:</p>
<div class="highlight-r"><div class="highlight"><pre>z.out <span class="o">&lt;-</span> zelig<span class="p">(</span>Y <span class="o">~</span> X1 <span class="o">+</span> X2<span class="p">,</span> below <span class="o">=</span> <span class="m">0</span><span class="p">,</span> above <span class="o">=</span> <span class="kc">Inf</span><span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;tobit&quot;</span><span class="p">,</span> data <span class="o">=</span> mydata<span class="p">)</span>
x.out <span class="o">&lt;-</span> setx<span class="p">(</span>z.out<span class="p">)</span>
s.out <span class="o">&lt;-</span> sim<span class="p">(</span>z.out<span class="p">,</span> x <span class="o">=</span> x.out<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="inputs">
<h3>Inputs<a class="headerlink" href="#inputs" title="Permalink to this headline">¶</a></h3>
<p>zelig() accepts the following arguments to specify how the dependent
variable is censored.</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">below</span></tt>: (defaults to 0) The point at which the dependent variable
is censored from below. If any values in the dependent variable are
observed to be less than the censoring point, it is assumed that that
particular observation is censored from below at the observed value.
(See for a Bayesian implementation that supports both left and right
censoring.)</p>
</li>
<li><p class="first">robust: defaults to FALSE. If TRUE, zelig() computes robust standard
errors based on sandwich estimators (see and ) and the options
selected in cluster.</p>
</li>
<li><p class="first">cluster: if robust = TRUE, you may select a variable to define groups
of correlated observations. Let x3 be a variable that consists of
either discrete numeric values, character strings, or factors that
define strata. Then</p>
<div class="highlight-python"><div class="highlight"><pre>&gt; z.out &lt;- zelig(y ~ x1 + x2, robust = TRUE, cluster = &quot;x3&quot;,
                 model = &quot;tobit&quot;, data = mydata)
</pre></div>
</div>
<p>means that the observations can be correlated within the strata
defined by the variable x3, and that robust standard errors should be
calculated according to those clusters. If robust = TRUE but cluster
is not specified, zelig() assumes that each observation falls into
its own cluster.</p>
</li>
</ul>
<p>Zelig users may wish to refer to <tt class="docutils literal"><span class="pre">help(survreg)</span></tt> for more information.</p>
</div>
<div class="section" id="id58">
<h3>Examples<a class="headerlink" href="#id58" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id59">
<h4>Basic Example<a class="headerlink" href="#id59" title="Permalink to this headline">¶</a></h4>
<p>Attaching the sample dataset:</p>
<div class="highlight-r"><div class="highlight"><pre>data<span class="p">(</span>tobin<span class="p">)</span>
</pre></div>
</div>
<p>Estimating linear regression using <tt class="docutils literal"><span class="pre">tobit</span></tt>:</p>
<div class="highlight-r"><div class="highlight"><pre>z.out <span class="o">&lt;-</span> zelig<span class="p">(</span>durable <span class="o">~</span> age <span class="o">+</span> quant<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;tobit&quot;</span><span class="p">,</span> data <span class="o">=</span> tobin<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## How to cite this model in Zelig:</span>
<span class="c">##   Kosuke Imai, Gary King, Olivia Lau. 2011.</span>
<span class="c">##   tobit: Linear regression for Left-Censored Dependent Variable</span>
<span class="c">##   in Kosuke Imai, Gary King, and Olivia Lau, &quot;Zelig: Everyone&#39;s Statistical Software,&quot;</span>
<span class="c">##   http://datascience.iq.harvard.edu/zelig</span>
</pre></div>
</div>
<p>Setting values for the explanatory variables to their sample averages:</p>
<div class="highlight-r"><div class="highlight"><pre>x.out <span class="o">&lt;-</span> setx<span class="p">(</span>z.out<span class="p">)</span>
</pre></div>
</div>
<p>Simulating quantities of interest from the posterior distribution given <tt class="docutils literal"><span class="pre">x.out</span></tt>.</p>
<div class="highlight-r"><div class="highlight"><pre>s.out1 <span class="o">&lt;-</span> sim<span class="p">(</span>z.out<span class="p">,</span> x <span class="o">=</span> x.out<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>summary<span class="p">(</span>s.out1<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">##</span>
<span class="c">##  sim x :</span>
<span class="c">##  -----</span>
<span class="c">## ev</span>
<span class="c">##    mean     sd   50%   2.5% 97.5%</span>
<span class="c">## 1 1.547 0.6289 1.457 0.5254 2.985</span>
<span class="c">## pv</span>
<span class="c">##       mean    sd   50% 2.5% 97.5%</span>
<span class="c">## [1,] 2.923 4.061 1.081    0 13.99</span>
</pre></div>
</div>
</div>
<div class="section" id="id60">
<h4>Simulating First Differences<a class="headerlink" href="#id60" title="Permalink to this headline">¶</a></h4>
<p>Set explanatory variables to their default(mean/mode) values, with
high (80th percentile) and low (20th percentile) liquidity ratio
(<tt class="docutils literal"><span class="pre">quant</span></tt>):</p>
<div class="highlight-r"><div class="highlight"><pre>x.high <span class="o">&lt;-</span> setx<span class="p">(</span>z.out<span class="p">,</span> quant <span class="o">=</span> quantile<span class="p">(</span>tobin<span class="o">$</span>quant<span class="p">,</span> prob <span class="o">=</span> <span class="m">0.8</span><span class="p">))</span>
x.low <span class="o">&lt;-</span> setx<span class="p">(</span>z.out<span class="p">,</span> quant <span class="o">=</span> quantile<span class="p">(</span>tobin<span class="o">$</span>quant<span class="p">,</span> prob <span class="o">=</span> <span class="m">0.2</span><span class="p">))</span>
</pre></div>
</div>
<p>Estimating the first difference for the effect of high versus low
liquidity ratio on duration(<tt class="docutils literal"><span class="pre">durable</span></tt>):</p>
<div class="highlight-r"><div class="highlight"><pre>s.out2 <span class="o">&lt;-</span> sim<span class="p">(</span>z.out<span class="p">,</span> x <span class="o">=</span> x.high<span class="p">,</span> x1 <span class="o">=</span> x.low<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>summary<span class="p">(</span>s.out2<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">##</span>
<span class="c">##  sim x :</span>
<span class="c">##  -----</span>
<span class="c">## ev</span>
<span class="c">##    mean     sd   50%   2.5% 97.5%</span>
<span class="c">## 1 1.231 0.7923 1.085 0.1413 3.162</span>
<span class="c">## pv</span>
<span class="c">##       mean    sd   50% 2.5% 97.5%</span>
<span class="c">## [1,] 3.316 4.547 1.389    0 15.02</span>
<span class="c">##</span>
<span class="c">##  sim x1 :</span>
<span class="c">##  -----</span>
<span class="c">## ev</span>
<span class="c">##    mean     sd   50%   2.5% 97.5%</span>
<span class="c">## 1 2.074 0.9889 1.935 0.5587 4.466</span>
<span class="c">## pv</span>
<span class="c">##      mean    sd   50% 2.5% 97.5%</span>
<span class="c">## [1,] 3.64 4.541 2.171    0 15.16</span>
<span class="c">## fd</span>
<span class="c">##     mean    sd    50%   2.5% 97.5%</span>
<span class="c">## 1 0.8434 1.241 0.7868 -1.492 3.366</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre>plot<span class="p">(</span>s.out1<span class="p">)</span>
</pre></div>
</div>
<div class="figure">
<img alt="Zelig-tobit" src="_images/Zelig-tobit.png" />
<p class="caption">Zelig-tobit</p>
</div>
</div>
</div>
<div class="section" id="id61">
<h3>Model<a class="headerlink" href="#id61" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Let <img class="math" src="_images/math/d618fcc344538f93b4596930823c957af4a11865.png" alt="Y_i^*"/> be a latent dependent variable which is distributed
with <em>stochastic</em> component</p>
<div class="math">
<p><img src="_images/math/f04da308df2549fd3f3ddac6d6294d0fe68c7536.png" alt="\begin{aligned}
Y_i^* &amp; \sim &amp; \textrm{Normal}(\mu_i, \sigma^2) \\\end{aligned}"/></p>
</div><p>where <img class="math" src="_images/math/fe45a709c71e4160e1a09e3b4cc03d2d36d15644.png" alt="\mu_i"/> is a vector means and <img class="math" src="_images/math/93c29bfedc993de115781b4fbb7e3a8b9e8d6b51.png" alt="\sigma^2"/> is a
scalar variance parameter. <img class="math" src="_images/math/d618fcc344538f93b4596930823c957af4a11865.png" alt="Y_i^*"/> is not directly observed,
however. Rather we observed <img class="math" src="_images/math/bc99eef60e4cfed714571a15a3192837beb4bd4c.png" alt="Y_i"/> which is defined as:</p>
<div class="math">
<p><img src="_images/math/c02c4c1f67cbb07aff7eef9e34f1779d12f26ae4.png" alt="Y_i = \left\{
\begin{array}{lcl}
Y_i^*  &amp;\textrm{if} &amp; c &lt;Y_i^* \\
c    &amp;\textrm{if} &amp; c \ge Y_i^*
\end{array}\right."/></p>
</div><p>where <img class="math" src="_images/math/65868d23a5bfe5b3b2d819386b19c14fa36af134.png" alt="c"/> is the lower bound below which <img class="math" src="_images/math/d618fcc344538f93b4596930823c957af4a11865.png" alt="Y_i^*"/> is
censored.</p>
</li>
<li><p class="first">The <em>systematic component</em> is given by</p>
<div class="math">
<p><img src="_images/math/bf760b1377dc29b5986cdb3a1ea4bc3174dcb094.png" alt="\begin{aligned}
\mu_{i} &amp;=&amp; x_{i} \beta,\end{aligned}"/></p>
</div><p>where <img class="math" src="_images/math/c223a5391d7bfd7e7c68274c104fc7418944376e.png" alt="x_{i}"/> is the vector of <img class="math" src="_images/math/e9203da50e1059455123460d4e716c9c7f440cc3.png" alt="k"/> explanatory variables
for observation <img class="math" src="_images/math/a581f053bbfa5115f42c13094857cdd12a37ec49.png" alt="i"/> and <img class="math" src="_images/math/8ce03f78ed945f2ef3dac87c8799b55b393527e7.png" alt="\beta"/> is the vector of
coefficients.</p>
</li>
</ul>
</div>
<div class="section" id="id62">
<h3>Quantities of Interest<a class="headerlink" href="#id62" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">The expected values (<tt class="docutils literal"><span class="pre">qi$ev</span></tt>) for the tobit regression model are
the same as the expected value of <img class="math" src="_images/math/e5acb8ce977a9706090eb708ea2ae8ab001207b8.png" alt="Y*"/>:</p>
<div class="math">
<p><img src="_images/math/9ae22946494ae2cba96f0b452f7f93e671f63d93.png" alt="E(Y^* | X) = \mu_{i} = x_{i} \beta"/></p>
</div></li>
<li><p class="first">The first difference (<tt class="docutils literal"><span class="pre">qi$fd</span></tt>) for the tobit regression model is
defined as</p>
<div class="math">
<p><img src="_images/math/3552382628dce9e0b3aa47fe65f61406a39686f1.png" alt="\begin{aligned}
\text{FD}=E(Y^* \mid x_{1}) - E(Y^* \mid x).\end{aligned}"/></p>
</div></li>
<li><p class="first">In conditional prediction models, the average expected treatment
effect (<tt class="docutils literal"><span class="pre">qi$att.ev</span></tt>) for the treatment group is</p>
<div class="math">
<p><img src="_images/math/fd39d2da6c33f4ce8a5109998fdcc63ae68141dc.png" alt="\begin{aligned}
\frac{1}{\sum t_{i}}\sum_{i:t_{i}=1}[E[Y^*_{i}(t_{i}=1)]-E[Y^*_{i}(t_{i}=0)]],\end{aligned}"/></p>
</div><p>where <img class="math" src="_images/math/10ea017369414222fb61b769804fb55f01f1f886.png" alt="t_{i}"/> is a binary explanatory variable defining the
treatment (<img class="math" src="_images/math/4313486a2444e99c09afd625a9f811c03d22538f.png" alt="t_{i}=1"/>) and control (<img class="math" src="_images/math/254a135214133c3926c66cf9682fd612cae45ce4.png" alt="t_{i}=0"/>) groups.</p>
</li>
</ul>
</div>
<div class="section" id="id63">
<h3>Output Values<a class="headerlink" href="#id63" title="Permalink to this headline">¶</a></h3>
<p>The output of each Zelig command contains useful information which you
may view. For example, if you run:</p>
<div class="highlight-r"><div class="highlight"><pre>z.out <span class="o">&lt;-</span> zelig<span class="p">(</span>y <span class="o">~</span> x<span class="p">,</span> model <span class="o">=</span> <span class="s">&quot;tobit&quot;</span><span class="p">,</span> data<span class="p">)</span>
</pre></div>
</div>
<p>then you may examine the available information in <a href="#id64"><span class="problematic" id="id65">``</span></a>z.out`.</p>
</div>
<div class="section" id="id66">
<h3>See also<a class="headerlink" href="#id66" title="Permalink to this headline">¶</a></h3>
<p>The tobit function is part of the survival library by Terry Therneau,
ported to R by Thomas Lumley. Advanced users may wish to refer to
<tt class="docutils literal"><span class="pre">help(survfit)</span></tt> in the survival library.</p>
</div>
</div>
</div>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="_sources/vignette.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2014, The Zelig Team.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.2.<br/>
    </p>
  </div>
</footer>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-27761864-7', 'pydata.org');
  ga('send', 'pageview');

</script>



  </body>
</html>